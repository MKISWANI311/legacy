{"version":3,"sources":["webpack:///webpack/bootstrap 82c42ac78f6a5d3a0e7e","webpack:////home/dp/Projects/sdk/spasdk/dom/index.js","webpack:///./src/js/api.js","webpack:////home/dp/Projects/sdk/spasdk/component/index.js","webpack:////home/dp/Projects/sdk/cjssdk/emitter/index.js","webpack:///./src/js/sjcl.min.js","webpack:///./src/js/models/tag-manager.js","webpack:////home/dp/Projects/sdk/spasdk/component-button/index.js","webpack:////home/dp/Projects/sdk/spasdk/component-tab/index.js","webpack:///./src/js/app.js","webpack:///./src/js/data.entry.types.js","webpack:///./src/js/template-list.js","webpack:////home/dp/Projects/sdk/spasdk/gettext/index.js","webpack:///./src/js/crypto.js","webpack:////home/dp/Projects/sdk/spasdk/component-page/index.js","webpack:///./src/js/note-search.js","webpack:///./src/js/note-list.js","webpack:////home/dp/Projects/sdk/spasdk/component-list/index.js","webpack:///./src/js/data.templates.js","webpack:///./src/js/note.list.js","webpack:///./src/js/main.js","webpack:////home/dp/Projects/sdk/spasdk/app/index.js","webpack:////home/dp/Projects/sdk/cjssdk/gettext/index.js","webpack:///./src/js/models/user.js","webpack:///./src/js/views/main.js","webpack:///./src/js/views/main-notes.js","webpack:///./src/js/note-viewer.js","webpack:///./src/js/note-editor.js","webpack:///./src/js/views/user.js","webpack:///./src/js/views/user-login.js","webpack:///./src/js/views/user-signup.js","webpack:///./src/js/views/user-unlock.js","webpack:///./src/js/note.filter.js","webpack:///./src/js/note.editor.js","webpack:///./src/js/tools.js","webpack:///./src/js/dialogs.js","webpack:///./src/js/modal.js","webpack:///./src/js/fldlist.js"],"names":[],"mappings":";AAAA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAK;AACL;AACA;;AAEA;AACA;AACA;AACA,mCAA2B,0BAA0B,EAAE;AACvD,yCAAiC,eAAe;AAChD;AACA;AACA;;AAEA;AACA,8DAAsD,+DAA+D;;AAErH;AACA;;AAEA;AACA;;;;;;;;AC7DA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA,WAAW,OAAO;AAClB,WAAW,YAAY;AACvB,WAAW,KAAK;AAChB,YAAY,UAAU;AACtB;AACA;AACA;AACA,oBAAoB;AACpB,mBAAmB,gBAAgB;AACnC,oBAAoB,2DAA2D;AAC/E;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,wBAAwB,0BAA0B;AAClD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;;AAGA;AACA;AACA;AACA,WAAW,KAAK;AAChB,YAAY,iBAAiB;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,oBAAoB,0BAA0B;AAC9C;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;;AAGA;AACA;AACA;AACA,WAAW,KAAK;AAChB,WAAW,KAAK;AAChB,YAAY,UAAU;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,wBAAwB,0BAA0B;AAClD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;;AAGA;AACA;AACA;AACA,WAAW,QAAQ;AACnB,YAAY,QAAQ;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,oBAAoB,0BAA0B;AAC9C;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;;AAGA;AACA;AACA;AACA;;AAEA;AACA;;;AAGA;AACA;;;;;;;;AChLA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA,KAAK;;AAEL;AACA,qDAAqD,aAAa,2CAA2C;AAC7G;AACA;AACA;AACA;AACA,aAAa;AACb;AACA,KAAK;;AAEL;AACA,qCAAqC;AACrC;AACA;AACA;AACA,SAAS;;AAET;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;;;;;;;;ACtEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,OAAO,WAAW;AAC7B,WAAW,QAAQ;AACnB,WAAW,OAAO;AAClB,WAAW,QAAQ;AACnB,WAAW,QAAQ;AACnB,WAAW,UAAU;AACrB,WAAW,kBAAkB;AAC7B,WAAW,0BAA0B,kBAAkB;AACvD,WAAW,QAAQ;AACnB,WAAW,QAAQ;AACnB,WAAW,QAAQ;AACnB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B;AAC/B;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,cAAc;AACd;AACA;;AAEA;AACA;AACA;AACA,cAAc;AACd;AACA;;AAEA;AACA;AACA;AACA,cAAc;AACd;AACA;;AAEA;AACA;AACA;AACA;AACA,cAAc;AACd;AACA;;AAEA;AACA;AACA;AACA,cAAc;AACd;AACA;;AAEA;AACA;AACA;AACA,cAAc;AACd;AACA;;AAEA;AACA;AACA;AACA;AACA,cAAc;AACd;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAsB;AACtB,0BAA0B,MAAM;AAChC;AACA;;AAEA;;AAEA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA,SAAS;;AAET;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,QAAQ;AACR;;;AAGA;AACA;AACA;;;AAGA;AACA;AACA;AACA,UAAU;AACV;AACA;;;AAGA;AACA;AACA;AACA,WAAW,aAAa;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,0BAA0B;AACjD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY;AACZ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB;AACzB,6BAA6B,UAAU;AACvC;AACA,iCAAiC,YAAY;AAC7C;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA,aAAa,UAAU;AACvB,aAAa,OAAO;AACpB;AACA;AACA;AACA;AACA;AACA,yCAAyC,0DAA0D;AACnG,gDAAgD,oDAAoD;AACpG;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ;;AAER;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,QAAQ;AACR;;;AAGA;AACA;AACA;AACA;AACA,WAAW,OAAO;AAClB;AACA,YAAY,QAAQ;AACpB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA,YAAY,QAAQ;AACpB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;AACA;AACA,WAAW,OAAO;AAClB;AACA,YAAY,QAAQ;AACpB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;AACA;AACA,WAAW,OAAO;AAClB;AACA,YAAY,QAAQ;AACpB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;;;;;;;;AC7qBA;AACA;AACA;AACA;;AAEA;;AAEA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,4CAA4C,+DAA+D;AAC3G;;AAEA;AACA;AACA;AACA;AACA,gBAAgB;AAChB;AACA;AACA;AACA;AACA,mCAAmC,MAAM;AACzC,mCAAmC;AACnC;AACA;AACA,4BAA4B;AAC5B;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA,eAAe,OAAO;AACtB,eAAe,SAAS;AACxB;AACA;AACA,uDAAuD,MAAM;AAC7D;AACA,uDAAuD,MAAM;AAC7D;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,8CAA8C,0DAA0D;AACxG,qEAAqE,uDAAuD;AAC5H,sDAAsD,uDAAuD;AAC7G;;AAEA;AACA;AACA;AACA;AACA,KAAK;;;AAGL;AACA;AACA;AACA;AACA,eAAe,OAAO;AACtB,eAAe,SAAS;AACxB;AACA;AACA,gDAAgD,MAAM;AACtD;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT,KAAK;;;AAGL;AACA;AACA;AACA,eAAe,OAAO;AACtB;AACA;AACA;AACA,sCAAsC;AACtC;AACA,QAAQ;AACR;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,KAAK;;;AAGL;AACA;AACA;AACA,eAAe,OAAO;AACtB,eAAe,SAAS;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,0FAA0F,wBAAwB,EAAE;AACpH;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;;AAGL;AACA;AACA;AACA;AACA,eAAe,OAAO;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA,0CAA0C,wDAAwD;AAClG;;AAEA;AACA;AACA;AACA;AACA,KAAK;;;AAGL;AACA;AACA;AACA,eAAe,OAAO;AACtB;AACA;AACA;AACA,8BAA8B,yBAAyB;AACvD;AACA;AACA;AACA;AACA,+BAA+B,aAAa;AAC5C;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,4BAA4B,sBAAsB;AAClD;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;;;AAGA;AACA;;;;;;;;;ACtRa,UAAU,SAAS,QAAQ,QAAQ,QAAQ,SAAS,YAAY,oBAAoB,yBAAyB,gCAAgC,eAAe,qBAAqB,yBAAyB,gCAAgC,eAAe,iBAAiB,yBAAyB,4BAA4B;AAC5U,4BAA4B,0BAA0B,uCAAuC,WAAW,QAAQ,gFAAgF,2BAA2B,QAAQ,SAAS,KAAK,SAAS,4BAA4B,yDAAyD,YAAY,oBAAoB,mBAAmB,cAAc,QAAQ,EAAE,SAAS,eAAe;AAClb;AACA,2BAA2B,oBAAoB,mBAAmB,qBAAqB,mBAAmB,oDAAoD,kEAAkE,QAAQ,QAAQ,kCAAkC,UAAU,MAAM,mBAAmB,wBAAwB,gBAAgB,OAAO,OAAO,iBAAiB,4CAA4C,yBAAyB,QAAQ,IAAI,KAAK,sBAAsB,uBAAuB;AAC/f,EAAE,IAAI,KAAK,mBAAmB,oBAAoB,iBAAiB,2EAA2E,wDAAwD,gBAAgB,2CAA2C,YAAY,uCAAuC,QAAQ,IAAI,KAAK,mDAAmD,qDAAqD,qDAAqD;AACle,iCAAiC,KAAK,IAAI,IAAI,IAAI,QAAQ,IAAI,KAAK,0EAA0E,IAAI,IAAI,IAAI,IAAI,IAAI;AACjK,eAAe,yBAAyB,oDAAoD,kDAAkD,sBAAsB,iDAAiD,kDAAkD,yEAAyE,uBAAuB,eAAe,kBAAkB,gDAAgD,qBAAqB,0BAA0B;AACve,KAAK,eAAe,MAAM,mEAAmE,SAAS,yBAAyB,mBAAmB,sCAAsC,wBAAwB,uCAAuC,qBAAqB,wEAAwE,UAAU,QAAQ,WAAW,iBAAiB,aAAa,qBAAqB,MAAM,IAAI,sBAAsB,KAAK,MAAM,OAAO,UAAU,IAAI;AACpe,QAAQ,WAAW,KAAK,mBAAmB,aAAa,2BAA2B,8BAA8B,yDAAyD,SAAS,iBAAiB;AACpM,uBAAuB,qBAAqB,0CAA0C,QAAQ,MAAM,KAAK,sBAAsB,+BAA+B,MAAM,qCAAqC,oBAAoB,kCAAkC,eAAe,QAAQ,WAAW,KAAK,uBAAuB,cAAc,UAAU,KAAK,8CAA8C;AACxY,gBAAgB,qBAAqB,WAAW,QAAQ,WAAW,wDAAwD,gDAAgD,oBAAoB,aAAa,yBAAyB,WAAW,cAAc,QAAQ,WAAW,0CAA0C;AAC3T,mBAAmB,4FAA4F,sEAAsE,QAAQ,aAAa,EAAE,+BAA+B,QAAQ,YAAY,MAAM,IAAI,KAAK,MAAM,MAAM,KAAK,eAAe,QAAQ,SAAS,oBAAoB,wBAAwB,2CAA2C,QAAQ,WAAW,KAAK,yBAAyB;AACvc,SAAS,MAAM,gBAAgB,UAAU,KAAK,KAAK,YAAY,8CAA8C,WAAW,6BAA6B,oBAAoB,MAAM,oBAAoB,oBAAoB,WAAW,mBAAmB,kCAAkC;AACvR,4BAA4B,+BAA+B,uBAAuB,UAAU,SAAS,YAAY,oBAAoB,yDAAyD,8CAA8C,SAAS,sCAAsC,iBAAiB,KAAK,8BAA8B,YAAY,qBAAqB,wBAAwB,uDAAuD,iBAAiB,KAAK,cAAc;AACne,aAAa,qBAAqB,SAAS,wBAAwB,aAAa,SAAS,wBAAwB,cAAc,sCAAsC,cAAc,OAAO,KAAK,KAAK,QAAQ,OAAO,0BAA0B,oCAAoC,6BAA6B,KAAK,eAAe,+FAA+F,QAAQ,KAAK,KAAK,eAAe,KAAK,YAAY,aAAa;AAChe,0EAA0E,8DAA8D,IAAI,IAAI,IAAI,QAAQ,IAAI,IAAI,IAAI,4DAA4D,cAAc,cAAc,cAAc,cAAc,cAAc,cAAc,cAAc;AACtU,eAAe,uCAAuC,yEAAyE,QAAQ,QAAQ,4EAA4E,QAAQ,aAAa,KAAK,iBAAiB,sBAAsB,+BAA+B,+BAA+B,8BAA8B,6BAA6B,QAAQ,QAAQ;AACra,KAAK,UAAU,4EAA4E,QAAQ,aAAa,KAAK,iBAAiB,sBAAsB,+BAA+B,oCAAoC,gFAAgF,cAAc,yBAAyB,+BAA+B,KAAK,8EAA8E;AACxc,4CAA4C,gBAAgB,uBAAuB,eAAe,aAAa,mBAAmB,gCAAgC,4DAA4D,gBAAgB,QAAQ,WAAW,sCAAsC,QAAQ,WAAW,sCAAsC,sBAAsB,yBAAyB,sBAAsB,MAAM,gCAAgC;AAC3c,iBAAiB,oCAAoC,aAAa,eAAe,QAAQ,IAAI,MAAM,OAAO,eAAe,WAAW,aAAa,aAAa,aAAa,OAAO;AAClL,gBAAgB,0CAA0C,gGAAgG,2DAA2D,kBAAkB,WAAW,QAAQ,QAAQ,QAAQ,aAAa,MAAM,iBAAiB,SAAS,mCAAmC,OAAO,aAAa,iBAAiB,4BAA4B,oBAAoB,cAAc,4BAA4B;AACzd,IAAI,0CAA0C,+BAA+B,gGAAgG,QAAQ,mHAAmH,QAAQ,QAAQ,SAAS,MAAM,sCAAsC,SAAS,cAAc,OAAO,SAAS,4BAA4B,6BAA6B,SAAS,4BAA4B;AAClf,kCAAkC,qGAAqG,8BAA8B,oBAAoB,kFAAkF,eAAe,QAAQ,aAAa,MAAM,OAAO,sCAAsC,aAAa,uBAAuB,YAAY,6BAA6B,SAAS,oCAAoC,eAAe;AAC3e,2EAA2E,6BAA6B,6BAA6B,yCAAyC,qBAAqB,0BAA0B,QAAQ,IAAI,KAAK,uBAAuB,wBAAwB,uBAAuB,wBAAwB,4EAA4E,iDAAiD;AACzc,qCAAqC,SAAS,qEAAqE,yDAAyD,oBAAoB,WAAW,iCAAiC,QAAQ,mBAAmB,KAAK,+BAA+B,QAAQ,IAAI,KAAK,eAAe,QAAQ,WAAW,eAAe,cAAc,oBAAoB;AAC/Y,aAAa,0BAA0B,SAAS,kBAAkB,MAAM,qEAAqE,yBAAyB,QAAQ,IAAI,MAAM,4BAA4B,WAAW,4BAA4B,SAAS,oBAAoB,gCAAgC,SAAS,4BAA4B,YAAY,4DAA4D,YAAY,sCAAsC,+BAA+B;AACtf,4BAA4B,iBAAiB,oBAAoB,yCAAyC,WAAW,eAAe,IAAI,EAAE,IAAI,OAAO,wDAAwD,MAAM,0CAA0C,8CAA8C,oBAAoB,MAAM,kGAAkG,aAAa,UAAU,UAAU;AACxc,SAAS,uCAAuC,qBAAqB,iCAAiC,qFAAqF,yBAAyB,qBAAqB,iDAAiD,4BAA4B,YAAY,4BAA4B,6CAA6C,kDAAkD,8BAA8B;AAC3d,QAAQ,2CAA2C,wDAAwD,aAAa,2BAA2B,WAAW,+BAA+B,0CAA0C,+CAA+C,4BAA4B,oCAAoC,yCAAyC,cAAc,gCAAgC,sBAAsB,mCAAmC,MAAM;AAC5e,SAAS,oDAAoD,QAAQ,WAAW,KAAK,OAAO,aAAa,wCAAwC,SAAS,4EAA4E,WAAW,WAAW,gEAAgE,YAAY,IAAI,KAAK,wBAAwB,mBAAmB,8BAA8B,cAAc,iCAAiC,mCAAmC,eAAe;AAC3f,wCAAwC,mCAAmC,QAAQ,IAAI,KAAK,wBAAwB,oBAAoB,eAAe,eAAe,qCAAqC,QAAQ,KAAK,wCAAwC,QAAQ,gBAAgB,KAAK,iCAAiC,aAAa,YAAY,yBAAyB,6BAA6B,kCAAkC,eAAe,UAAU,qBAAqB,SAAS,UAAU,eAAe;AAC/f,2DAA2D,cAAc,8CAA8C,iBAAiB,MAAM,mBAAmB,SAAS,6CAA6C,QAAQ,WAAW;AAC1O,WAAW,UAAU,2DAA2D,2BAA2B,QAAQ,QAAQ,uBAAuB,gCAAgC,aAAa,SAAS,oEAAoE,8DAA8D;AAC1U,uEAAuE,wBAAwB,8BAA8B,yBAAyB,cAAc,yDAAyD,+BAA+B,SAAS,QAAQ,uDAAuD,mCAAmC,2BAA2B,QAAQ,QAAQ,gBAAgB,gBAAgB,kCAAkC;AACpd,iCAAiC,8DAA8D,kQAAkQ,wBAAwB,8BAA8B,yBAAyB,cAAc,+BAA+B;AAC7d,yBAAyB,SAAS,QAAQ,yCAAyC,oBAAoB,UAAU,OAAO,mCAAmC,mGAAmG,WAAW,MAAM,oBAAoB,qCAAqC,MAAM,sCAAsC,MAAM,4DAA4D,MAAM;AAC5b,EAAE,WAAW,EAAE,oBAAoB,sBAAsB,gBAAgB,IAAI,sEAAsE,gBAAgB,GAAG,mBAAmB,QAAQ,KAAK,QAAQ,WAAW,KAAK,+IAA+I,0GAA0G,SAAS,mBAAmB;AACnf,eAAe,0BAA0B,MAAM,mCAAmC,sGAAsG,UAAU,SAAS,iBAAiB,QAAQ,GAAG,yDAAyD,SAAS,iBAAiB,QAAQ,GAAG,QAAQ,WAAW,2CAA2C,WAAW,+BAA+B,+BAA+B;AAC5c,qCAAqC,oBAAoB,QAAQ,cAAc,gBAAgB,cAAc,8EAA8E,wCAAwC,wCAAwC,OAAO;;AAElR;AACA;;;;;;;;ACzCA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;;AAGA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA,6BAA6B,MAAM;AACnC,6BAA6B,MAAM;AACnC;;;AAGA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;;AAEA;AACA,KAAK;AACL;;;AAGA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;;AAGA;AACA;AACA,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,qBAAqB,+CAA+C;AACpE;;AAEA;AACA;AACA;AACA,KAAK;;AAEL;AACA,oBAAoB,uBAAuB;AAC3C;AACA;;AAEA;AACA;;;AAGA;AACA;AACA;AACA;AACA,YAAY,MAAM;AAClB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,wBAAwB,qBAAqB;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA,wBAAwB,qBAAqB;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kCAAkC,iBAAiB;AACnD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;;AAEA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAkB;;AAElB;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,SAAS;AACT;;AAEA;AACA;AACA;AACA,SAAS;AACT;;AAEA;AACA;AACA;AACA,SAAS;AACT;;AAEA;AACA;AACA;AACA,SAAS;AACT;;AAEA;AACA;AACA;AACA,SAAS;AACT;;AAEA;AACA;AACA;;;AAGA;AACA;AACA,iBAAiB;AACjB;;AAEA;AACA;AACA;AACA,SAAS;AACT;AACA;;AAEA;AACA;AACA,iBAAiB;AACjB,aAAa;;AAEb;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;;AAGA;AACA;;;;;;;;ACpaA;AACA;AACA;AACA;;AAEA;;AAEA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,OAAO,WAAW;AAC7B,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;;AAEA;AACA;;;AAGA;AACA;;;AAGA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY;AACZ,QAAQ;AACR;AACA;AACA;AACA;AACA,kBAAkB,OAAO;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA6B;AAC7B,iCAAiC,MAAM;AACvC;AACA,uCAAuC,aAAa;AACpD;AACA;AACA;AACA;;;AAGA;AACA;;;;;;;;ACnIA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,OAAO,WAAW;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB;AAChB;AACA;AACA;AACA;AACA,gBAAgB;AAChB;AACA;AACA;AACA;AACA,QAAQ;AACR;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;;;AAGA;AACA;AACA;;AAEA;AACA;;;AAGA;AACA;AACA;AACA;AACA,WAAW,OAAO;AAClB;AACA,YAAY,QAAQ;AACpB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,qCAAqC,uBAAuB;AAC5D,UAAU;;AAEV;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;AACA;AACA,YAAY,QAAQ;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;;;;;;;;ACxKA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;;AAGA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA,kBAAkB;;AAElB;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,sBAAsB;AACtB,sBAAsB;;;AAGtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gCAAgC,kBAAkB;AAClD;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,aAAa;AACb;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB;AACnB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,aAAa;AACb;AACA;AACA;AACA;;AAEA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB;AACnB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;;AAGA;AACA;;;;;;;;ACnTA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA,2EAA2E;AAC3E;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA,CAAC;;;AAGD;AACA;AACA;AACA;AACA;;;;;;;;ACrEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;;AAGA;AACA;;AAEA;AACA;;AAEA;AACA,oBAAoB,iCAAiC;AACrD;;AAEA;AACA,oBAAoB,iCAAiC;AACrD;;AAEA,2BAA2B;AAC3B;;;AAGA;AACA;AACA;;AAEA;AACA;;;AAGA;AACA;AACA,8BAA8B,iGAAiG;AAC/H,4BAA4B,gFAAgF;AAC5G,8BAA8B,qCAAqC;AACnE,8BAA8B,qCAAqC,cAAc,yCAAyC;AAC1H,4BAA4B,qCAAqC;AACjE,4BAA4B,qCAAqC;AACjE,4BAA4B,qCAAqC;;AAEjE;;AAEA;AACA;AACA;AACA;AACA,QAAQ;;AAER;AACA;AACA;AACA;AACA;;;AAGA;AACA;;;;;;;;AChEA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA,WAAW,OAAO;AAClB;AACA,YAAY,QAAQ;AACpB;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;;AAGA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,SAAS;AACpB;AACA,YAAY,QAAQ;AACpB;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;;AAGA;AACA;;;;;;;;;ACrHA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA,cAAc,6CAA6C;AAC3D;;;AAGA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;;AAEA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;;;AAGA;AACA;AACA;AACA;AACA;;;AAGA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;;;;;;;;ACtID;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,OAAO,WAAW;AAC7B;AACA;AACA;AACA;AACA;AACA,QAAQ;AACR;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;;AAEA;AACA;;;AAGA;AACA;AACA;AACA;AACA,cAAc;AACd;AACA;;AAEA;AACA;AACA;AACA;AACA,cAAc;AACd;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;AACA;;AAEA;AACA;;AAEA;;;AAGA;AACA;AACA;AACA;AACA,WAAW,OAAO;AAClB;AACA,YAAY,QAAQ;AACpB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,qCAAqC,uBAAuB;AAC5D,UAAU;;AAEV;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;AACA;AACA,YAAY,QAAQ;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;;;;;;;;ACxKA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;;;AAGA;AACA,sCAAsC,iCAAiC;AACvE;;AAEA;AACA,sCAAsC,iCAAiC;AACvE,MAAM;;AAEN;;AAEA;AACA;AACA,wCAAwC,6EAA6E;AACrH;;AAEA;AACA;AACA;AACA;AACA,KAAK;AACL;;;AAGA;AACA;AACA;;AAEA;AACA;;;AAGA;AACA;;;;;;;;AClEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA,uBAAuB,iCAAiC;AACxD;AACA;AACA;AACA,uBAAuB,iCAAiC;AACxD;AACA;;;AAGA;AACA;AACA;;AAEA;AACA;;;AAGA;AACA;AACA,+BAA+B,2FAA2F;AAC1H,+BAA+B,4FAA4F;AAC3H,+BAA+B,mCAAmC;AAClE,+BAA+B,gCAAgC;AAC/D,+BAA+B,gCAAgC;AAC/D;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA,uCAAuC,mCAAmC;;AAE1E;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,uCAAuC,6BAA6B;AACpE;;AAEA,6CAA6C,iCAAiC;AAC9E,4BAA4B,gCAAgC;AAC5D,4BAA4B,gCAAgC;AAC5D;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA,KAAK;;AAEL;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA,mCAAmC,wCAAwC;AAC3E,mCAAmC,qCAAqC;AACxE,mCAAmC,gCAAgC;AACnE;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,2CAA2C,kCAAkC;;AAE7E;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,2CAA2C,4BAA4B;AACvE;;AAEA,iDAAiD,sCAAsC;AACvF,gCAAgC,qCAAqC;AACrE,gCAAgC,qCAAqC;AACrE;AACA;AACA,SAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA,SAAS;;AAET;AACA;AACA;AACA;AACA,SAAS;;AAET;AACA,KAAK;;AAEL;AACA,EAAE;;;AAGF;AACA;;;;;;;;AC3NA;AACA;AACA;AACA;;AAEA;;AAEA;;;AAGA;AACA;AACA;AACA;AACA;AACA,WAAW,OAAO,WAAW;AAC7B;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,cAAc;AACd;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;;AAET;AACA;AACA,SAAS;;AAET;;AAEA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;;;AAGA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA,WAAW,QAAQ;AACnB,WAAW,EAAE;AACb;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA,WAAW,OAAO;AAClB;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,KAAK;;AAEL;;;;AAIA;AACA;AACA,QAAQ;;AAER;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ;AACR;;;AAGA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;;;;;;;;ACvMA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA,aAAa,qBAAqB;AAClC,aAAa;AACb;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,aAAa,wBAAwB;AACrC,aAAa,qBAAqB;AAClC,aAAa,wBAAwB;AACrC,aAAa;AACb;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,aAAa,wBAAwB;AACrC,aAAa,qBAAqB;AAClC,aAAa,wBAAwB;AACrC,aAAa;AACb;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,aAAa,wBAAwB;AACrC,aAAa,qBAAqB;AAClC,aAAa,wBAAwB;AACrC,aAAa,wBAAwB;AACrC,aAAa,qBAAqB;AAClC,aAAa;AACb;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,aAAa,8BAA8B;AAC3C,aAAa,wBAAwB;AACrC,aAAa,wBAAwB;AACrC,aAAa;AACb;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,aAAa,8BAA8B;AAC3C,aAAa,wBAAwB;AACrC,aAAa,wBAAwB;AACrC,aAAa;AACb;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,aAAa,8BAA8B;AAC3C,aAAa,6BAA6B;AAC1C,aAAa,wBAAwB;AACrC,aAAa,wBAAwB;AACrC,aAAa;AACb;AACA;AACA;;;AAGA;AACA;;;;;;;;ACnFA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6DAA6D,UAAU;AACvE;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yFAAyF,kBAAkB;AAC3G;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA,aAAa;AACb;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8CAA8C,6BAA6B;AAC3E;AACA;AACA,qBAAqB;AACrB;AACA,+CAA+C;AAC/C;AACA;AACA,2CAA2C,kBAAkB;AAC7D,2CAA2C,kBAAkB;AAC7D;AACA,SAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gCAAgC,2EAA2E;AAC3G;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;;AAEA;AACA;AACA;AACA,wDAAwD,kBAAkB;AAC1E;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,wCAAwC,+DAA+D;AACvG;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,wCAAwC,mEAAmE;AAC3G;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,SAAS;AACT;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iCAAiC,oBAAoB;AACrD;AACA,mCAAmC;AACnC;AACA,kCAAkC,0BAA0B,4CAA4C,wBAAwB;AAChI;AACA,8EAA8E,iBAAiB,sBAAsB,2BAA2B;AAChJ;AACA,+EAA+E,iBAAiB,uBAAuB;AACvH;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA,kCAAkC;AAClC;AACA,mCAAmC;AACnC;AACA,mCAAmC;AACnC;AACA;AACA;AACA;AACA,qBAAqB;AACrB,kCAAkC,iBAAiB;AACnD;AACA,mCAAmC;AACnC;AACA;AACA;AACA;AACA,qBAAqB;AACrB,kCAAkC,iBAAiB;AACnD;AACA,mCAAmC;AACnC;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB,iBAAiB;AACrC;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB,iBAAiB;AACrC;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,0DAA0D,iBAAiB;AAC3E;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,uEAAuE,iBAAiB;AACxF;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gCAAgC,sCAAsC;AACtE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mCAAmC,sCAAsC,YAAY;AACrF;AACA;AACA,4BAA4B,kBAAkB;AAC9C,gDAAgD,0CAA0C;AAC1F;AACA,gDAAgD,8BAA8B;AAC9E;AACA,4BAA4B,kBAAkB;AAC9C,gDAAgD,kBAAkB;AAClE,kDAAkD,kBAAkB;AACpE,gDAAgD,kBAAkB;AAClE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB;AACvB;AACA,oBAAoB,kBAAkB;AACtC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB;;AAEpB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,6CAA6C,mBAAmB;AAChE;AACA,kDAAkD,kBAAkB;AACpE;AACA;AACA;AACA;AACA;AACA,qBAAqB,SAAS,0BAA0B;AACxD;AACA;AACA;AACA;AACA;AACA,qBAAqB,SAAS,0BAA0B;AACxD;AACA;AACA,kDAAkD,kBAAkB;AACpE;AACA;AACA,6CAA6C,mBAAmB;AAChE;AACA,+CAA+C,mBAAmB;AAClE;;AAEA;AACA;AACA;AACA,YAAY;AACZ;AACA;AACA,YAAY;AACZ;AACA;;;AAGA;AACA;;;;;;;;AChqBA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;;;AAGA;AACA,cAAc,mBAAmB;AACjC;AACA,iCAAiC,YAAY;AAC7C,iCAAiC,YAAY;;AAE7C;AACA;;AAEA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA,KAAK,EAAE;AACP,CAAC;;;;;AAKD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA,SAAS;AACT;;;AAGA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,2CAA2C;AAC3C;;AAEA;AACA,+BAA+B,iDAAiD;AAChF,6BAA6B,+CAA+C;AAC5E,iCAAiC,oDAAoD;AACrF,6BAA6B,iDAAiD;;AAE9E;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;;AAEb;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA,wCAAwC,iBAAiB;AACzD,yBAAyB;AACzB;AACA;AACA,aAAa;;AAEb;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;;AAEb;;;AAGA;AACA;;AAEA;AACA,SAAS;AACT;;;AAGA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;;AAGL;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,6BAA6B,gBAAgB;AAC7C,SAAS;AACT;AACA;AACA,KAAK;AACL;;;;;;;;ACxRA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,WAAW,EAAE;AACb;AACA,YAAY,QAAQ;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY;AACZ;AACA;AACA;AACA;AACA;AACA,kCAAkC,uBAAuB;AACzD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA,WAAW,KAAK;AAChB;AACA,YAAY,QAAQ;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY;AACZ;AACA;AACA;AACA;AACA;AACA,kCAAkC,WAAW;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;;;AAGA;AACA;AACA;;;AAGA;AACA;;;AAGA;AACA;AACA;AACA;AACA,WAAW,KAAK;AAChB,WAAW,EAAE;AACb;AACA,YAAY,QAAQ;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4EAA4E,wCAAwC;AACpH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mCAAmC,2BAA2B;AAC9D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gEAAgE,mCAAmC;AACnG;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;;;;;;;;ACtKA;AACA;AACA;AACA;;AAEA;;AAEA;;;AAGA;AACA;AACA;AACA;AACA;AACA,WAAW,OAAO;AAClB;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,eAAe,OAAO;AACtB;AACA,gBAAgB,OAAO;AACvB;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA,eAAe,OAAO;AACtB,eAAe,OAAO;AACtB;AACA,gBAAgB,OAAO;AACvB;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA,eAAe,OAAO;AACtB,eAAe,OAAO;AACtB,eAAe,OAAO;AACtB;AACA,gBAAgB,OAAO;AACvB;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,2DAA2D;AAC3D;;AAEA;AACA;AACA;AACA;;;AAGA;AACA;;;AAGA;AACA;;;;;;;;;AC1FA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,OAAO;AAClB;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;;AAGA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;;AAEA;AACA,KAAK;AACL;;;AAGA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;;AAEA;AACA,KAAK;AACL;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;;AAEA;AACA,KAAK;AACL;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;;AAEA;AACA,KAAK;AACL;;;AAGA;AACA;;AAEA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;;AAEA;;AAEA;AACA;;;AAGA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA,KAAK;AACL;;;AAGA;AACA;;;;;;;;ACpLA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA,8BAA8B,YAAY;AAC1C;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA,oBAAoB,kCAAkC;AACtD,wBAAwB,wDAAwD;AAChF;AACA;AACA,oBAAoB,gCAAgC;AACpD;AACA;AACA;AACA,oBAAoB,kCAAkC;AACtD,wBAAwB,qCAAqC;AAC7D;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;;;AAGA;AACA;;;;;;;;ACxEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ;;AAER;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;;AAEb;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA,mCAAmC,iBAAiB;AACpD,iBAAiB;AACjB;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iCAAiC,WAAW;;AAE5C;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL,iCAAiC,YAAY;;AAE7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;;AAGL;AACA;AACA,wBAAwB,+DAA+D;AACvF;AACA;AACA;AACA;;AAEA;AACA,wBAAwB,2CAA2C;AACnE;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;;;AAGA;AACA;;;;;;;;AC/HA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA,uBAAuB,iCAAiC;AACxD;AACA;AACA;AACA,uBAAuB,iCAAiC;AACxD;;AAEA;;AAEA;AACA;AACA;AACA,QAAQ;AACR;;;AAGA;AACA;AACA;;AAEA;AACA;;;AAGA;AACA;AACA;AACA;AACA,+BAA+B,mCAAmC;AAClE,+BAA+B,gCAAgC;AAC/D,kCAAkC,qCAAqC;AACvE;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,mCAAmC,mCAAmC;;AAEtE;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,mCAAmC,6BAA6B;AAChE;;AAEA,yCAAyC,iCAAiC;AAC1E,wBAAwB,qEAAqE;AAC7F,wBAAwB,gCAAgC;AACxD,4BAA4B,gCAAgC;AAC5D,4BAA4B,gCAAgC;AAC5D;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;;AAEA;AACA;;AAEA;AACA,KAAK;;AAEL;AACA;AACA,yCAAyC,6BAA6B;;AAEtE;AACA;AACA,0BAA0B;AAC1B;;AAEA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;;;AAGA;AACA;;;;;;;;ACjJA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA,4BAA4B,kBAAkB;AAC9C;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;;AAEA;AACA;;;AAGA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;;AAGA;AACA;;AAEA,oBAAoB,UAAU;AAC9B;AACA,wBAAwB,UAAU;AAClC;AACA;AACA;;AAEA;AACA;;;AAGA;AACA;;AAEA,oBAAoB,kBAAkB;AACtC;AACA;AACA;AACA;AACA;;AAEA;AACA;;;AAGA;AACA;AACA;;AAEA;AACA;AACA,6BAA6B;;AAE7B;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B,wCAAwC;AACvE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B,wCAAwC;AACvE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mCAAmC,iBAAiB;AACpD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;;AAEA;AACA;;AAEA;AACA,oBAAoB,wCAAwC;AAC5D;;AAEA;AACA,oBAAoB,oBAAoB;AACxC;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA,oBAAoB,wCAAwC;AAC5D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oCAAoC,kBAAkB;AACtD;AACA;AACA;AACA;AACA,aAAa;;AAEb;AACA;AACA;AACA;AACA;AACA,wCAAwC,0DAA0D;AAClG,sCAAsC,0DAA0D;AAChG;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kEAAkE,kBAAkB;;AAEpF;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA,4CAA4C,kBAAkB;AAC9D;AACA,wCAAwC,yBAAyB;AACjE;AACA;AACA;AACA;AACA,6CAA6C,YAAY;AACzD,6CAA6C,YAAY;AACzD;AACA,8CAA8C,uBAAuB;AACrE;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iCAAiC;AACjC,iCAAiC,kBAAkB,GAAG,kBAAkB,GAAG,kBAAkB;AAC7F;AACA;AACA,qBAAqB;AACrB;AACA,0EAA0E,kBAAkB;AAC5F;AACA;AACA,iBAAiB;AACjB,aAAa;AACb;AACA;AACA,kEAAkE,kBAAkB;AACpF;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA,SAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;;AAET;AACA;AACA;AACA;AACA,YAAY;AACZ;AACA,+CAA+C,mBAAmB,iEAAiE,kBAAkB,KAAK,kBAAkB,GAAG,sBAAsB;AACrM;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA,qCAAqC,kBAAkB;AACvD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;;AAEb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;;AAEb;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,wCAAwC,qBAAqB;;AAE7D;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA,yCAAyC;AACzC,uCAAuC;AACvC;AACA;AACA;AACA,yCAAyC,mFAAmF;AAC5H;AACA,8CAA8C,kBAAkB,0CAA0C,kBAAkB,GAAG,qBAAqB;AACpJ;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,SAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,qDAAqD,oBAAoB;AACzE;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA,gCAAgC,mBAAmB;AACnD;AACA;AACA,8BAA8B,yBAAyB;AACvD,8BAA8B,kBAAkB;AAChD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,+CAA+C;AAC/C;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,8BAA8B,wCAAwC;AACtE;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;;;AAGA;AACA;AACA;AACA;AACA,qCAAqC,qBAAqB;AAC1D,0CAA0C,sBAAsB;AAChE,qDAAqD,kBAAkB;AACvE;AACA,6BAA6B,kBAAkB,4BAA4B,iBAAiB;AAC5F,gDAAgD;AAChD,mDAAmD;AACnD,iBAAiB,kBAAkB,GAAG,kBAAkB,GAAG,kBAAkB;AAC7E;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA,uCAAuC,qBAAqB;;AAE5D;AACA,wBAAwB,8BAA8B;AACtD;AACA;AACA;AACA;;AAEA;AACA,wCAAwC,2DAA2D;;AAEnG;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;;AAET;AACA,iCAAiC,yBAAyB;AAC1D;AACA,oCAAoC,kBAAkB;AACtD,iCAAiC,mBAAmB,eAAe,kBAAkB;AACrF;AACA,wBAAwB,kBAAkB;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA,qCAAqC,WAAW;AAChD;AACA,iBAAiB;;AAEjB;AACA;AACA,aAAa;AACb;AACA;;AAEA;;AAEA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA,SAAS,EAAE;;AAEX;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA,iBAAiB;;AAEjB;AACA;AACA;AACA,SAAS,EAAE;;AAEX;AACA;AACA;AACA;AACA;AACA,gDAAgD,gCAAgC;AAChF;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA,6CAA6C,sBAAsB;AACnE;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,aAAa;AACb;;AAEA,gDAAgD,sBAAsB;AACtE,mCAAmC,gDAAgD,SAAS,mBAAmB,gBAAgB;AAC/H;AACA;AACA;AACA;AACA;AACA,gBAAgB;AAChB;AACA;AACA;AACA,gBAAgB;AAChB;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,+BAA+B,qBAAqB;AACpD;AACA,+BAA+B,qBAAqB;AACpD;AACA;;AAEA;AACA;AACA;AACA;AACA,wBAAwB,qBAAqB;AAC7C;AACA,wBAAwB,qBAAqB;AAC7C;AACA;;AAEA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,yBAAyB;AACzB;AACA,yBAAyB;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,8BAA8B,6BAA6B;AAC3D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB,aAAa;;AAEb;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4BAA4B,yBAAyB;AACrD;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gCAAgC,wCAAwC;AACxE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oCAAoC,sBAAsB;AAC1D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kCAAkC,wCAAwC;AAC1E;AACA;AACA;AACA;AACA;AACA,mBAAmB;;AAEnB;AACA;;AAEA;AACA;AACA;AACA;AACA,mBAAmB;AACnB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;;;AAGA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4BAA4B,wCAAwC;AACpE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,oBAAoB;AACpB;AACA;AACA;AACA;;AAEA;AACA;AACA;;;AAGA;;AAEA;AACA;;AAEA;AACA;;;AAGA;AACA;AACA;;;AAGA;AACA;;;;;;;;ACxjDA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;;AAET,gCAAgC,YAAY;AAC5C;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA,QAAQ;AACR;AACA;AACA;AACA;AACA;AACA,QAAQ;;;AAGR;AACA,oBAAoB,kCAAkC;AACtD,oBAAoB,gCAAgC;AACpD;AACA;AACA;AACA;AACA,oBAAoB,kCAAkC;AACtD,wBAAwB,iCAAiC;AACzD,0BAA0B,2CAA2C;AACrE,0BAA0B,2CAA2C;AACrE,0BAA0B,2CAA2C;AACrE,0BAA0B,2CAA2C;AACrE;AACA,wBAAwB,qCAAqC;AAC7D;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;;;AAGA;AACA;;;;;;;;AClHA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;;AAGA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;;AAGL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;;AAET;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,SAAS;AACT;;AAEA;AACA,2BAA2B,2BAA2B;AACtD,2BAA2B,2BAA2B;AACtD;;AAEA;AACA,qBAAqB,kCAAkC;AACvD,wBAAwB,2BAA2B;AACnD;AACA;AACA;AACA,wBAAwB,0BAA0B;AAClD;AACA;AACA,wBAAwB,6BAA6B;AACrD;AACA,4BAA4B,mDAAmD;AAC/E,kCAAkC,0BAA0B;AAC5D,kCAAkC,0BAA0B;AAC5D,gCAAgC,sFAAsF;AACtH;AACA,gCAAgC,0BAA0B;AAC1D,oCAAoC,0BAA0B;AAC9D;AACA;AACA,oCAAoC,0BAA0B;AAC9D;AACA;AACA;AACA,4BAA4B,mDAAmD;AAC/E,kCAAkC,0BAA0B;AAC5D,kCAAkC,0BAA0B;AAC5D,gCAAgC,sFAAsF;AACtH;AACA,gCAAgC,0BAA0B;AAC1D,oCAAoC,0BAA0B;AAC9D;AACA;AACA,oCAAoC,0BAA0B;AAC9D;AACA;AACA;AACA,0BAA0B,4BAA4B;AACtD,wBAAwB,6BAA6B;AACrD;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,KAAK;AACL;;;AAGA;AACA;AACA;;;AAGA;AACA;;;;;;;;ACrJA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;;AAGA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA,2BAA2B,6BAA6B;AACxD;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;;AAET;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,SAAS;AACT;;AAEA;AACA,2BAA2B,2BAA2B;AACtD,2BAA2B,2BAA2B;AACtD,2BAA2B,2BAA2B;AACtD;;AAEA;AACA,qBAAqB,mCAAmC;AACxD,wBAAwB,2BAA2B;AACnD;AACA;AACA;AACA,wBAAwB,0BAA0B;AAClD;AACA;AACA,wBAAwB,6BAA6B;AACrD;AACA,4BAA4B,mDAAmD;AAC/E,kCAAkC,0BAA0B;AAC5D,kCAAkC,0BAA0B;AAC5D,gCAAgC,sFAAsF;AACtH;AACA,gCAAgC,0BAA0B;AAC1D,oCAAoC,0BAA0B;AAC9D;AACA;AACA,oCAAoC,0BAA0B;AAC9D;AACA;AACA;AACA,4BAA4B,mDAAmD;AAC/E,kCAAkC,0BAA0B;AAC5D,kCAAkC,0BAA0B;AAC5D,gCAAgC,sFAAsF;AACtH;AACA,gCAAgC,0BAA0B;AAC1D,oCAAoC,0BAA0B;AAC9D;AACA;AACA,oCAAoC,0BAA0B;AAC9D;AACA,oCAAoC,0BAA0B;AAC9D;AACA;AACA;AACA,4BAA4B,+CAA+C;AAC3E,kCAAkC,0BAA0B;AAC5D,kCAAkC,0BAA0B;AAC5D,gCAAgC,sFAAsF;AACtH;AACA,gCAAgC,0BAA0B;AAC1D,oCAAoC,0BAA0B;AAC9D;AACA;AACA,oCAAoC,0BAA0B;AAC9D;AACA;AACA;AACA;AACA,0BAA0B,4BAA4B;AACtD,wBAAwB,6BAA6B;AACrD;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,QAAQ;AACR;;;AAGA;AACA;AACA;;;AAGA;AACA;;;;;;;;ACtMA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;;AAGA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;;AAGL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;;AAET;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;;AAEA;AACA,6BAA6B,qHAAqH;AAClJ;;AAEA;AACA,2BAA2B,2BAA2B;AACtD;;AAEA;AACA,qBAAqB,mCAAmC;AACxD,wBAAwB,2BAA2B;AACnD;AACA;AACA;AACA,wBAAwB,0BAA0B;AAClD;AACA;AACA,wBAAwB,6BAA6B;AACrD;AACA,4BAA4B,mDAAmD;AAC/E,kCAAkC,0BAA0B;AAC5D,kCAAkC,0BAA0B;AAC5D,gCAAgC,sFAAsF;AACtH;AACA,gCAAgC,0BAA0B;AAC1D,oCAAoC,0BAA0B;AAC9D,sCAAsC,+GAA+G;AACrJ;AACA;AACA,oCAAoC,0BAA0B;AAC9D;AACA;AACA;AACA,0BAA0B,4BAA4B;AACtD,wBAAwB,6BAA6B;AACrD;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,KAAK;AACL;;;AAGA;AACA;AACA;;;AAGA;AACA;;;;;;;;ACxHA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,mDAAmD,0BAA0B;AAC7E;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,iEAAiE,kBAAkB;AACnF;AACA;AACA;AACA,qBAAqB;AACrB;AACA,aAAa;AACb;AACA;AACA;;AAEA;AACA;AACA,SAAS;AACT;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA,0BAA0B;AAC1B;AACA,wCAAwC,8CAA8C,SAAS,qBAAqB;AACpH,aAAa;AACb;AACA;AACA;AACA;AACA;AACA,iBAAiB,eAAe,qBAAqB;AACrD,aAAa;AACb;AACA;AACA,WAAW;AACX;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB;;AAEpB;AACA;AACA;;AAEA;AACA;AACA;AACA,4BAA4B,oBAAoB;AAChD;AACA,gDAAgD,kBAAkB,kBAAkB,iBAAiB;AACrG;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA,2BAA2B;AAC3B,iBAAiB;AACjB,gDAAgD,kBAAkB;AAClE;AACA;AACA,gDAAgD,sBAAsB;AACtE;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+BAA+B,sBAAsB;AACrD;AACA;AACA,+BAA+B,qBAAqB;AACpD;AACA;AACA,+BAA+B,kBAAkB,GAAG,mBAAmB,GAAG,oBAAoB;AAC9F;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2CAA2C,iBAAiB,GAAG,uBAAuB;AACtF;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,mBAAmB;AACnB,aAAa;AACb;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;;AAEA;;AAEA;;AAEA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA,SAAS,EAAE;;;AAGX;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;;AAET;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;;AAEA;;;AAGA;AACA;;;;;;;;AC7lBA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;;AAEA;AACA;AACA,6BAA6B;;AAE7B;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4BAA4B,wCAAwC;AACpE;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4BAA4B,wCAAwC;AACpE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mCAAmC,iBAAiB;AACpD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;;AAEA;AACA;;AAEA;AACA,oBAAoB,wCAAwC;AAC5D;;AAEA;AACA,oBAAoB,oBAAoB;AACxC;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA,oBAAoB,wCAAwC;AAC5D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gCAAgC,wCAAwC;AACxE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oCAAoC,sBAAsB;AAC1D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sCAAsC,wCAAwC;AAC9E;AACA;AACA;AACA;AACA;AACA,mBAAmB;;AAEnB;AACA;;AAEA;AACA;AACA;AACA;AACA,mBAAmB;AACnB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oCAAoC,kBAAkB;AACtD;AACA;AACA;AACA;AACA,aAAa;;AAEb;AACA;AACA;AACA;AACA;AACA,wCAAwC,0DAA0D;AAClG,sCAAsC,0DAA0D;AAChG;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oEAAoE,kBAAkB;;AAEtF;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA,gDAAgD,kBAAkB;AAClE;AACA,wCAAwC,yBAAyB;AACjE;AACA;AACA;AACA;AACA,iDAAiD,YAAY;AAC7D,iDAAiD,YAAY;AAC7D;AACA,8CAA8C,uBAAuB;AACrE;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iCAAiC;AACjC,iCAAiC,kBAAkB,GAAG,kBAAkB,GAAG,kBAAkB;AAC7F;AACA;AACA,qBAAqB;AACrB;AACA,4EAA4E,kBAAkB;AAC9F;AACA;AACA,iBAAiB;AACjB,aAAa;AACb;AACA;AACA,oEAAoE,kBAAkB;AACtF;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA,SAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;;AAET;AACA;AACA;AACA;AACA,YAAY;AACZ;AACA,mDAAmD,mBAAmB,iEAAiE,kBAAkB,KAAK,kBAAkB,GAAG,sBAAsB;AACzM;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,yCAAyC,kBAAkB;AAC3D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;;AAEb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;;AAEb;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,4CAA4C,qBAAqB;;AAEjE;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,2BAA2B,wCAAwC;AACnE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4BAA4B;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB;AAChB;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,6CAA6C;AAC7C,2CAA2C;AAC3C;AACA;AACA;AACA,6CAA6C,mFAAmF;AAChI;AACA,kDAAkD,kBAAkB,0CAA0C,kBAAkB,GAAG,qBAAqB;AACxJ;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,SAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oDAAoD,oBAAoB;AACxE;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,oCAAoC,mBAAmB;AACvD;AACA;AACA,kCAAkC,yBAAyB;AAC3D,kCAAkC,kBAAkB;AACpD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,+CAA+C;AAC/C;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,8BAA8B,wCAAwC;AACtE;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;;AAEA;AACA;AACA;AACA;AACA,yCAAyC,qBAAqB;AAC9D,8CAA8C,sBAAsB;AACpE,yDAAyD,kBAAkB;AAC3E;AACA,iCAAiC,kBAAkB,4BAA4B,iBAAiB;AAChG,oDAAoD;AACpD,uDAAuD;AACvD,iBAAiB,kBAAkB,GAAG,kBAAkB,GAAG,kBAAkB;AAC7E;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,2CAA2C,qBAAqB;;AAEhE;AACA,wBAAwB,8BAA8B;AACtD;AACA;AACA;AACA;;AAEA;AACA,wCAAwC,2DAA2D;;AAEnG;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA,qCAAqC,yBAAyB;AAC9D;AACA,wCAAwC,kBAAkB;AAC1D,qCAAqC,mBAAmB,2BAA2B,kBAAkB,KAAK,kBAAkB;AAC5H;AACA,4BAA4B,kBAAkB;AAC9C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA,qCAAqC,WAAW;AAChD;AACA,iBAAiB;;AAEjB;AACA;AACA,aAAa;AACb;AACA;;AAEA;;AAEA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA,SAAS,EAAE;;AAEX;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA,iBAAiB;;AAEjB;AACA;AACA;AACA,SAAS,EAAE;;AAEX;AACA;AACA;AACA;AACA;AACA,gDAAgD,gCAAgC;AAChF;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,6CAA6C,sBAAsB;AACnE;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,aAAa;AACb;;AAEA,gDAAgD,sBAAsB;AACtE,mCAAmC,gDAAgD,SAAS,mBAAmB,gBAAgB;AAC/H;AACA;AACA;AACA;AACA;AACA,gBAAgB;AAChB;AACA;AACA;AACA,gBAAgB;AAChB;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4BAA4B,qBAAqB;AACjD;AACA;AACA;AACA,MAAM;;AAEN;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,yBAAyB;AACzB;AACA,yBAAyB;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,8BAA8B,6BAA6B;AAC3D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB,aAAa;;AAEb;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4BAA4B,yBAAyB;AACrD;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gCAAgC,iBAAiB;AACjD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;;AAEN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,4BAA4B,qBAAqB;AACjD;AACA,4BAA4B,qBAAqB;AACjD;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4BAA4B,wCAAwC;AACpE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,oBAAoB;AACpB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;;AAGA;AACA;;;;;;;ACx+CA;AACA;AACA;;AAEA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB,OAAO;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kCAAkC,iBAAiB;AACnD,uCAAuC,UAAU;AACjD;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;;;AAGA;AACA;AACA;AACA,+CAA+C,KAAK,4BAA4B,QAAQ;AACxF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uCAAuC;AACvC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA,0CAA0C;AAC1C,yCAAyC;AACzC,+CAA+C;AAC/C,qDAAqD;AACrD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA,4BAA4B,kBAAkB;AAC9C;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;;AAEA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA,2BAA2B,iCAAiC;AAC5D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY;AACZ,6BAA6B,2DAA2D;AACxF;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;;AAGA;AACA;;AAEA,oBAAoB,UAAU;AAC9B;AACA,wBAAwB,UAAU;AAClC;AACA;AACA;;AAEA;AACA;;;AAGA;AACA;;AAEA,oBAAoB,kBAAkB;AACtC;AACA;AACA;AACA;;AAEA;AACA;;;AAGA;AACA;AACA;AACA,YAAY;AACZ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;;AAGA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA,WAAW,OAAO;AAClB,YAAY;AACZ;AACA;AACA,wFAAwF,WAAW;AACnG;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA,uCAAuC,gCAAgC;AACvE;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ;AACR;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8DAA8D,UAAU;AACxE,YAAY;AACZ;AACA,yDAAyD,SAAS;AAClE,YAAY;AACZ;;;;;;;;AChWA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA,WAAW;;AAEX;AACA,6DAA6D,oBAAoB;AACjF,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB;AACzB;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;;;AAGD;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA,SAAS;AACT,mCAAmC,mBAAmB;;AAEtD;AACA,4BAA4B,kBAAkB;AAC9C;AACA;AACA;AACA;AACA,aAAa;AACb,4BAA4B,kBAAkB;AAC9C,6BAA6B;AAC7B;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA,6BAA6B;AAC7B;AACA;AACA;AACA;AACA,yBAAyB;;AAEzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oCAAoC;AACpC;AACA;AACA;AACA;AACA;AACA,4BAA4B;AAC5B;AACA,iBAAiB;AACjB;AACA;AACA;AACA,4BAA4B,kBAAkB;AAC9C;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA,aAAa;AACb;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;;;AAGD;AACA;AACA;AACA;AACA,WAAW,YAAY;;AAEvB;AACA;AACA;AACA,iBAAiB,qBAAqB;AACtC,iBAAiB;AACjB;AACA;AACA,SAAS;AACT,2CAA2C,sEAAsE;AACjH,4CAA4C,uEAAuE;AACnH;;AAEA;AACA;AACA,iCAAiC,qBAAqB;AACtD;AACA,iCAAiC,qBAAqB;AACtD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA,aAAa;AACb,4FAA4F;;AAE5F,0CAA0C;AAC1C,KAAK;;AAEL;AACA;AACA,uBAAuB,+BAA+B;AACtD,uBAAuB,gCAAgC;AACvD,uBAAuB,4BAA4B;AACnD,uBAAuB,6BAA6B;AACpD,uBAAuB;AACvB,YAAY;AACZ,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB,gBAAgB;AACzC,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;;;AAGD;AACA;AACA;AACA;AACA,WAAW,YAAY;;AAEvB;AACA;AACA;AACA,iBAAiB,qBAAqB;AACtC,iBAAiB,sBAAsB;AACvC;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA,SAAS;AACT,2CAA2C,sEAAsE;;AAEjH;AACA;;AAEA;AACA,8BAA8B,qBAAqB;AACnD;AACA,iCAAiC,qBAAqB;AACtD;AACA,aAAa;AACb;AACA,8BAA8B,qBAAqB;AACnD;AACA,iCAAiC,qBAAqB;AACtD;AACA,aAAa;AACb,0CAA0C;AAC1C,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,2CAA2C,8CAA8C;AACzF;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,uCAAuC;AACvC,iCAAiC;AACjC;AACA,6BAA6B;AAC7B;AACA;AACA;AACA,iCAAiC;AACjC;AACA;AACA;AACA,yBAAyB;AACzB;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA,CAAC;;;AAGD;AACA;AACA;AACA;AACA,WAAW,YAAY;;AAEvB;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA,SAAS;AACT,KAAK;;AAEL;AACA;AACA;AACA,iBAAiB,qBAAqB;AACtC,iBAAiB,sBAAsB;AACvC;AACA,SAAS;AACT,2CAA2C,0DAA0D;AACrG,4CAA4C,kEAAkE;AAC9G,4CAA4C,kEAAkE;AAC9G,yCAAyC,uBAAuB;AAChE;AACA;AACA;AACA;AACA;AACA,SAAS;;AAET;AACA;AACA;AACA;;AAEA;AACA,8BAA8B,qBAAqB;AACnD;AACA,iCAAiC,qBAAqB;AACtD;AACA,aAAa;AACb;AACA,8BAA8B,qBAAqB;AACnD;AACA,iCAAiC,qBAAqB;AACtD;AACA,aAAa;AACb;AACA,8BAA8B,qBAAqB;AACnD;AACA,iCAAiC,qBAAqB;AACtD;AACA,aAAa;AACb;AACA,8BAA8B,qBAAqB;AACnD;AACA,iCAAiC,sBAAsB;AACvD;AACA,aAAa;AACb;AACA;AACA;AACA;AACA,uCAAuC;AACvC;AACA;;AAEA;AACA;AACA;AACA,kDAAkD;AAClD;AACA;AACA;AACA;AACA,SAAS;AACT,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,2CAA2C;AAC3C,qCAAqC;AACrC;AACA,iCAAiC;AACjC;AACA;AACA;AACA;AACA;AACA;AACA,6BAA6B;AAC7B;AACA;AACA,yBAAyB;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB,iBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA,CAAC;;;AAGD;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,GAAG;;;AAGH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;AC5oBA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb,SAAS;AACT;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA,0DAA0D,kBAAkB;AAC5E;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;;AAEA;AACA;AACA;AACA,+DAA+D,6BAA6B;AAC5F;AACA,SAAS;AACT;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,wCAAwC,kBAAkB;AAC1D,6CAA6C,yBAAyB;AACtE,4CAA4C,wBAAwB;AACpE,+CAA+C,2BAA2B;AAC1E,+CAA+C,wBAAwB;AACvE,8CAA8C,0BAA0B;AACxE;;AAEA,wCAAwC,yBAAyB;;AAEjE;;AAEA;AACA;;AAEA;AACA;AACA;AACA,8CAA8C,kDAAkD;AAChG;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;;;;;;;;AChJA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,4BAA4B,6BAA6B;AACzD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,sBAAsB,iCAAiC;AACvD,sCAAsC,qBAAqB;AAC3D;;AAEA;AACA,2CAA2C,qBAAqB;AAChE;AACA;AACA;AACA;;;AAGA;AACA","file":"main.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 19);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 82c42ac78f6a5d3a0e7e","/**\n * HTML elements low-level handling.\n *\n * @license The MIT License (MIT)\n * @copyright Stanislav Kalashnik <darkpark.main@gmail.com>\n */\n\n'use strict';\n\n/* eslint no-unused-vars: 0 */\n\n/**\n * DOM manipulation module\n */\nvar dom = {};\n\n\n/**\n * Create a new HTML element.\n *\n * @param {string} tagName mandatory tag name\n * @param {Object|null} [attrList] element attributes\n * @param {...*} [content] element content (primitive value/values or other nodes)\n * @return {Node|null} HTML element or null on failure\n *\n * @example\n * dom.tag('table');\n * dom.tag('div', {}, 'some text');\n * dom.tag('div', {className:'top'}, dom.tag('span'), dom.tag('br'));\n * dom.tag('link', {rel:'stylesheet', type:'text/css', href:'http://some.url/'});\n */\ndom.tag = function ( tagName, attrList, content ) {\n    var node = null,\n        index, name;\n\n    // minimal param is given\n    if ( tagName ) {\n        // empty element\n        node = document.createElement(tagName);\n\n        // optional attribute list is given\n        if ( attrList && typeof attrList === 'object' ) {\n            for ( name in attrList ) {\n                // extend a new node with the given attributes\n                node[name] = attrList[name];\n            }\n        }\n\n        // content (arguments except the first two)\n        for ( index = 2; index < arguments.length; index++ ) {\n            // some data is given\n            if ( arguments[index] ) {\n                // regular HTML tag or plain data\n                node.appendChild(\n                    typeof arguments[index] === 'object' ? arguments[index] : document.createTextNode(arguments[index])\n                );\n            }\n        }\n\n    }\n\n    return node;\n};\n\n\n/**\n * Create a new DocumentFragment filled with the given non-empty elements if any.\n *\n * @param {...*} [node] fragment content (primitive value/values or other nodes)\n * @return {DocumentFragment} new placeholder\n *\n * @example\n * // gives an empty fragment element\n * dom.fragment();\n * // gives a fragment element with 3 div element inside\n * dom.fragment(dom.tag('div'), div2, div3);\n * // mixed case\n * dom.fragment('some text', 123, div3);\n */\ndom.fragment = function ( node ) {\n    // prepare placeholder\n    var fragment = document.createDocumentFragment(),\n        index;\n\n    // walk through all the given elements\n    for ( index = 0; index < arguments.length; index++ ) {\n        node = arguments[index];\n        // some data is given\n        if ( node ) {\n            // regular HTML tag or plain data\n            fragment.appendChild(typeof node === 'object' ? node : document.createTextNode(node));\n        }\n    }\n\n    return fragment;\n};\n\n\n/**\n * Add the given non-empty data (HTML element/text or list) to the destination element.\n *\n * @param {Node} tagDst element to receive children\n * @param {...*} [content] element content (primitive value/values or other nodes)\n * @return {Node|null} the destination element - owner of all added data\n *\n * @example\n * // simple text value\n * add(some_div, 'Hello world');\n * // single DOM Element\n * add(some_div, some_other_div);\n * // DOM Element list\n * add(some_div, div1, div2, div3);\n * // mixed case\n * add(some_div, div1, 'hello', 'world');\n */\ndom.add = function ( tagDst, content ) {\n    var index;\n\n    // valid HTML tag as the destination\n    if ( tagDst instanceof Node ) {\n        // append all except the first one\n        for ( index = 1; index < arguments.length; index++ ) {\n            // some data is given\n            if ( arguments[index] ) {\n                // regular HTML tag or plain data\n                tagDst.appendChild(\n                    typeof arguments[index] === 'object' ? arguments[index] : document.createTextNode(arguments[index])\n                );\n            }\n        }\n\n        return tagDst;\n    }\n\n    return null;\n};\n\n\n/**\n * Remove the given elements from the DOM.\n *\n * @param {...Node} [nodes] element to be removed\n * @return {boolean} operation status (true - all given elements removed)\n *\n * @example\n * dom.remove(document.querySelector('div.test'));\n * dom.remove(div1, div2, div3);\n */\ndom.remove = function ( nodes ) {\n    var count = 0,  // amount of successfully removed nodes\n        index;\n\n    // walk through all the given elements\n    for ( index = 0; index < arguments.length; index++ ) {\n        // valid non-empty tag\n        if ( arguments[index] && arguments[index].parentNode ) {\n            if ( arguments[index].parentNode.removeChild(arguments[index]) === arguments[index] ) {\n                count++;\n            }\n        }\n    }\n\n    return arguments.length > 0 && count === arguments.length;\n};\n\n\ndom.clear = function ( node ) {\n    while ( node.lastChild ) {\n        node.removeChild(node.lastChild);\n    }\n\n    return node;\n};\n\n\n// public\nmodule.exports = dom;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// /home/dp/Projects/sdk/spasdk/dom/index.js\n// module id = 0\n// module chunks = 0","/**\n * @license The MIT License (MIT)\n * @copyright Stanislav Kalashnik <darkpark.main@gmail.com>\n */\n\n'use strict';\n\nvar defaults = {\n    server: localStorage.getItem('server') || 'https://fortnotes.com/',\n    mode: 'cors',\n    credentials: 'include',\n    headers: {\n        Accept: 'application/json, text/plain, */*',\n        'Content-Type': 'application/json'\n    }\n};\n\n\nfunction status ( response ) {\n    if ( response.status >= 200 && response.status < 300 ) {\n        return Promise.resolve(response);\n    } else {\n        return Promise.reject(new Error(response.statusText));\n    }\n}\n\nfunction json ( response ) {\n    return response.json();\n}\n\n\n// public\nmodule.exports = {\n    defaults: defaults,\n\n    get: function ( uri, callback ) {\n        fetch(defaults.server + uri, defaults)\n            .then(status)\n            .then(json)\n            .then(function ( data ) {\n                callback(null, data);\n            })\n            .catch(callback);\n    },\n\n    post: function ( uri, data, callback ) {\n        fetch(defaults.server + uri, Object.assign({}, defaults, {method: 'post', body: JSON.stringify(data)}))\n            .then(status)\n            .then(json)\n            .then(function ( data ) {\n                callback(null, data);\n            })\n            .catch(callback);\n    },\n\n    postForm: function ( uri, data, callback ) {\n        var config = Object.assign({}, defaults, {\n            method: 'post', body: data, headers: {\n                Accept: 'application/json'\n            }\n        });\n\n        fetch(defaults.server + uri, config)\n            .then(status)\n            .then(json)\n            .then(function ( data ) {\n                callback(null, data);\n            })\n            .catch(callback);\n    }\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/js/api.js\n// module id = 1\n// module chunks = 0","/**\n * @license The MIT License (MIT)\n * @copyright Stanislav Kalashnik <darkpark.main@gmail.com>\n */\n\n'use strict';\n\nvar //app       = require('spa-app/lib/core'),\n    Emitter   = require('cjs-emitter'),\n    //counter = 0,\n    focusComponent;\n\n\n/**\n * Base component implementation.\n *\n * Visual element that can handle sub-components.\n * Each component has a DOM element container $node with a set of classes:\n * \"component\" and some specific component class names depending on the hierarchy, for example \"page\".\n * Each component has a unique ID given either from $node.id or from data.id. If not given will generate automatically.\n *\n * @constructor\n * @extends Emitter\n *\n * @param {Object} [config={}] init parameters\n * @param {Element} [config.id] component unique identifier (generated if not set)\n * @param {string} [config.className] space-separated list of classes for \"className\" property of this.$node\n * @param {Element} [config.$node] DOM element/fragment to be a component outer container\n * @param {Element} [config.$body] DOM element/fragment to be a component inner container (by default is the same as $node)\n * @param {Component} [config.parent] link to the parent component which has this component as a child\n * @param {Array.<Component>} [config.children=[]] list of components in this component\n * @param {Object.<string, function>} [config.events={}] list of event callbacks\n * @param {boolean} [config.visible=true] component initial visibility state flag\n * @param {boolean} [config.focusable=true] component can accept focus or not\n * @param {boolean} [config.propagate=false] allow to emit events to the parent component\n *\n * @fires module:stb/component~Component#click\n *\n * @example\n * var component = new Component({\n *     $node: document.getElementById(id),\n *     className: 'bootstrap responsive',\n *     events: {\n *         click: function () { ... }\n *     }\n * });\n * component.add( ... );\n * component.focus();\n */\nfunction Component ( config ) {\n    // current execution context\n    var self    = this,\n        classes, modifiers;\n\n    console.assert(typeof this === 'object', 'must be constructed via new');\n    console.assert(typeof config === 'object', 'wrong config type');\n    console.assert(!('name' in config) || typeof config.name === 'string', 'wrong config.name type');\n    console.assert(!('name' in config) || config.name.length > 0, 'empty config.name');\n    console.assert(!('id' in config) || typeof config.id === 'string', 'wrong config.id type');\n    console.assert(!('id' in config) || config.id.length > 0, 'empty config.id');\n    console.assert(!('id' in config) || document.getElementById(config.id) instanceof Element, 'DOM element was not found');\n    console.assert(!('$node' in config) || config.$node instanceof Element, 'wrong config.$node type');\n    //console.assert('id' in config || '$node' in config, 'config.id or config.$node should be used');\n    console.assert(!('modifiers' in config) || Array.isArray(config.modifiers), 'wrong config.modifiers type');\n    console.assert(!('events' in config) || typeof config.events === 'object', 'wrong config.events type');\n    console.assert(!('hidden' in config) || typeof config.hidden === 'boolean', 'wrong config.hidden type');\n    console.assert(!('focused' in config) || typeof config.focused === 'boolean', 'wrong config.focused type');\n\n    // parent constructor call\n    Emitter.call(this);\n\n    // apply custom name\n    config.name && (this.name = config.name);\n\n    // component DOM container (empty div in case nothing is given)\n    this.$node = config.id ? document.getElementById(config.id) : config.$node || document.createElement('div');\n\n    // todo: use/remove\n    this.$node.removeAttribute('id');\n\n    //this.$node.tabIndex = -1;\n\n    // sanitize\n    modifiers = config.modifiers || [];\n\n    // visibility\n    this.hidden = !!config.hidden;\n    this.hidden && modifiers.push('hidden');\n\n    // enable/disable state\n    this.disabled = !!config.disabled;\n    this.disabled && modifiers.push('disabled');\n\n    // set focus if necessary\n    //config.focused && this.focus();\n\n    classes = [this.name];\n\n    // there are some block modifiers\n    if ( modifiers.length ) {\n        // build class names\n        modifiers.forEach(function ( modifier ) {\n            classes.push(self.name + '--' + modifier);\n        });\n    }\n\n    // apply\n    this.$node.className = classes.join(' ');\n\n    // apply all given events\n    config.events && this.addListeners(config.events);\n\n    // if ( DEVELOP ) {\n    //     if ( typeof config !== 'object' ) {\n    //         throw new Error(__filename + ': wrong config type');\n    //     }\n    //     // init parameters checks\n    //     if ( config.id && typeof config.id !== 'string' ) {\n    //         throw new Error(__filename + ': wrong or empty config.id');\n    //     }\n    //     if ( 'className' in config && (!config.className || typeof config.className !== 'string') ) {\n    //         throw new Error(__filename + ': wrong or empty config.className');\n    //     }\n    //     if ( config.$node && !(config.$node instanceof Element) ) {\n    //         throw new Error(__filename + ': wrong config.$node type');\n    //     }\n    //     if ( config.$body && !(config.$body instanceof Element) ) {\n    //         throw new Error(__filename + ': wrong config.$body type');\n    //     }\n    //     if ( config.parent && !(config.parent instanceof Component) ) {\n    //         throw new Error(__filename + ': wrong config.parent type');\n    //     }\n    //     if ( config.children && !Array.isArray(config.children) ) {\n    //         throw new Error(__filename + ': wrong config.children type');\n    //     }\n    // }\n\n    /**\n     * Component visibility state flag.\n     *\n     * @readonly\n     * @type {boolean}\n     */\n    //this.visible = true;\n\n    /**\n     * Component can accept focus or not.\n     *\n     * @type {boolean}\n     */\n    //this.focusable = true;\n\n    /**\n     * DOM outer handle.\n     *\n     * @type {Element}\n     */\n    //this.$node = null;\n\n    /**\n     * DOM inner handle.\n     * In simple cases is the same as $node.\n     *\n     * @type {Element}\n     */\n    //this.$body = null;\n\n    /**\n     * Link to the parent component which has this component as a child.\n     *\n     * @type {Component}\n     */\n    //this.parent = null;\n\n    /**\n     * List of all children components.\n     *\n     * @type {Component[]}\n     */\n    //this.children = [];\n\n    /**\n     * allow to emit events to the parent component\n     *\n     * @readonly\n     * @type {boolean}\n     */\n    //this.propagate = !!config.propagate;\n\n    // inner handle - the same as outer handler in case nothing is given\n    //this.$body = config.$body || this.$node;\n\n    // set CSS class names\n    //this.$node.className += ' component ' + (config.className || '');\n    // previous approach is not good as it mess with components hierarchy\n    //this.$node.className = this.name + ' ' + (config.className || '');\n\n    // build CSS class chain\n    //this.$node.className = className + ' ' + (config.className || '');\n\n    // apply component id if given, generate otherwise\n    //this.id = config.id || this.$node.id || 'cid' + counter++;\n\n    // apply hierarchy\n    // if ( config.parent ) {\n    //     // add to parent component\n    //     config.parent.add(this);\n    // }\n\n    // apply given visibility\n    // if ( config.visible === false ) {\n    //     // default state is visible\n    //     this.hide();\n    // }\n\n    // apply focus handling method\n    // if ( config.focusable === false ) {\n    //     // can't accept focus\n    //     this.focusable = false;\n    // }\n\n    // a descendant defined own events\n    // if ( this.defaultEvents ) {\n    //     // sanitize\n    //     config.events = config.events || {};\n    //\n    //     if ( DEVELOP ) {\n    //         if ( typeof config.events !== 'object' ) {\n    //             throw new Error(__filename + ': wrong config.events type');\n    //         }\n    //         if ( typeof this.defaultEvents !== 'object' ) {\n    //             throw new Error(__filename + ': wrong this.defaultEvents type');\n    //         }\n    //     }\n    //\n    //     for ( name in this.defaultEvents ) {\n    //         // overwrite default events with user-defined\n    //         config.events[name] = config.events[name] || this.defaultEvents[name];\n    //     }\n    // }\n\n    // apply the given children components\n    // if ( config.children ) {\n    //     // apply\n    //     this.add.apply(this, config.children);\n    // }\n\n    // component activation by mouse\n    this.$node.addEventListener('click', function ( event ) {\n        event.stopPropagation();\n\n        if ( DEVELOP ) {\n            if ( event.ctrlKey ) {\n                //debug.info('\"window.link\" or \"' + self.id + '.component\"', 'this component is now available in global scope');\n                //self.$node.classList.toggle('wired');\n\n                //console.group('component ' + self.constructor.name + ' #' + self.id);\n                console.log(self);\n                //console.dir(self);\n                //console.log(self.$node);\n                //console.dir(self.$node);\n                //console.groupEnd();\n\n                // self.$node.style.outline = '1px dashed green';\n                // self.$node.style.outlineOffset = '-1px';\n\n                event.preventDefault();\n\n                self.focus();\n\n                window.link = self;\n                console.log('this component is now available in global scope as \"window.link\" or \"' + self.id + '.component\"');\n\n                return;\n            }\n        }\n\n        //console.log('DOM event');\n        // left mouse button\n        if ( event.button === 0 && !self.disabled ) {\n            /**\n             * Mouse click event.\n             *\n             * @event module:stb/component~Component#click\n             *\n             * @type {Object}\n             * @property {Event} event click event data\n             */\n            self.events['click']  && self.emit('click', event);\n\n            //console.log('event.defaultPrevented', event.defaultPrevented);\n\n            // apply focus if not canceled\n            !event.defaultPrevented && self.focus();\n        }\n    });\n\n    if ( DEVELOP ) {\n        // expose inner ID to global scope\n        //window[this.id] = this.$node;\n        //window['component' + this.constructor.name + '_' + this.id] = this;\n\n        // expose a link\n        Object.defineProperty(this.$node, 'component', {\n            get: function () {\n                console.warn('Accessing the associated component from a DOM node is a development-only feature!');\n\n                return self;\n            }\n        });\n\n        window.Component = Component;\n\n        //this.$node.component = this.$body.component = this;\n        //this.$node.component = this;\n        //this.$node.title = this.constructor.name + '#' + this.id + ' (outer)';\n        this.$node.title = this.name + ' instance of ' + this.constructor.name;\n        //this.$body.title = this.name + '#' + this.id + ' (inner)';\n    }\n\n    // debug.info('create component ' + this.name + '#' + this.id, null, {\n    //     tags: ['create', 'component', this.name, this.id]\n    // });\n}\n\n\n// inheritance\nComponent.prototype = Object.create(Emitter.prototype);\nComponent.prototype.constructor = Component;\n\n\n/**\n * List of all default event callbacks.\n *\n * @type {Object.<string, function>}\n */\n//Component.prototype.defaultEvents = null;\n\n\n/**\n * Add a new component as a child.\n *\n * @param {...Component} [child] variable number of elements to append\n *\n * @files Component#add\n *\n * @example\n * panel.add(\n *     new Button( ... ),\n *     new Button( ... )\n * );\n */\n// Component.prototype.add = function ( child ) {\n//     var index;\n//\n//     // walk through all the given elements\n//     for ( index = 0; index < arguments.length; index++ ) {\n//         child = arguments[index];\n//\n//         if ( DEVELOP ) {\n//             if ( !(child instanceof Component) ) {\n//                 throw new Error(__filename + ': wrong child type');\n//             }\n//         }\n//\n//         // apply\n//         this.children.push(child);\n//         child.parent = this;\n//\n//         // correct DOM parent/child connection if necessary\n//         if ( child.$node && child.$node.parentNode === null ) {\n//             this.$body.appendChild(child.$node);\n//         }\n//\n//         debug.info('add component ' + child.name + '#' + child.id + ' to ' + this.name + '#' + this.id, null, {\n//             tags: ['add', 'component', this.name, this.id, child.name, child.id]\n//         });\n//\n//         // there are some listeners\n//         if ( this.events.add ) {\n//             /**\n//              * A child component is added.\n//              *\n//              * @event module:stb/component~Component#add\n//              *\n//              * @type {Object}\n//              * @property {Component} item new component added\n//              */\n//             this.emit('add', {item: child});\n//         }\n//\n//         //debug.log('component ' + this.name + '#' + this.id + ' new child: ' + child.name + '#' + child.id);\n//     }\n// };\n\n\n/* @todo: consider activation in future */\n///**\n// * Insert component into the specific position.\n// *\n// * @param {Component} child component instance to insert\n// * @param {number} index insertion position\n// */\n//Component.prototype.insert = function ( child, index ) {\n//    var prevIndex = this.children.indexOf(child);\n//\n//    if ( DEVELOP ) {\n//        if ( arguments.length !== 2 ) { throw new Error(__filename + ': wrong arguments number'); }\n//        if ( !(child instanceof Component) ) { throw new Error(__filename + ': wrong child type'); }\n//    }\n//\n//    if ( prevIndex !== -1 ) {\n//        this.children.splice(prevIndex, 1);\n//        this.$body.removeChild(child.$node);\n//    }\n//\n//    if ( index === this.children.length ) {\n//        this.$body.appendChild(child.$node);\n//    } else {\n//        this.$body.insertBefore(child.$node, this.$body.children[index]);\n//    }\n//    this.children.splice(index, 0, child);\n//\n//    if ( !child.parent ) {\n//        child.parent = this;\n//    }\n//};\n\n\n/**\n * Delete this component and clear all associated events.\n *\n * @fires module:stb/component~Component#remove\n */\nComponent.prototype.remove = function () {\n    var parent = this.$node.parentNode;\n\n    // really inserted somewhere\n    // if ( this.parent ) {\n    //     if ( DEVELOP ) {\n    //         if ( !(this.parent instanceof Component) ) {\n    //             throw new Error(__filename + ': wrong this.parent type');\n    //         }\n    //     }\n    //\n    //     // active at the moment\n    //     if ( app.activePage.activeComponent === this ) {\n    //         this.blur();\n    //         this.parent.focus();\n    //     }\n    //     this.parent.children.splice(this.parent.children.indexOf(this), 1);\n    // }\n\n    // remove all children\n    // this.children.forEach(function ( child ) {\n    //     if ( DEVELOP ) {\n    //         if ( !(child instanceof Component) ) {\n    //             throw new Error(__filename + ': wrong child type');\n    //         }\n    //     }\n    //\n    //     child.remove();\n    // });\n\n    //console.assert(this.$node.parentNode instanceof Element, 'wrong config type');\n\n    // clear DOM\n    parent && parent.removeChild(this.$node);\n\n    /**\n     * Delete this component.\n     *\n     * @event module:stb/component~Component#remove\n     */\n    this.events.remove && this.emit('remove');\n\n    // remove all listeners\n    this.events = {};\n\n    //debug.log('component ' + this.name + '#' + this.id + ' remove', 'red');\n    // debug.info('remove component ' + this.name + '#' + this.id, null, {\n    //     tags: ['remove', 'component', this.name, this.id]\n    // });\n};\n\n\n/**\n * Activate the component.\n * Notify the owner-page and apply CSS class.\n *\n * @param {Object} [data] custom data which passed into handlers\n *\n * @return {boolean} operation status\n *\n * @fires module:stb/component~Component#focus\n */\nComponent.prototype.focus = function ( data ) {\n    var result = false;\n\n    // not already focused\n    //if ( this.focusable && this !== focusComponent ) {\n    if ( this !== focusComponent ) {\n        // notify the current focused component\n        focusComponent && focusComponent.blur();\n\n        // apply\n        this.$node.classList.add(this.name + '--focused');\n        focusComponent = this;\n\n        if ( DEVELOP ) {\n            this.$node.classList.add('develop-focused');\n        }\n\n        /**\n         * Make this component focused.\n         * @event module:stb/component~Component#focus\n         */\n        this.events.focus && this.emit('focus', data);\n\n        // ok\n        result = true;\n    }\n\n    // status\n    return result;\n};\n\n\n/**\n * Remove focus.\n * Change page.activeComponent and notify subscribers.\n *\n * @return {boolean} operation status\n *\n * @fires module:stb/component~Component#blur\n */\nComponent.prototype.blur = function () {\n    var result = false;\n\n    // is it focused\n    if ( this === focusComponent ) {\n        // apply\n        this.$node.classList.remove(this.name + '--focused');\n        focusComponent = null;\n\n        if ( DEVELOP ) {\n            this.$node.classList.remove('develop-focused');\n        }\n\n        /**\n         * Remove focus from this component.\n         * @event module:stb/component~Component#blur\n         */\n        this.events.blur && this.emit('blur');\n\n        // ok\n        result = true;\n    }\n\n    // status\n    return result;\n};\n\n\n/**\n * Make the component visible and notify subscribers.\n *\n * @param {Object} [data] custom data which passed into handlers\n *\n * @return {boolean} operation status\n *\n * @fires module:stb/component~Component#show\n */\nComponent.prototype.show = function ( data ) {\n    var result = false;\n\n    if ( this.hidden ) {\n        // correct style\n        this.$node.classList.remove(this.name + '--hidden');\n        // flag\n        this.hidden = false;\n\n        /**\n         * Make the component visible.\n         * @event module:stb/component~Component#show\n         */\n        this.events.show && this.emit('show', data);\n\n        // ok\n        result = true;\n    }\n\n    // status\n    return result;\n};\n\n\n/**\n * Make the component hidden and notify subscribers.\n *\n * @param {Object} [data] custom data which passed into handlers\n *\n * @return {boolean} operation status\n *\n * @fires module:stb/component~Component#hide\n */\nComponent.prototype.hide = function ( data ) {\n    var result = false;\n\n    if ( !this.hidden ) {\n        // remove focus\n        this.blur();\n\n        // correct style\n        this.$node.classList.add(this.name + '--hidden');\n        // flag\n        this.hidden = true;\n\n        /**\n         * Make the component hidden.\n         * @event module:stb/component~Component#hide\n         */\n        this.events.hide && this.emit('hide', data);\n\n        // ok\n        result = true;\n    }\n\n    // status\n    return result;\n};\n\n\nComponent.prototype.enable = function ( data ) {\n    var result = false;\n\n    if ( this.disabled ) {\n        // correct style\n        this.$node.classList.remove(this.name + '--disabled');\n        // flag\n        this.disabled = false;\n\n        /**\n         * Make the component hidden.\n         * @event module:stb/component~Component#enable\n         */\n        this.events.enable && this.emit('enable', data);\n\n        // ok\n        result = true;\n    }\n\n    // status\n    return result;\n};\n\n\nComponent.prototype.disable = function ( data ) {\n    var result = false;\n\n    if ( !this.disabled ) {\n        // remove focus\n        this.blur();\n\n        // correct style\n        this.$node.classList.add(this.name + '--disabled');\n        // flag\n        this.disabled = true;\n\n        /**\n         * Make the component hidden.\n         * @event module:stb/component~Component#disable\n         */\n        this.events.disable && this.emit('disable', data);\n\n        // ok\n        result = true;\n    }\n\n    // status\n    return result;\n};\n\n\n// public\nmodule.exports = Component;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// /home/dp/Projects/sdk/spasdk/component/index.js\n// module id = 2\n// module chunks = 0","/**\n * @license The MIT License (MIT)\n * @copyright Stanislav Kalashnik <darkpark.main@gmail.com>\n */\n\n/* eslint no-path-concat: 0 */\n\n'use strict';\n\n\n/**\n * Base Events Emitter implementation.\n *\n * @see http://nodejs.org/api/events.html\n * @constructor\n *\n * @example\n * var emitter = new Emitter();\n */\nfunction Emitter () {\n    console.assert(typeof this === 'object', 'must be constructed via new');\n\n    // if ( DEVELOP ) {\n    //     if ( typeof this !== 'object' ) { throw new Error(__filename + ': must be constructed via new'); }\n    // }\n\n    /**\n     * Inner hash table for event names and linked callbacks.\n     * Manual editing should be avoided.\n     *\n     * @member {Object.<string, function[]>}\n     *\n     * @example\n     * {\n     *     click: [\n     *         function click1 () { ... },\n     *         function click2 () { ... }\n     *     ],\n     *     keydown: [\n     *         function () { ... }\n     *     ]\n     * }\n     **/\n    this.events = {};\n}\n\n\nEmitter.prototype = {\n    /**\n     * Bind an event to the given callback function.\n     * The same callback function can be added multiple times for the same event name.\n     *\n     * @param {string} name event identifier\n     * @param {function} callback function to call on this event\n     *\n     * @example\n     * emitter.addListener('click', function ( data ) { ... });\n     * // one more click handler\n     * emitter.addListener('click', function ( data ) { ... });\n     */\n    addListener: function ( name, callback ) {\n        console.assert(arguments.length === 2, 'wrong arguments number');\n        console.assert(typeof name === 'string', 'wrong name type');\n        console.assert(name.length > 0, 'empty name');\n        console.assert(typeof callback === 'function', 'callback should be a function');\n\n        // if ( DEVELOP ) {\n        //     if ( arguments.length !== 2 ) { throw new Error(__filename + ': wrong arguments number'); }\n        //     if ( typeof name !== 'string' || name.length === 0 ) { throw new Error(__filename + ': wrong or empty name'); }\n        //     if ( typeof callback !== 'function' ) { throw new Error(__filename + ': wrong callback type'); }\n        // }\n\n        // initialization may be required\n        this.events[name] = this.events[name] || [];\n        // append this new event to the list\n        this.events[name].push(callback);\n    },\n\n\n    /**\n     * Add a one time listener for the event.\n     * This listener is invoked only the next time the event is fired, after which it is removed.\n     *\n     * @param {string} name event identifier\n     * @param {function} callback function to call on this event\n     *\n     * @example\n     * emitter.once('click', function ( data ) { ... });\n     */\n    once: function ( name, callback ) {\n        // current execution context\n        var self = this;\n\n        if ( DEVELOP ) {\n            if ( arguments.length !== 2 ) {\n                throw new Error(__filename + ': wrong arguments number');\n            }\n            if ( typeof name !== 'string' || name.length === 0 ) {\n                throw new Error(__filename + ': wrong or empty name');\n            }\n            if ( typeof callback !== 'function' ) {\n                throw new Error(__filename + ': wrong callback type');\n            }\n        }\n\n        // initialization may be required\n        this.events[name] = this.events[name] || [];\n        // append this new event to the list\n        this.events[name].push(function onceWrapper () {\n            self.removeListener(name, onceWrapper);\n            callback.apply(self, arguments);\n        });\n    },\n\n\n    /**\n     * Apply multiple listeners at once.\n     *\n     * @param {Object} callbacks event names with callbacks\n     *\n     * @example\n     * emitter.addListeners({\n     *     click: function ( data ) {},\n     *     close: function ( data ) {}\n     * });\n     */\n    addListeners: function ( callbacks ) {\n        var name;\n\n        if ( DEVELOP ) {\n            if ( arguments.length !== 1 ) {\n                throw new Error(__filename + ': wrong arguments number');\n            }\n            if ( typeof callbacks !== 'object' ) {\n                throw new Error(__filename + ': wrong callbacks type');\n            }\n            if ( Object.keys(callbacks).length === 0 ) {\n                throw new Error(__filename + ': no callbacks given');\n            }\n        }\n\n        for ( name in callbacks ) {\n            if ( callbacks.hasOwnProperty(name) ) {\n                this.addListener(name, callbacks[name]);\n            }\n        }\n    },\n\n\n    /**\n     * Remove all instances of the given callback.\n     *\n     * @param {string} name event identifier\n     * @param {function} callback function to remove\n     *\n     * @example\n     * emitter.removeListener('click', func1);\n     */\n    removeListener: function ( name, callback ) {\n        if ( DEVELOP ) {\n            if ( arguments.length !== 2 ) {\n                throw new Error(__filename + ': wrong arguments number');\n            }\n            if ( typeof name !== 'string' || name.length === 0 ) {\n                throw new Error(__filename + ': wrong or empty name');\n            }\n            if ( typeof callback !== 'function' ) {\n                throw new Error(__filename + ': wrong callback type');\n            }\n            if ( this.events[name] && !Array.isArray(this.events[name]) ) {\n                throw new Error(__filename + ': corrupted inner data');\n            }\n        }\n\n        // the event exists and should have some callbacks\n        if ( this.events[name] ) {\n            // rework the callback list to exclude the given one\n            this.events[name] = this.events[name].filter(function callbacksFilter ( fn ) { return fn !== callback; });\n            // event has no more callbacks so clean it\n            if ( this.events[name].length === 0 ) {\n                // as if there were no listeners at all\n                this.events[name] = undefined;\n            }\n        }\n    },\n\n\n    /**\n     * Remove all callbacks for the given event name.\n     * Without event name clears all events.\n     *\n     * @param {string} [name] event identifier\n     *\n     * @example\n     * emitter.removeAllListeners('click');\n     * emitter.removeAllListeners();\n     *\n     * @deprecated\n     */\n    /*removeAllListeners: function ( name ) {\n        if ( DEVELOP ) {\n            if ( arguments.length !== 0 && (typeof name !== 'string' || name.length === 0) ) {\n                throw new Error(__filename + ': wrong or empty name');\n            }\n        }\n\n        // check input\n        if ( arguments.length === 0 ) {\n            // no arguments so remove everything\n            this.events = {};\n        } else if ( name ) {\n            if ( DEVELOP ) {\n                if ( this.events[name] ) { throw new Error(__filename + ': event is not removed'); }\n            }\n\n            // only name is given so remove all callbacks for the given event\n            // but object structure modification should be avoided\n            this.events[name] = undefined;\n        }\n    },*/\n\n\n    /**\n     * Execute each of the listeners in the given order with the supplied arguments.\n     *\n     * @param {string} name event identifier\n     *\n     * @example\n     * emitter.emit('init');\n     * emitter.emit('click', {src: panel1, dst: panel2});\n     * emitter.emit('load', error, data);\n     *\n     * // it's a good idea to emit event only when there are some listeners\n     * if ( this.events['click'] ) {\n     *     this.emit('click', {event: event});\n     * }\n     */\n    emit: function ( name ) {\n        var event = this.events[name],\n            index;\n\n        if ( DEVELOP ) {\n            if ( arguments.length < 1 ) {\n                throw new Error(__filename + ': wrong arguments number');\n            }\n            if ( typeof name !== 'string' || name.length === 0 ) {\n                throw new Error(__filename + ': wrong or empty name');\n            }\n        }\n\n        // the event exists and should have some callbacks\n        if ( event ) {\n            if ( DEVELOP ) {\n                if ( !Array.isArray(event) ) {\n                    throw new Error(__filename + ': wrong event type');\n                }\n            }\n\n            for ( index = 0; index < event.length; index++ ) {\n                if ( DEVELOP ) {\n                    if ( typeof event[index] !== 'function' ) {\n                        throw new Error(__filename + ': wrong event callback type');\n                    }\n                }\n\n                // invoke the callback with parameters\n                event[index].apply(this, Array.prototype.slice.call(arguments, 1));\n            }\n        }\n    }\n};\n\n\n// correct constructor name\nEmitter.prototype.constructor = Emitter;\n\n\n// public\nmodule.exports = Emitter;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// /home/dp/Projects/sdk/cjssdk/emitter/index.js\n// module id = 3\n// module chunks = 0","\"use strict\";var sjcl={cipher:{},hash:{},mode:{},misc:{},codec:{},exception:{corrupt:function(a){this.toString=function(){return\"CORRUPT: \"+this.message};this.message=a},invalid:function(a){this.toString=function(){return\"INVALID: \"+this.message};this.message=a},bug:function(a){this.toString=function(){return\"BUG: \"+this.message};this.message=a}}};\nsjcl.cipher.aes=function(a){this.h[0][0][0]||this.w();var b,c,d,e,f=this.h[0][4],g=this.h[1];b=a.length;var h=1;if(b!==4&&b!==6&&b!==8)throw new sjcl.exception.invalid(\"invalid aes key size\");this.a=[d=a.slice(0),e=[]];for(a=b;a<4*b+28;a++){c=d[a-1];if(a%b===0||b===8&&a%b===4){c=f[c>>>24]<<24^f[c>>16&255]<<16^f[c>>8&255]<<8^f[c&255];if(a%b===0){c=c<<8^c>>>24^h<<24;h=h<<1^(h>>7)*283}}d[a]=d[a-b]^c}for(b=0;a;b++,a--){c=d[b&3?a:a-4];e[b]=a<=4||b<4?c:g[0][f[c>>>24]]^g[1][f[c>>16&255]]^g[2][f[c>>8&255]]^\ng[3][f[c&255]]}};\nsjcl.cipher.aes.prototype={encrypt:function(a){return this.H(a,0)},decrypt:function(a){return this.H(a,1)},h:[[[],[],[],[],[]],[[],[],[],[],[]]],w:function(){var a=this.h[0],b=this.h[1],c=a[4],d=b[4],e,f,g,h=[],i=[],k,j,l,m;for(e=0;e<0x100;e++)i[(h[e]=e<<1^(e>>7)*283)^e]=e;for(f=g=0;!c[f];f^=k||1,g=i[g]||1){l=g^g<<1^g<<2^g<<3^g<<4;l=l>>8^l&255^99;c[f]=l;d[l]=f;j=h[e=h[k=h[f]]];m=j*0x1010101^e*0x10001^k*0x101^f*0x1010100;j=h[l]*0x101^l*0x1010100;for(e=0;e<4;e++){a[e][f]=j=j<<24^j>>>8;b[e][l]=m=m<<24^m>>>8}}for(e=\n0;e<5;e++){a[e]=a[e].slice(0);b[e]=b[e].slice(0)}},H:function(a,b){if(a.length!==4)throw new sjcl.exception.invalid(\"invalid aes block size\");var c=this.a[b],d=a[0]^c[0],e=a[b?3:1]^c[1],f=a[2]^c[2];a=a[b?1:3]^c[3];var g,h,i,k=c.length/4-2,j,l=4,m=[0,0,0,0];g=this.h[b];var n=g[0],o=g[1],p=g[2],q=g[3],r=g[4];for(j=0;j<k;j++){g=n[d>>>24]^o[e>>16&255]^p[f>>8&255]^q[a&255]^c[l];h=n[e>>>24]^o[f>>16&255]^p[a>>8&255]^q[d&255]^c[l+1];i=n[f>>>24]^o[a>>16&255]^p[d>>8&255]^q[e&255]^c[l+2];a=n[a>>>24]^o[d>>16&\n255]^p[e>>8&255]^q[f&255]^c[l+3];l+=4;d=g;e=h;f=i}for(j=0;j<4;j++){m[b?3&-j:j]=r[d>>>24]<<24^r[e>>16&255]<<16^r[f>>8&255]<<8^r[a&255]^c[l++];g=d;d=e;e=f;f=a;a=g}return m}};\nsjcl.bitArray={bitSlice:function(a,b,c){a=sjcl.bitArray.P(a.slice(b/32),32-(b&31)).slice(1);return c===undefined?a:sjcl.bitArray.clamp(a,c-b)},concat:function(a,b){if(a.length===0||b.length===0)return a.concat(b);var c=a[a.length-1],d=sjcl.bitArray.getPartial(c);return d===32?a.concat(b):sjcl.bitArray.P(b,d,c|0,a.slice(0,a.length-1))},bitLength:function(a){var b=a.length;if(b===0)return 0;return(b-1)*32+sjcl.bitArray.getPartial(a[b-1])},clamp:function(a,b){if(a.length*32<b)return a;a=a.slice(0,Math.ceil(b/\n32));var c=a.length;b&=31;if(c>0&&b)a[c-1]=sjcl.bitArray.partial(b,a[c-1]&2147483648>>b-1,1);return a},partial:function(a,b,c){if(a===32)return b;return(c?b|0:b<<32-a)+a*0x10000000000},getPartial:function(a){return Math.round(a/0x10000000000)||32},equal:function(a,b){if(sjcl.bitArray.bitLength(a)!==sjcl.bitArray.bitLength(b))return false;var c=0,d;for(d=0;d<a.length;d++)c|=a[d]^b[d];return c===0},P:function(a,b,c,d){var e;e=0;if(d===undefined)d=[];for(;b>=32;b-=32){d.push(c);c=0}if(b===0)return d.concat(a);\nfor(e=0;e<a.length;e++){d.push(c|a[e]>>>b);c=a[e]<<32-b}e=a.length?a[a.length-1]:0;a=sjcl.bitArray.getPartial(e);d.push(sjcl.bitArray.partial(b+a&31,b+a>32?c:d.pop(),1));return d},k:function(a,b){return[a[0]^b[0],a[1]^b[1],a[2]^b[2],a[3]^b[3]]}};\nsjcl.codec.utf8String={fromBits:function(a){var b=\"\",c=sjcl.bitArray.bitLength(a),d,e;for(d=0;d<c/8;d++){if((d&3)===0)e=a[d/4];b+=String.fromCharCode(e>>>24);e<<=8}return decodeURIComponent(escape(b))},toBits:function(a){a=unescape(encodeURIComponent(a));var b=[],c,d=0;for(c=0;c<a.length;c++){d=d<<8|a.charCodeAt(c);if((c&3)===3){b.push(d);d=0}}c&3&&b.push(sjcl.bitArray.partial(8*(c&3),d));return b}};\nsjcl.codec.hex={fromBits:function(a){var b=\"\",c;for(c=0;c<a.length;c++)b+=((a[c]|0)+0xf00000000000).toString(16).substr(4);return b.substr(0,sjcl.bitArray.bitLength(a)/4)},toBits:function(a){var b,c=[],d;a=a.replace(/\\s|0x/g,\"\");d=a.length;a+=\"00000000\";for(b=0;b<a.length;b+=8)c.push(parseInt(a.substr(b,8),16)^0);return sjcl.bitArray.clamp(c,d*4)}};\nsjcl.codec.base64={D:\"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\",fromBits:function(a,b){var c=\"\",d,e=0,f=sjcl.codec.base64.D,g=0,h=sjcl.bitArray.bitLength(a);for(d=0;c.length*6<h;){c+=f.charAt((g^a[d]>>>e)>>>26);if(e<6){g=a[d]<<6-e;e+=26;d++}else{g<<=6;e-=6}}for(;c.length&3&&!b;)c+=\"=\";return c},toBits:function(a){a=a.replace(/\\s|=/g,\"\");var b=[],c,d=0,e=sjcl.codec.base64.D,f=0,g;for(c=0;c<a.length;c++){g=e.indexOf(a.charAt(c));if(g<0)throw new sjcl.exception.invalid(\"this isn't base64!\");\nif(d>26){d-=26;b.push(f^g>>>d);f=g<<32-d}else{d+=6;f^=g<<32-d}}d&56&&b.push(sjcl.bitArray.partial(d&56,f,1));return b}};sjcl.hash.sha256=function(a){this.a[0]||this.w();if(a){this.n=a.n.slice(0);this.i=a.i.slice(0);this.e=a.e}else this.reset()};sjcl.hash.sha256.hash=function(a){return(new sjcl.hash.sha256).update(a).finalize()};\nsjcl.hash.sha256.prototype={blockSize:512,reset:function(){this.n=this.N.slice(0);this.i=[];this.e=0;return this},update:function(a){if(typeof a===\"string\")a=sjcl.codec.utf8String.toBits(a);var b,c=this.i=sjcl.bitArray.concat(this.i,a);b=this.e;a=this.e=b+sjcl.bitArray.bitLength(a);for(b=512+b&-512;b<=a;b+=512)this.C(c.splice(0,16));return this},finalize:function(){var a,b=this.i,c=this.n;b=sjcl.bitArray.concat(b,[sjcl.bitArray.partial(1,1)]);for(a=b.length+2;a&15;a++)b.push(0);b.push(Math.floor(this.e/\n4294967296));for(b.push(this.e|0);b.length;)this.C(b.splice(0,16));this.reset();return c},N:[],a:[],w:function(){function a(e){return(e-Math.floor(e))*0x100000000|0}var b=0,c=2,d;a:for(;b<64;c++){for(d=2;d*d<=c;d++)if(c%d===0)continue a;if(b<8)this.N[b]=a(Math.pow(c,0.5));this.a[b]=a(Math.pow(c,1/3));b++}},C:function(a){var b,c,d=a.slice(0),e=this.n,f=this.a,g=e[0],h=e[1],i=e[2],k=e[3],j=e[4],l=e[5],m=e[6],n=e[7];for(a=0;a<64;a++){if(a<16)b=d[a];else{b=d[a+1&15];c=d[a+14&15];b=d[a&15]=(b>>>7^b>>>18^\nb>>>3^b<<25^b<<14)+(c>>>17^c>>>19^c>>>10^c<<15^c<<13)+d[a&15]+d[a+9&15]|0}b=b+n+(j>>>6^j>>>11^j>>>25^j<<26^j<<21^j<<7)+(m^j&(l^m))+f[a];n=m;m=l;l=j;j=k+b|0;k=i;i=h;h=g;g=b+(h&i^k&(h^i))+(h>>>2^h>>>13^h>>>22^h<<30^h<<19^h<<10)|0}e[0]=e[0]+g|0;e[1]=e[1]+h|0;e[2]=e[2]+i|0;e[3]=e[3]+k|0;e[4]=e[4]+j|0;e[5]=e[5]+l|0;e[6]=e[6]+m|0;e[7]=e[7]+n|0}};\nsjcl.mode.ccm={name:\"ccm\",encrypt:function(a,b,c,d,e){var f,g=b.slice(0),h=sjcl.bitArray,i=h.bitLength(c)/8,k=h.bitLength(g)/8;e=e||64;d=d||[];if(i<7)throw new sjcl.exception.invalid(\"ccm: iv must be at least 7 bytes\");for(f=2;f<4&&k>>>8*f;f++);if(f<15-i)f=15-i;c=h.clamp(c,8*(15-f));b=sjcl.mode.ccm.G(a,b,c,d,e,f);g=sjcl.mode.ccm.I(a,g,c,b,e,f);return h.concat(g.data,g.tag)},decrypt:function(a,b,c,d,e){e=e||64;d=d||[];var f=sjcl.bitArray,g=f.bitLength(c)/8,h=f.bitLength(b),i=f.clamp(b,h-e),k=f.bitSlice(b,\nh-e);h=(h-e)/8;if(g<7)throw new sjcl.exception.invalid(\"ccm: iv must be at least 7 bytes\");for(b=2;b<4&&h>>>8*b;b++);if(b<15-g)b=15-g;c=f.clamp(c,8*(15-b));i=sjcl.mode.ccm.I(a,i,c,k,e,b);a=sjcl.mode.ccm.G(a,i.data,c,d,e,b);if(!f.equal(i.tag,a))throw new sjcl.exception.corrupt(\"ccm: tag doesn't match\");return i.data},G:function(a,b,c,d,e,f){var g=[],h=sjcl.bitArray,i=h.k;e/=8;if(e%2||e<4||e>16)throw new sjcl.exception.invalid(\"ccm: invalid tag length\");if(d.length>0xffffffff||b.length>0xffffffff)throw new sjcl.exception.bug(\"ccm: can't deal with 4GiB or more data\");\nf=[h.partial(8,(d.length?64:0)|e-2<<2|f-1)];f=h.concat(f,c);f[3]|=h.bitLength(b)/8;f=a.encrypt(f);if(d.length){c=h.bitLength(d)/8;if(c<=65279)g=[h.partial(16,c)];else if(c<=0xffffffff)g=h.concat([h.partial(16,65534)],[c]);g=h.concat(g,d);for(d=0;d<g.length;d+=4)f=a.encrypt(i(f,g.slice(d,d+4)))}for(d=0;d<b.length;d+=4)f=a.encrypt(i(f,b.slice(d,d+4)));return h.clamp(f,e*8)},I:function(a,b,c,d,e,f){var g,h=sjcl.bitArray;g=h.k;var i=b.length,k=h.bitLength(b);c=h.concat([h.partial(8,f-1)],c).concat([0,\n0,0]).slice(0,4);d=h.bitSlice(g(d,a.encrypt(c)),0,e);if(!i)return{tag:d,data:[]};for(g=0;g<i;g+=4){c[3]++;e=a.encrypt(c);b[g]^=e[0];b[g+1]^=e[1];b[g+2]^=e[2];b[g+3]^=e[3]}return{tag:d,data:h.clamp(b,k)}}};\nsjcl.mode.ocb2={name:\"ocb2\",encrypt:function(a,b,c,d,e,f){if(sjcl.bitArray.bitLength(c)!==128)throw new sjcl.exception.invalid(\"ocb iv must be 128 bits\");var g,h=sjcl.mode.ocb2.A,i=sjcl.bitArray,k=i.k,j=[0,0,0,0];c=h(a.encrypt(c));var l,m=[];d=d||[];e=e||64;for(g=0;g+4<b.length;g+=4){l=b.slice(g,g+4);j=k(j,l);m=m.concat(k(c,a.encrypt(k(c,l))));c=h(c)}l=b.slice(g);b=i.bitLength(l);g=a.encrypt(k(c,[0,0,0,b]));l=i.clamp(k(l,g),b);j=k(j,k(l,g));j=a.encrypt(k(j,k(c,h(c))));if(d.length)j=k(j,f?d:sjcl.mode.ocb2.pmac(a,\nd));return m.concat(i.concat(l,i.clamp(j,e)))},decrypt:function(a,b,c,d,e,f){if(sjcl.bitArray.bitLength(c)!==128)throw new sjcl.exception.invalid(\"ocb iv must be 128 bits\");e=e||64;var g=sjcl.mode.ocb2.A,h=sjcl.bitArray,i=h.k,k=[0,0,0,0],j=g(a.encrypt(c)),l,m,n=sjcl.bitArray.bitLength(b)-e,o=[];d=d||[];for(c=0;c+4<n/32;c+=4){l=i(j,a.decrypt(i(j,b.slice(c,c+4))));k=i(k,l);o=o.concat(l);j=g(j)}m=n-c*32;l=a.encrypt(i(j,[0,0,0,m]));l=i(l,h.clamp(b.slice(c),m));k=i(k,l);k=a.encrypt(i(k,i(j,g(j))));if(d.length)k=\ni(k,f?d:sjcl.mode.ocb2.pmac(a,d));if(!h.equal(h.clamp(k,e),h.bitSlice(b,n)))throw new sjcl.exception.corrupt(\"ocb: tag doesn't match\");return o.concat(h.clamp(l,m))},pmac:function(a,b){var c,d=sjcl.mode.ocb2.A,e=sjcl.bitArray,f=e.k,g=[0,0,0,0],h=a.encrypt([0,0,0,0]);h=f(h,d(d(h)));for(c=0;c+4<b.length;c+=4){h=d(h);g=f(g,a.encrypt(f(h,b.slice(c,c+4))))}b=b.slice(c);if(e.bitLength(b)<128){h=f(h,d(h));b=e.concat(b,[2147483648|0])}g=f(g,b);return a.encrypt(f(d(f(h,d(h))),g))},A:function(a){return[a[0]<<\n1^a[1]>>>31,a[1]<<1^a[2]>>>31,a[2]<<1^a[3]>>>31,a[3]<<1^(a[0]>>>31)*135]}};sjcl.misc.hmac=function(a,b){this.M=b=b||sjcl.hash.sha256;var c=[[],[]],d=b.prototype.blockSize/32;this.l=[new b,new b];if(a.length>d)a=b.hash(a);for(b=0;b<d;b++){c[0][b]=a[b]^909522486;c[1][b]=a[b]^1549556828}this.l[0].update(c[0]);this.l[1].update(c[1])};sjcl.misc.hmac.prototype.encrypt=sjcl.misc.hmac.prototype.mac=function(a,b){a=(new this.M(this.l[0])).update(a,b).finalize();return(new this.M(this.l[1])).update(a).finalize()};\nsjcl.misc.pbkdf2=function(a,b,c,d,e){c=c||1E3;if(d<0||c<0)throw sjcl.exception.invalid(\"invalid params to pbkdf2\");if(typeof a===\"string\")a=sjcl.codec.utf8String.toBits(a);e=e||sjcl.misc.hmac;a=new e(a);var f,g,h,i,k=[],j=sjcl.bitArray;for(i=1;32*k.length<(d||1);i++){e=f=a.encrypt(j.concat(b,[i]));for(g=1;g<c;g++){f=a.encrypt(f);for(h=0;h<f.length;h++)e[h]^=f[h]}k=k.concat(e)}if(d)k=j.clamp(k,d);return k};\nsjcl.random={randomWords:function(a,b){var c=[];b=this.isReady(b);var d;if(b===0)throw new sjcl.exception.notready(\"generator isn't seeded\");else b&2&&this.U(!(b&1));for(b=0;b<a;b+=4){(b+1)%0x10000===0&&this.L();d=this.u();c.push(d[0],d[1],d[2],d[3])}this.L();return c.slice(0,a)},setDefaultParanoia:function(a){this.t=a},addEntropy:function(a,b,c){c=c||\"user\";var d,e,f=(new Date).valueOf(),g=this.q[c],h=this.isReady();d=this.F[c];if(d===undefined)d=this.F[c]=this.R++;if(g===undefined)g=this.q[c]=0;this.q[c]=\n(this.q[c]+1)%this.b.length;switch(typeof a){case \"number\":break;case \"object\":if(b===undefined)for(c=b=0;c<a.length;c++)for(e=a[c];e>0;){b++;e>>>=1}this.b[g].update([d,this.J++,2,b,f,a.length].concat(a));break;case \"string\":if(b===undefined)b=a.length;this.b[g].update([d,this.J++,3,b,f,a.length]);this.b[g].update(a);break;default:throw new sjcl.exception.bug(\"random: addEntropy only supports number, array or string\");}this.j[g]+=b;this.f+=b;if(h===0){this.isReady()!==0&&this.K(\"seeded\",Math.max(this.g,\nthis.f));this.K(\"progress\",this.getProgress())}},isReady:function(a){a=this.B[a!==undefined?a:this.t];return this.g&&this.g>=a?this.j[0]>80&&(new Date).valueOf()>this.O?3:1:this.f>=a?2:0},getProgress:function(a){a=this.B[a?a:this.t];return this.g>=a?1[\"0\"]:this.f>a?1[\"0\"]:this.f/a},startCollectors:function(){if(!this.m){if(window.addEventListener){window.addEventListener(\"load\",this.o,false);window.addEventListener(\"mousemove\",this.p,false)}else if(document.attachEvent){document.attachEvent(\"onload\",\nthis.o);document.attachEvent(\"onmousemove\",this.p)}else throw new sjcl.exception.bug(\"can't attach event\");this.m=true}},stopCollectors:function(){if(this.m){if(window.removeEventListener){window.removeEventListener(\"load\",this.o);window.removeEventListener(\"mousemove\",this.p)}else if(window.detachEvent){window.detachEvent(\"onload\",this.o);window.detachEvent(\"onmousemove\",this.p)}this.m=false}},addEventListener:function(a,b){this.r[a][this.Q++]=b},removeEventListener:function(a,b){var c;a=this.r[a];\nvar d=[];for(c in a)a.hasOwnProperty[c]&&a[c]===b&&d.push(c);for(b=0;b<d.length;b++){c=d[b];delete a[c]}},b:[new sjcl.hash.sha256],j:[0],z:0,q:{},J:0,F:{},R:0,g:0,f:0,O:0,a:[0,0,0,0,0,0,0,0],d:[0,0,0,0],s:undefined,t:6,m:false,r:{progress:{},seeded:{}},Q:0,B:[0,48,64,96,128,192,0x100,384,512,768,1024],u:function(){for(var a=0;a<4;a++){this.d[a]=this.d[a]+1|0;if(this.d[a])break}return this.s.encrypt(this.d)},L:function(){this.a=this.u().concat(this.u());this.s=new sjcl.cipher.aes(this.a)},T:function(a){this.a=\nsjcl.hash.sha256.hash(this.a.concat(a));this.s=new sjcl.cipher.aes(this.a);for(a=0;a<4;a++){this.d[a]=this.d[a]+1|0;if(this.d[a])break}},U:function(a){var b=[],c=0,d;this.O=b[0]=(new Date).valueOf()+3E4;for(d=0;d<16;d++)b.push(Math.random()*0x100000000|0);for(d=0;d<this.b.length;d++){b=b.concat(this.b[d].finalize());c+=this.j[d];this.j[d]=0;if(!a&&this.z&1<<d)break}if(this.z>=1<<this.b.length){this.b.push(new sjcl.hash.sha256);this.j.push(0)}this.f-=c;if(c>this.g)this.g=c;this.z++;this.T(b)},p:function(a){sjcl.random.addEntropy([a.x||\na.clientX||a.offsetX,a.y||a.clientY||a.offsetY],2,\"mouse\")},o:function(){sjcl.random.addEntropy(new Date,2,\"loadtime\")},K:function(a,b){var c;a=sjcl.random.r[a];var d=[];for(c in a)a.hasOwnProperty(c)&&d.push(a[c]);for(c=0;c<d.length;c++)d[c](b)}};\nsjcl.json={defaults:{v:1,iter:1E3,ks:128,ts:64,mode:\"ccm\",adata:\"\",cipher:\"aes\"},encrypt:function(a,b,c,d){c=c||{};d=d||{};var e=sjcl.json,f=e.c({iv:sjcl.random.randomWords(4,0)},e.defaults);e.c(f,c);if(typeof f.salt===\"string\")f.salt=sjcl.codec.base64.toBits(f.salt);if(typeof f.iv===\"string\")f.iv=sjcl.codec.base64.toBits(f.iv);if(!sjcl.mode[f.mode]||!sjcl.cipher[f.cipher]||typeof a===\"string\"&&f.iter<=100||f.ts!==64&&f.ts!==96&&f.ts!==128||f.ks!==128&&f.ks!==192&&f.ks!==0x100||f.iv.length<2||f.iv.length>\n4)throw new sjcl.exception.invalid(\"json encrypt: invalid parameters\");if(typeof a===\"string\"){c=sjcl.misc.cachedPbkdf2(a,f);a=c.key.slice(0,f.ks/32);f.salt=c.salt}if(typeof b===\"string\")b=sjcl.codec.utf8String.toBits(b);c=new sjcl.cipher[f.cipher](a);e.c(d,f);d.key=a;f.ct=sjcl.mode[f.mode].encrypt(c,b,f.iv,f.adata,f.tag);return e.encode(e.V(f,e.defaults))},decrypt:function(a,b,c,d){c=c||{};d=d||{};var e=sjcl.json;b=e.c(e.c(e.c({},e.defaults),e.decode(b)),c,true);if(typeof b.salt===\"string\")b.salt=\nsjcl.codec.base64.toBits(b.salt);if(typeof b.iv===\"string\")b.iv=sjcl.codec.base64.toBits(b.iv);if(!sjcl.mode[b.mode]||!sjcl.cipher[b.cipher]||typeof a===\"string\"&&b.iter<=100||b.ts!==64&&b.ts!==96&&b.ts!==128||b.ks!==128&&b.ks!==192&&b.ks!==0x100||!b.iv||b.iv.length<2||b.iv.length>4)throw new sjcl.exception.invalid(\"json decrypt: invalid parameters\");if(typeof a===\"string\"){c=sjcl.misc.cachedPbkdf2(a,b);a=c.key.slice(0,b.ks/32);b.salt=c.salt}c=new sjcl.cipher[b.cipher](a);c=sjcl.mode[b.mode].decrypt(c,\nb.ct,b.iv,b.adata,b.tag);e.c(d,b);d.key=a;return sjcl.codec.utf8String.fromBits(c)},encode:function(a){var b,c=\"{\",d=\"\";for(b in a)if(a.hasOwnProperty(b)){if(!b.match(/^[a-z0-9]+$/i))throw new sjcl.exception.invalid(\"json encode: invalid property name\");c+=d+b+\":\";d=\",\";switch(typeof a[b]){case \"number\":case \"boolean\":c+=a[b];break;case \"string\":c+='\"'+escape(a[b])+'\"';break;case \"object\":c+='\"'+sjcl.codec.base64.fromBits(a[b],1)+'\"';break;default:throw new sjcl.exception.bug(\"json encode: unsupported type\");\n}}return c+\"}\"},decode:function(a){a=a.replace(/\\s/g,\"\");if(!a.match(/^\\{.*\\}$/))throw new sjcl.exception.invalid(\"json decode: this isn't json!\");a=a.replace(/^\\{|\\}$/g,\"\").split(/,/);var b={},c,d;for(c=0;c<a.length;c++){if(!(d=a[c].match(/^([a-z][a-z0-9]*):(?:(\\d+)|\"([a-z0-9+\\/%*_.@=\\-]*)\")$/i)))throw new sjcl.exception.invalid(\"json decode: this isn't json!\");b[d[1]]=d[2]?parseInt(d[2],10):d[1].match(/^(ct|salt|iv)$/)?sjcl.codec.base64.toBits(d[3]):unescape(d[3])}return b},c:function(a,b,c){if(a===\nundefined)a={};if(b===undefined)return a;var d;for(d in b)if(b.hasOwnProperty(d)){if(c&&a[d]!==undefined&&a[d]!==b[d])throw new sjcl.exception.invalid(\"required parameter overridden\");a[d]=b[d]}return a},V:function(a,b){var c={},d;for(d in a)if(a.hasOwnProperty(d)&&a[d]!==b[d])c[d]=a[d];return c},W:function(a,b){var c={},d;for(d=0;d<b.length;d++)if(a[b[d]]!==undefined)c[b[d]]=a[b[d]];return c}};sjcl.encrypt=sjcl.json.encrypt;sjcl.decrypt=sjcl.json.decrypt;sjcl.misc.S={};\nsjcl.misc.cachedPbkdf2=function(a,b){var c=sjcl.misc.S,d;b=b||{};d=b.iter||1E3;c=c[a]=c[a]||{};d=c[d]=c[d]||{firstSalt:b.salt&&b.salt.length?b.salt.slice(0):sjcl.random.randomWords(2,0)};c=b.salt===undefined?d.firstSalt:b.salt;d[c]=d[c]||sjcl.misc.pbkdf2(a,c,b.iter);return{key:d[c].slice(0),salt:c.slice(0)}};\n\n// public\nmodule.exports = sjcl;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/js/sjcl.min.js\n// module id = 4\n// module chunks = 0","/**\n * List of tags with managing\n * @copyright Stanislav Kalashnik <darkpark.main@gmail.com>\n */\n\n'use strict';\n\nvar Emitter = require('cjs-emitter'),\n    api     = require('../api'),\n    // max length of each tag, will be truncated on exceed\n    maxLength = 100;\n\n\nfunction TagManager ( crypto ) {\n    // parent constructor call\n    Emitter.call(this);\n\n    this.crypto = crypto;\n\n    // from server\n    this.data = {};\n    //this.defn = {};\n\n    // decoded to these two lists\n    this.dataTagsNmlist = {};  // {note: 1, site: 2, email: 3}\n    this.dataTagsIdlist = {};  // {1: note, 2: site, 3: email}\n}\n\n\n// inheritance\nTagManager.prototype = Object.create(Emitter.prototype);\nTagManager.prototype.constructor = TagManager;\n\n\nTagManager.prototype.init = function () {\n    var self = this;\n\n    api.get('user/tags', function ( error, data ) {\n        error && console.error(error);\n\n        //console.log('user tags', data);\n\n        if ( !error ) {\n            // valid reply\n            if ( data ) {\n                // apply\n                self.fill(data);\n            } else {\n                // status\n                error = true;\n            }\n        }\n\n        self.emit('data', error, data);\n    });\n};\n\n\nTagManager.prototype.fill = function ( data ) {\n    var id, name;\n\n    console.time('decrypt tags');\n\n    this.data = data;\n    //this.defn = data.defn;\n\n    // decrypt tags\n    for ( id in data ) {\n        name = data[id].name = this.crypto.decrypt(data[id].name);\n\n        // fill service lookup tables of tags by id and by name\n        this.dataTagsNmlist[name] = id = parseInt(id, 10);\n        this.dataTagsIdlist[id] = name;\n    }\n\n    console.timeEnd('decrypt tags');\n};\n\n\n/**\n * Adds new tag id and enc/dev values to the global lookup tables\n * @param {number} id of the new tag\n * @param {string} enc encrypted tag name value\n * @param {string} dec optional decrypted tag name value, decrypted from enc if omitted\n */\nTagManager.prototype.add = function ( id, enc, dec ) {\n    // decrypt name if necessary\n    dec = dec || this.crypto.decrypt(enc, true);\n    this.data[id] = [enc, [], 1];\n    this.dataTagsNmlist[dec] = id;\n    this.dataTagsIdlist[id] = dec;\n};\n\n\n/**\n * Returns the sorted list of tag ids by usage\n * first ids the most used\n */\nTagManager.prototype.sortByUses = function () {\n    var result = [],\n        id, index;\n\n    // prepare list of id/usage\n    for ( id in this.data ) {\n        result.push({id: parseInt(id, 10), uses: this.data[id].uses});\n    }\n\n    // custom sort\n    result.sort(function ( a, b ) {\n        return b.uses - a.uses;\n    });\n\n    // rework output, get rid of objects\n    for ( index = 0; index < result.length; index++ ) {\n        result[index] = result[index].id;\n    }\n\n    return result;\n};\n\n\n/**\n * Converts the array of tags ids to tags names\n * @param data array of tags (integers or encrypted strings)\n * @param prefix string to prepend to each tag name\n * @return {Array} tags names array\n * @example [1,2,'***encrypted string***',3] -> ['ftp','note','ssh','site']\n */\nTagManager.prototype.ids2names = function ( data, prefix ) {\n    var result = [],\n        name, index;\n\n    // check input\n    if ( data && data instanceof Array ) {\n        // get tag names from ids\n        for ( index = 0; index < data.length; index++ ) {\n            // check type\n            if ( isNaN(data[index]) ) {\n                // seems this is a real-time encrypted string\n                if ( (name = this.crypto.decrypt(data[index], true)) !== false ) {\n                    result.push((prefix ? prefix : '') + name);\n                }\n            } else {\n                // seems normal tag id\n                if ( this.dataTagsIdlist[data[index]] ) {\n                    // tag found in the global list\n                    result.push((prefix ? prefix : '') + this.dataTagsIdlist[data[index]]);\n                }\n            }\n        }\n    }\n\n    return result.sort();\n};\n\n\n/**\n * Returns the string of tag names from the tags ids\n * @example [1,2,3] -> \"note site ftp\"\n */\nTagManager.prototype.ids2str = function ( data ) {\n    data = this.ids2names(data);\n\n    return data.length > 0 ? data.join(' ') : '';\n};\n\n\n/**\n * Converts a tags names array to array of ids or encrypted strings\n * @param data tags string\n * @param skipNew optional flag to exclude all new not encrypted values\n * @return array of tags (integers or encrypted strings)\n * @example skipNew=true  ['ftp','note','ssh','site'] -> [1,2,3]\n * @example skipNew=false ['ftp','note','ssh','site'] -> [1,2,'***encrypted string***',3]\n */\nTagManager.prototype.names2ids = function ( data, skipNew ) {\n    var result = [],\n        words, enc, index, name;\n\n    // check input\n    if ( data instanceof Array ) {\n        // list of unique tag names\n        words = [];\n        enc = null;\n\n        // iterate words in the input string\n        for ( index = 0; index < data.length; index++ ) {\n            // shorten too long lines\n            name = data[index].slice(0, maxLength);\n            // check if this word already processed\n            if ( !words.includes(name) ) {\n                if ( this.dataTagsNmlist[name] ) {\n                    // tag found in the global data\n                    result.push(this.dataTagsNmlist[name]);\n                } else {\n                    // not found so encrypt and cache if not skipped\n                    if ( !skipNew && (enc = this.crypto.encrypt(name, true)) !== false ) {\n                        result.push(enc);\n                    }\n                }\n                // add word\n                words.push(name);\n            }\n        }\n    }\n\n    return result;\n};\n\n\n/**\n * Converts a tags string to array of ids or encrypted strings\n * @param data tags string\n * @param skipNew optional flag to exclude all new not encrypted values\n * @return array of tags (integers or encrypted strings)\n * @example skipNew=true  \"ftp note ssh site\" -> [1,2,3]\n * @example skipNew=false \"ftp note ssh site\" -> [1,2,'***encrypted string***',3]\n */\nTagManager.prototype.str2ids = function ( data, skipNew ) {\n    // do convert\n    return this.names2ids(this.str2names(data), skipNew);\n};\n\n\n//    this.NamesMissed = function ( names, data ) {\n//        var result = [];\n//        // check input\n//        if ( data && data.match ) {\n//            // split to separate words\n//            data = data.match(/(\\S+)/g);\n//            if ( data && data instanceof Array ) {\n//                // iterate words in the input string\n//                for ( var i = 0; i < data.length; i++ ) {\n//                    if ( !names.includes(data[i]) ) {\n//                        result.push(data[i]);\n//                    }\n//                }\n//            }\n//        }\n//        return result;\n//    };\n\n\n/**\n * Converts a string to array of words\n * @param data input string\n * @return array of words\n * @example 'ftp -note :ssh !site' -> [\"ftp\",\"-note\",\":ssh\",\"!site\"]\n * @example 'ftp \"my note\" :ssh' -> [\"ftp\",\"my note\",\":ssh\"]\n */\nTagManager.prototype.str2names = function ( data ) {\n    var result = [];\n\n    // check input\n    if ( data && data.match ) {\n        // split to words\n        //data = data.match(/(?:\"[^\"]+\"|[\\S]+)/g);\n        data = data.match(/(\\S+)/g);\n        // not empty list of words\n        if ( data && data instanceof Array ) {\n            // iterate words in the input string\n            data.forEach(function ( word ) {\n                // prevent duplication\n                if ( !result.includes(word) ) {\n                    result.push(word);\n                }\n            });\n        }\n    }\n\n    return result;\n};\n\n\n/**\n * Parses the user input into inner data lists\n * @param data string of tags input\n * @return hash of lists\n */\nTagManager.prototype.strParse = function ( data ) {\n    var self = this,\n        tinc = [],  // included tags ids\n        texc = [],  // excluded tags ids\n        ninc = [],  // included tags names\n        nexc = [],  // excluded tags names\n        winc = [],  // included words (not tags)\n        wexc = [],  // excluded words (not tags)\n        wcmd = [];  // command words\n\n    // prepare sorted list of words and iterate\n    this.str2names(data).sort().forEach(function ( word ) {\n        // find out if there are special chars at the beginning of the word\n        var fchar = word.charAt(0),\n            fexc  = (fchar === '-'),\n            fcmd  = (fchar === ':'),\n            tid;\n\n        // get the word without special chars if present\n        if ( fexc || fcmd ) {\n            word = word.slice(1);\n        }\n        // not empty\n        if ( word ) {\n            // command\n            if ( fcmd ) {\n                wcmd.push(word);\n            } else {\n                // just a tag\n                tid = self.dataTagsNmlist[word];\n\n                // tag id found in the global data\n                if ( tid ) {\n                    if ( fexc ) {\n                        // excluded\n                        texc.push(tid);\n                        nexc.push(word);\n                    } else {\n                        // included\n                        tinc.push(tid);\n                        ninc.push(word);\n                    }\n                } else {\n                    // tag id not found so it's just a word\n                    if ( fexc ) {\n                        wexc.push(word);\n                    } else {\n                        winc.push(word);\n                    }\n                }\n            }\n        }\n    });\n\n    // build result struct\n    return {\n        tinc: tinc,\n        texc: texc,\n        ninc: ninc,\n        nexc: nexc,\n        winc: winc,\n        wexc: wexc,\n        wcmd: wcmd\n    };\n};\n\n\n/**\n * Build the user input string from the parsed inner data\n * @param data hash of lists\n * @return string of tags input\n */\nTagManager.prototype.strBuild = function ( data ) {\n    var list = [];\n\n    // check input and fill the list with the corresponding data\n    if ( data.wcmd && data.wcmd instanceof Array ) {\n        data.wcmd.sort().forEach(function ( item ) {\n            list.push(':' + item);\n        });\n    }\n\n    if ( data.ninc && data.ninc instanceof Array ) {\n        data.ninc.sort().forEach(function ( item ) {\n            list.push(item);\n        });\n    }\n\n    if ( data.nexc && data.nexc instanceof Array ) {\n        data.nexc.sort().forEach(function ( item ) {\n            list.push('-' + item);\n        });\n    }\n\n    if ( data.winc && data.winc instanceof Array ) {\n        data.winc.sort().forEach(function ( item ) {\n            list.push(item);\n        });\n    }\n\n    if ( data.wexc && data.wexc instanceof Array ) {\n        data.wexc.sort().forEach(function ( item ) {\n            list.push('-' + item);\n        });\n    }\n\n    // implode data into one line separated by spaces\n    return list.join(' ');\n};\n\n\nTagManager.prototype.linked = function ( data ) {\n    var result = [],\n        list = {},\n        index;\n\n    if ( data && data instanceof Array ) {\n        if ( data.length === 1 ) {\n            result = this.data[data[0]].notes;\n        } else {\n            data.forEach(function ( id ) {\n                var notes = self.data[id].notes;\n\n                notes.forEach(function ( id ) {\n                    list[id] = (list[id] ? list[id] : 0) + 1;\n                });\n            });\n\n            for ( index in list ) {\n                if ( list[index] === data.length ) {\n                    result.push(parseInt(index, 10));\n                }\n            }\n        }\n    }\n\n    return result;\n};\n\n\n// public\nmodule.exports = TagManager;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/js/models/tag-manager.js\n// module id = 5\n// module chunks = 0","/**\n * @license The MIT License (MIT)\n * @copyright Stanislav Kalashnik <darkpark.main@gmail.com>\n */\n\n'use strict';\n\nvar Component = require('spa-component');\n\n\n/**\n * Base button implementation.\n *\n * Has global options:\n *     Button.prototype.clickDuration - time to apply \"click\" class, does not apply if 0\n *\n * @constructor\n * @extends Component\n *\n * @param {Object} [config={}] init parameters (all inherited from the parent)\n * @param {string} [config.value] button caption text (generated if not set)\n * @param {string} [config.icon] button icon name\n *\n * @example\n * var Button = require('stb/ui/button'),\n *     btnSimple, btnIcon, btnDetached;\n *\n * btnSimple = new Button({\n *     $node: document.getElementById('btnSimple'),\n *     value: 'Simple button'\n * });\n *\n * btnIcon = new Button({\n *     $node: document.getElementById('btnIcon'),\n *     icon: 'menu'\n *     value: 'Button with icon'\n * });\n *\n * btnDetached = new Button({\n *     value: 'Button not added to the page',\n *     className: 'wide'\n * });\n */\nfunction Button ( config ) {\n    console.assert(typeof this === 'object', 'must be constructed via new');\n    console.assert(typeof config === 'object', 'wrong config type');\n\n    //config.name = 'spa-component-button' + (config.className || '');\n\n    // set default className if classList property empty or undefined\n    //config.className = this.name + ' ' + (config.className || '');\n\n    // parent constructor call\n    Component.call(this, config);\n\n    // optional dom\n    // if ( config.icon ) {\n    //     // insert icon\n    //     this.$icon = this.$body.appendChild(document.createElement('div'));\n    //     this.$icon.className = 'icon ' + config.icon;\n    // }\n    //\n    // // insert caption placeholder\n    // this.$text = this.$body.appendChild(document.createElement('div'));\n    // this.$text.classList.add('text');\n\n    if ( config.value ) {\n        // fill it\n        this.$node.innerText = config.value;\n    }\n}\n\n\n// inheritance\nButton.prototype = Object.create(Component.prototype);\nButton.prototype.constructor = Button;\n\n// set component name\nButton.prototype.name = 'button';\n\n\n// time to apply \"click\" class, does not apply if 0\n//Button.prototype.clickDuration = 200;\n\n\n/**\n * List of all default event callbacks.\n *\n * @type {Object.<string, function>}\n */\n// Button.prototype.defaultEvents = {\n//     /**\n//      * Default method to handle mouse click events.\n//      */\n//     click: function () {\n//         // current execution context\n//         var self = this;\n//\n//         this.$node.classList.add('click');\n//\n//         setTimeout(function () {\n//             self.$node.classList.remove('click');\n//         }, this.clickDuration);\n//     },\n//\n//     /**\n//      * Default method to handle keyboard keydown events.\n//      *\n//      * @param {Object} event generated event\n//      */\n//     keydown: function ( event ) {\n//         if ( event.code === keys.enter ) {\n//             // emulate click\n//             // there are some listeners\n//             if ( this.events['click'] ) {\n//                 /**\n//                  * Mouse click event emulation.\n//                  *\n//                  * @event module:stb/ui/button~Button#click\n//                  *\n//                  * @type {Object}\n//                  * @property {Event} event click event data\n//                  */\n//                 this.emit('click', {event: event});\n//             }\n//         }\n//     }\n// };\n\n\n// public\nmodule.exports = Button;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// /home/dp/Projects/sdk/spasdk/component-button/index.js\n// module id = 6\n// module chunks = 0","/**\n * @license The MIT License (MIT)\n * @copyright Stanislav Kalashnik <darkpark.main@gmail.com>\n */\n\n'use strict';\n\nvar Component = require('spa-component'),\n    groups    = {};\n\n\n/**\n * Tab item implementation.\n * This component has redefined methods 'show' and 'hide', use them to switch between tabs.\n * All tab items are created invisible by default.\n *\n * @constructor\n * @extends Component\n *\n * @param {Object} [config={}] init parameters (all inherited from the parent)\n *\n * @example\n * var Tab = require('stb/ui/tab.item'),\n *     tabItem = new Tab({\n *         $node: window.someId,\n *         children: [\n *             new Panel({\n *                 $node: window.anotherId\n *             })\n *         ],\n *         events: {\n *             show: function ( event ) {\n *                 // tab was activated\n *             },\n *             hide: function ( event ) {\n *                 // tab was hidden\n *             }\n *         }\n *     });\n *\n * tabList.add(tabItem);\n */\nfunction Tab ( config ) {\n    console.assert(typeof this === 'object', 'must be constructed via new');\n    console.assert(typeof config === 'object', 'wrong config type');\n\n    // parent constructor call\n    Component.call(this, config);\n\n    this.group = config.group;\n\n    // sanitize\n    //config = config || {};\n\n    // if ( DEVELOP ) {\n    //     if ( typeof config !== 'object' ) {\n    //         throw new Error(__filename + ': wrong config type');\n    //     }\n    //     if ( 'className' in config && (!config.className || typeof config.className !== 'string') ) {\n    //         throw new Error(__filename + ': wrong or empty config.className');\n    //     }\n    // }\n\n    // can't accept focus\n    //config.focusable = config.focusable || false;\n\n    // set default className if classList property empty or undefined\n    //config.className = 'tabItem hidden ' + (config.className || '');\n\n    //config.className += ' hidden';\n\n    // prevent parent hiding\n    //config.visible = null;\n\n    //this.visible = false;\n}\n\n\n// inheritance\nTab.prototype = Object.create(Component.prototype);\nTab.prototype.constructor = Tab;\n\n// set component name\nTab.prototype.name = 'tab';\n\n\n/**\n * Make the tab visible, i.e. set active tab, and notify subscribers.\n * Hide previous visible tab if exists.\n *\n * @param {Object} [data] custom data which passed into handlers\n *\n * @return {boolean} operation status\n *\n * @fires module:stb/ui/tab.item~Tab#show\n */\nTab.prototype.show = function ( data ) {\n    var prev = null;\n\n    // if ( DEVELOP ) {\n    //     if ( !this.parent ) {\n    //         throw new Error(__filename + ': no parent for tab item');\n    //     }\n    //     // if ( this.parent.constructor.name !== 'TabList' ) {\n    //     //     throw new Error(__filename + ': wrong parent for tab item');\n    //     // }\n    //     if ( this.parent.currentTab && !(this.parent.currentTab instanceof Tab) ) {\n    //         throw new Error(__filename + ': wrong current tab item type');\n    //     }\n    // }\n\n    // is it hidden\n    if ( this.hidden ) {\n        // hide previous tab\n        prev = groups[this.group];\n\n        if ( prev ) {\n            prev.hide(data);\n        }\n\n        Component.prototype.show.call(this, data);\n        groups[this.group] = this;\n\n        /*// there are some listeners\n         if ( this.parent.events['switch'] ) {\n         this.parent.emit('switch', {prev: prev, curr: this});\n         }*/\n\n        return true;\n    }\n\n    // nothing was done\n    return true;\n};\n\n\n/**\n * Make the tab hidden and notify subscribers.\n *\n * @return {boolean} operation status\n *\n * @fires module:stb/ui/tab.item~Tab#hide\n */\nTab.prototype.hide = function () {\n    // if ( DEVELOP ) {\n    //     if ( !this.parent ) {\n    //         throw new Error(__filename + ': no parent for tab item');\n    //     }\n    //     // if ( this.parent.constructor.name !== 'TabList' ) {\n    //     //     throw new Error(__filename + ': wrong parent for tab item');\n    //     // }\n    //     if ( this.parent.currentTab && !(this.parent.currentTab instanceof Tab) ) {\n    //         throw new Error(__filename + ': wrong current tab item type');\n    //     }\n    // }\n\n    if ( Component.prototype.hide.call(this) ) {\n        groups[this.group] = null;\n\n        return true;\n    }\n\n    // nothing was done\n    return true;\n};\n\n\n// public\nmodule.exports = Tab;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// /home/dp/Projects/sdk/spasdk/component-tab/index.js\n// module id = 7\n// module chunks = 0","/**\n * Main application object\n * @license The MIT License (MIT)\n * @copyright Stanislav Kalashnik <darkpark.main@gmail.com>\n */\n\n'use strict';\n\nvar sjcl = require('./sjcl.min');\n\n\nvar app = new function () {\n    /* @var for limited scopes */\n    var self = this;\n\n    /* @var list of vars */\n    this.data = {};\n\n    /* @var private primary password (accessed only indirectly) */\n    var pass = null;\n\n    /* @var hash of the given pass (if not set then the pass was not created) */\n    var hash = null;\n\n    /* @var time in seconds for pass caching (default 5 mins) */\n    //var time = 300;\n\n    /* @var encode/decode default configuration */\n    var params = {ks: 256, ts: 128, mode: 'ccm', cipher: 'aes'};\n\n    /* @var list of encryption core subsribers to be notified on open/close events */\n    this.subscribers = [];\n\n    /** ??????????\n     * Callback function for primary password request\n     * should be set on application level\n     */\n    this.RequestPass = null;\n\n    // lists for cached enc/dec values\n    // to prevent unnecessary encryption/decryption\n    // filling optionally and clearing on master password expiration\n    var cacheEnc = {};  // \"plain_text\":'***encoded string***' list\n    var cacheDec = {};  // '***encoded string***':\"plain_text\" list\n\n\n    /**\n     * Set global variable\n     * @param name the name of value to store\n     * @param value the variable value\n     * @param persistent flag to store in the local storage permanently\n     */\n    this.set = function ( name, value, persistent ) {\n        if ( persistent ) {\n            localStorage.setItem(name, value);\n        } else {\n            this.data[name] = value;\n        }\n    };\n\n\n    /**\n     * Get global variable\n     * @param name the name of value to retrive\n     * @param ifnull default value if variable is not set\n     */\n    this.get = function ( name, ifnull ) {\n        return this.data[name] || localStorage.getItem(name) || ifnull;\n    };\n\n\n    /**\n     * Calculate the hash from given value\n     * algorithm: sha256\n     */\n    this.calcHash = function ( value ) {\n        return sjcl.codec.hex.fromBits(sjcl.hash.sha256.hash(value));\n    };\n\n\n    /**\n     * Check if hash set\n     */\n    this.hasHash = function () {\n        return (hash != null && hash != '');\n    };\n\n\n    /**\n     * Check if pass set\n     */\n    this.hasPass = function () {\n        return (pass !== null && pass !== '');\n    };\n\n\n    /**\n     * Check if pass set and matches the hash\n     * @param value the master password to check\n     */\n    this.checkPass = function ( value ) {\n        // check input\n        if ( !this.hasHash() || !value ) {\n            return false;\n        }\n        // comparing\n        return (hash === this.calcHash(value));\n    };\n\n\n    /**\n     * Set the hash of private pass var\n     * @param value the master password hash value\n     */\n    this.setPassHash = function ( value ) {\n        // check input\n        if ( !value ) {\n            return false;\n        }\n\n        // set and return\n        return (hash = value);\n    };\n\n\n    /**\n     * Set the time to remember the password\n     * @param newtime the time in seconds for pass caching\n     */\n    // this.SetPassTime = function ( newtime ) {\n    //     // check input\n    //     newtime = parseInt(newtime, 10);\n    //     if ( !newtime || newtime == NaN || newtime <= 0 ) return false;\n    //     time = newtime;\n    //     return true;\n    // };\n\n\n    /**\n     * Set the private pass var and start timer for clearing it in some time\n     * @param value the master password to check\n     */\n    this.setPass = function ( value ) {\n        //console.log('SetPass', value);\n        // check input\n        if ( !value ) {\n            return false;\n        }\n        // set the private password\n        pass = value;\n        // calculate and set hash if necessary\n        if ( !this.hasHash() ) {\n            this.setPassHash(this.calcHash(value));\n        }\n        //console.log('pass will expire in', time);\n        // set clearing timer\n        //setTimeout(function(){self.expirePass()}, time * 1000);\n        // notify all the subscribers that we have the pass\n        for ( var i in this.subscribers ) {\n            if ( self.subscribers[i].EventOpen && self.subscribers[i].EventOpen instanceof Function ) {\n                // open the subscriber - decrypt all the data and show it\n                self.subscribers[i].EventOpen();\n            }\n        }\n\n        // return password hash value\n        return hash;\n    };\n\n\n    /**\n     *\n     */\n    this.expirePass = function () {\n        console.log('master password expire');\n        // notify all the subscribers about clearing\n        for ( var i in self.subscribers ) {\n            if ( typeof self.subscribers[i].EventClose === 'function' ) {\n                // close the subscriber - clear all the decrypted data\n                self.subscribers[i].EventClose();\n            }\n        }\n        // clear the master pass\n        pass = null;\n        // clear cache\n        cacheEnc = {};\n        cacheDec = {};\n        // ask for pass\n        if ( self.RequestPass && self.RequestPass instanceof Function ) {\n            self.RequestPass.call();\n        }\n    };\n\n\n    /**\n     * Encrypt the given text and pass the result to callback function\n     * @param data data for encryption\n     * @param cache optional bool flag\n     *\n     */\n    this.encode = function ( data, cache ) {\n        // password is present and not empty input\n        if ( pass && data !== false && data !== null ) {\n            // try to get from cache\n            if ( cache && cacheEnc[data] ) {\n                return cacheEnc[data];\n            }\n\n            // protected block\n            try {\n                var enc = sjcl.encrypt(pass, data, params);\n                // fill cache if necessary\n                if ( cache ) {\n                    cacheEnc[data] = enc;\n                    cacheDec[enc] = data;\n                }\n\n                return enc;\n            } catch ( e ) {\n                console.trace();\n                console.log('encrypt failure', e, data);\n            }\n        }\n\n        return false;\n    };\n\n    // this.encode = function ( text, callback ) {\n    //    // temporary pass storing not to loose in on timer clearing\n    //    var ptmp = pass;\n    //    // password is cached so do encryption immediately\n    //    if ( ptmp ) {\n    //        callback.call(this, sjcl.encrypt(ptmp, text, params));\n    //        return true;\n    //    } else {\n    //        // ask for password and then do encryption\n    //        if ( this.RequestPass && this.RequestPass instanceof Function ) {\n    //            this.RequestPass.call(this, function(){\n    //                // pass encryption to the callback\n    //                callback.call(this, sjcl.encrypt(pass, text, params));\n    //                return true;\n    //            });\n    //        }\n    //        return false;\n    //    }\n    // }\n\n    /**\n     * Decrypt the given text and pass the result to callback function\n     * @param data data to be decrypted\n     * @param cache optional bool flag\n     */\n    this.decode = function ( data, cache ) {\n        // password is present and not empty input\n        if ( pass && data ) {\n            // try to get from cache\n            if ( cache && cacheDec[data] ) {\n                return cacheDec[data];\n            }\n\n            // protected block\n            try {\n                var dec = sjcl.decrypt(pass, data);\n                // fill cache if necessary\n                if ( cache ) {\n                    cacheDec[data] = dec;\n                    cacheEnc[dec] = data;\n                }\n\n                return dec;\n            } catch ( e ) {\n                console.trace();\n                console.log('decrypt failure', e, data);\n            }\n        }\n\n        return false;\n    };\n\n\n    // this.decode = function ( text, callback ) {\n    //    // temporary pass storing not to loose in on timer clearing\n    //    var ptmp = pass;\n    //    // password is cached so do encryption immediately\n    //    if ( ptmp ) {\n    //        callback.call(this, sjcl.decrypt(ptmp, text));\n    //        return true;\n    //    } else {\n    //        // ask for password and then do encryption\n    //        if ( this.RequestPass && this.RequestPass instanceof Function ) {\n    //            this.RequestPass.call(this, function(){\n    //                // pass decryption to the callback\n    //                callback.call(this, sjcl.decrypt(pass, text));\n    //                return true;\n    //            });\n    //        }\n    //        return false;\n    //    }\n    // }\n\n    this.subscribe = function ( component ) {\n        this.subscribers.push(component);\n    };\n};\n\n\n// public\nmodule.exports = app;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/js/app.js\n// module id = 8\n// module chunks = 0","/**\n * @license The MIT License (MIT)\n * @copyright Stanislav Kalashnik <darkpark.main@gmail.com>\n */\n\n'use strict';\n\nvar list = [\n        {\n            id: 1,\n            max: 1024,\n            name: 'line',\n            icon: 'https://image.flaticon.com/icons/svg/23/23187.svg',\n            description: 'title or short one line text description'\n        },\n        {\n            id: 2,\n            max: 2048,\n            name: 'uri',\n            icon: 'https://image.flaticon.com/icons/svg/117/117965.svg',\n            description: 'any addresses - http/https/ftp/ssh or file path'},\n        {\n            id: 3,\n            max: 1024,\n            name: 'login',\n            icon: 'https://image.flaticon.com/icons/svg/149/149452.svg',\n            description: 'user name, login or email in some cases'\n        },\n        {\n            id: 4,\n            max: 4096,\n            name: 'password',\n            icon: 'https://image.flaticon.com/icons/svg/263/263069.svg',\n            description: 'any secret letters sequence'\n        },\n        {\n            id: 5,\n            max: 1024,\n            name: 'email',\n            icon: 'https://image.flaticon.com/icons/svg/60/60381.svg',\n            description: 'email address line'\n        },\n        {\n            id: 6,\n            max: 65535,\n            name: 'text',\n            icon: 'https://image.flaticon.com/icons/svg/140/140952.svg',\n            description: 'plain text entry for notes'\n        },\n        {\n            id: 7,\n            max: 65535,\n            name: 'html',\n            icon: 'https://image.flaticon.com/icons/svg/25/25252.svg',\n            description: 'formatted text entry for notes'\n        }\n    ],\n    hash = {};\n\n\nlist.forEach(function ( type ) {\n    hash[type.id] = type;\n});\n\n\n// public\nmodule.exports = {\n    list: list,\n    hash: hash\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/js/data.entry.types.js\n// module id = 9\n// module chunks = 0","/**\n * List of note templates\n * @license The MIT License (MIT)\n * @copyright Stanislav Kalashnik <darkpark.main@gmail.com>\n */\n\n'use strict';\n\nvar tag = require('spa-dom').tag,\n    List = require('spa-component-list');\n\n\nfunction TemplateList ( config ) {\n    config.modifiers = ['template-list'];\n\n    // parent constructor call\n    List.call(this, config);\n\n    /*this.$title = this.$node.appendChild(\n        tag('div', {className: this.name + '__title'}, 'Templates')\n    );\n\n    this.$items = this.$node.appendChild(\n        tag('div', {className: this.name + '__items'})\n    );\n\n    this.fill(config.data);*/\n}\n\n\n// inheritance\nTemplateList.prototype = Object.create(List.prototype);\nTemplateList.prototype.constructor = TemplateList;\n\n// set component name\n//TemplateList.prototype.name = 'template-list';\n\n\nTemplateList.prototype.render = function ( $item, template ) {\n    var self  = this,\n        //$icon = tag('img', {className: self.name + '__item-icon', src: 'https://image.flaticon.com/icons/svg/137/137132.svg'}),\n        $icon = tag('img', {className: self.name + '__item-icon', src: 'img/tags/' + template.name + '.svg'}),\n        //$icon = tag('div', {className: self.name + '__item-icon'}),\n        //$icon = tag('div', {className: self.name + '__item-icon'}, tag('img', {src: 'img/tags/' + template.tag + '.svg'})),\n        $name = tag('div', {className: self.name + '__item-name'}, template.name),\n        $hint = tag('div', {className: self.name + '__item-hint'}, template.description),\n        $body = tag('div', {className: self.name + '__item-body'}, $name, $hint);\n\n    //$icon.style.backgroundImage = 'url(img/tags/' + template.tag + '.svg)';\n\n    // use template for a new note creation\n    // $item.addEventListener('click', function () {\n    //     //self.hide();\n    //     self.emit('create', template);\n    // });\n\n    $item.appendChild($icon);\n    $item.appendChild($body);\n    //$item.appendChild($name);\n    //$item.appendChild($hint);\n};\n\n\n// public\nmodule.exports = TemplateList;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/js/template-list.js\n// module id = 10\n// module chunks = 0","/**\n * @license The MIT License (MIT)\n * @copyright Stanislav Kalashnik <darkpark.main@gmail.com>\n */\n\n/* eslint no-path-concat: 0 */\n\n'use strict';\n\nvar Emitter = require('cjs-emitter'),\n    Gettext = require('cjs-gettext'),\n    loader  = new Emitter();\n\n\n/**\n * Wrap the given data with gettext instance\n * and export methods to the global scope.\n *\n * @param {Object} [data] localization data\n *\n * @return {Gettext} gettext instance\n */\nfunction prepare ( data ) {\n    var gettext = new Gettext(data);\n\n    // make it global\n    window.gettext  = window._ = gettext.gettext;\n    window.pgettext = gettext.pgettext;\n    window.ngettext = gettext.ngettext;\n\n    return gettext;\n}\n\n\n/**\n * Main application language\n */\nloader.defaultLanguage = 'en';\n\n\n/**\n * Simple gettext implementation.\n *\n * @param {Object} config options\n * @param {string} [config.path=lang] relative path to project root\n * @param {string} config.name language name\n * @param {string} [config.ext=json] language file extension\n * @param {function} callback hook on ready\n *\n * @return {boolean} flag is ajax request was made\n */\nloader.load = function ( config, callback ) {\n    var xhr;\n\n    if ( DEVELOP ) {\n        if ( !config.name || typeof config.name !== 'string' ) {\n            throw new Error(__filename + ': config.name must be a nonempty string');\n        }\n        if ( typeof callback !== 'function' ) {\n            throw new Error(__filename + ': wrong callback type');\n        }\n    }\n\n    // defaults\n    config.ext  = config.ext  || 'json';\n    config.path = config.path || 'lang';\n\n    // is it necessary to request a localization file?\n    if ( config.name === loader.defaultLanguage ) {\n        // no\n        prepare();\n        callback(null);\n\n        return false;\n    }\n\n    // yes\n    xhr = new XMLHttpRequest();\n\n    xhr.onload = function () {\n        var json;\n\n        try {\n            json = JSON.parse(xhr.responseText);\n\n            prepare(json);\n            callback(null);\n\n            // there are some listeners\n            if ( loader.events['load'] ) {\n                // notify listeners\n                loader.emit('load');\n            }\n        } catch ( error ) {\n            xhr.onerror(error);\n        }\n    };\n\n    xhr.ontimeout = xhr.onerror = function ( error ) {\n        prepare();\n        callback(error);\n\n        // there are some listeners\n        if ( loader.events['error'] ) {\n            // notify listeners\n            loader.emit('error', error);\n        }\n    };\n\n    xhr.open('GET', config.path + '/' + config.name + '.' + config.ext, true);\n    xhr.send(null);\n\n    return true;\n};\n\n\n// public\nmodule.exports = loader;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// /home/dp/Projects/sdk/spasdk/gettext/index.js\n// module id = 11\n// module chunks = 0","/**\n * Main application object\n * @license The MIT License (MIT)\n * @copyright Stanislav Kalashnik <darkpark.main@gmail.com>\n */\n\n'use strict';\n\nvar sjcl   = require('./sjcl.min'),\n    params = {ks: 256, ts: 128, mode: 'ccm', cipher: 'aes'},\n    collectTimer;\n\n\nfunction Crypto () {\n    var self = this,\n        pass = null,\n        hash = null;\n\n    // Check if hash set\n    this.hasHash = function () {\n        return (typeof hash === 'string' && hash !== '');\n    };\n\n\n    // Check if pass set\n    this.hasPass = function () {\n        return (typeof pass === 'string' && pass !== '');\n    };\n\n\n    // Check if pass set and matches the hash\n    // @param value the master password to check\n    this.checkPass = function ( value ) {\n        // check input\n        if ( !hash || !value ) {\n            return false;\n        }\n\n        // comparing\n        return (hash === self.calcHash(value));\n    };\n\n\n    // Set the hash of private pass var\n    // @param value the master password hash value\n    this.setPassHash = function ( value ) {\n        // check input\n        if ( !value ) {\n            return false;\n        }\n\n        // set and return\n        return (hash = value);\n    };\n\n\n    // Set the private pass var and start timer for clearing it in some time\n    // @param value the master password to check\n    this.setPass = function ( value ) {\n        // check input\n        if ( !value ) {\n            return false;\n        }\n\n        // set the private password\n        pass = value;\n\n        // calculate and set hash\n        self.setPassHash(self.calcHash(value));\n\n        // return password hash value\n        return hash;\n    };\n\n\n    // Encrypt the given text and pass the result to callback function\n    // @param data data for encryption\n    this.encrypt = function ( data ) {\n        // password is present and not empty input\n        if ( pass && typeof data === 'string' ) {\n            try {\n                return sjcl.encrypt(pass, data, params);\n            } catch ( error ) {\n                console.error(error);\n            }\n        }\n\n        return false;\n    };\n\n\n    // Decrypt the given text and pass the result to callback function\n    // @param data data to be decrypted\n    this.decrypt = function ( data ) {\n        // password is present and not empty input\n        if ( pass && data ) {\n            try {\n                return sjcl.decrypt(pass, data);\n            } catch ( error ) {\n                console.error(error);\n            }\n        }\n\n        return false;\n    };\n}\n\n\n// correct constructor name\nCrypto.prototype.constructor = Crypto;\n\n\n// Calculate the hash from given value\n// algorithm: sha256\nCrypto.prototype.calcHash = function ( value ) {\n    return sjcl.codec.hex.fromBits(sjcl.hash.sha256.hash(value));\n};\n\n\n// public\nmodule.exports = Crypto;\n\n\n// start entropy collection\nsjcl.random.startCollectors();\n// check each 1 sec if has enough\ncollectTimer = setInterval(function () {\n    if ( sjcl.random.isReady() ) {\n        console.log('entropy collected');\n        // has enough\n        sjcl.random.stopCollectors();\n        // stop checking\n        clearInterval(collectTimer);\n    }\n}, 1000);\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/js/crypto.js\n// module id = 12\n// module chunks = 0","/**\n * @license The MIT License (MIT)\n * @copyright Stanislav Kalashnik <darkpark.main@gmail.com>\n */\n\n/* eslint no-path-concat: 0 */\n\n'use strict';\n\nvar Component = require('spa-component'),\n    visiblePage;\n\n\n/**\n * Base page implementation.\n *\n * A full-screen top-level layer that can operate as an independent separate entity.\n * It is added to the document body on creation if not already linked.\n *\n * @constructor\n * @extends Component\n *\n * @param {Object} [config={}] init parameters (all inherited from the parent)\n *\n * @example\n * var Page = require('stb/ui/page'),\n *     page = new Page({\n *         $node: document.getElementById(id)\n *     });\n *\n * page.addListener('show', function show () {\n *     // page is visible now\n * });\n */\nfunction Page ( config ) {\n    console.assert(typeof this === 'object', 'must be constructed via new');\n    console.assert(typeof config === 'object', 'wrong config type');\n\n    // parent constructor call\n    Component.call(this, config);\n\n\n    /**\n     * Page visibility/active state flag.\n     *\n     * @readonly\n     * @type {boolean}\n     */\n    //this.active = false;\n\n    /**\n     * Link to the currently active component with focus.\n     *\n     * @readonly\n     * @type {Component}\n     */\n    //this.activeComponent = null;\n\n    // set default className if classList property empty or undefined\n    //config.className = 'page ' + (config.className || '');\n\n    //config.className = this.CLASS_NODE;\n\n    // state flag\n    //this.active = this.$node.classList.contains('active');\n\n    // correct DOM parent/child connection if necessary\n    // if ( this.$node.parentNode === null ) {\n    //     document.body.appendChild(this.$node);\n    // }\n\n    // always itself\n    //this.page = this;\n}\n\n\n// inheritance\nPage.prototype = Object.create(Component.prototype);\nPage.prototype.constructor = Page;\n\n// set component name\nPage.prototype.name = 'page';\n\n//Page.prototype.CLASS_NODE = 'page';\n\n\n/**\n * Make the page visible, i.e. set active page, and notify subscribers.\n * Hide previous visible page if exists.\n *\n * @param {Object} [data] custom data which passed into handlers\n *\n * @return {boolean} operation status\n *\n * @fires module:stb/ui/page.item~Page#show\n */\nPage.prototype.show = function ( data ) {\n    var prev = null;\n\n    // if ( DEVELOP ) {\n    //     if ( !this.parent ) {\n    //         throw new Error(__filename + ': no parent for page item');\n    //     }\n    //     // if ( this.parent.constructor.name !== 'PageList' ) {\n    //     //     throw new Error(__filename + ': wrong parent for page item');\n    //     // }\n    //     if ( this.parent.currentPage && !(this.parent.currentPage instanceof Page) ) {\n    //         throw new Error(__filename + ': wrong current page item type');\n    //     }\n    // }\n\n    // is it hidden\n    if ( this.hidden ) {\n        // hide previous page\n        prev = visiblePage;\n\n        if ( prev ) {\n            prev.hide(data);\n        }\n\n        Component.prototype.show.call(this, data);\n        visiblePage = this;\n\n        /*// there are some listeners\n         if ( this.parent.events['switch'] ) {\n         this.parent.emit('switch', {prev: prev, curr: this});\n         }*/\n\n        return true;\n    }\n\n    // nothing was done\n    return true;\n};\n\n\n/**\n * Make the page hidden and notify subscribers.\n *\n * @return {boolean} operation status\n *\n * @fires module:stb/ui/page.item~Page#hide\n */\nPage.prototype.hide = function () {\n    // if ( DEVELOP ) {\n    //     if ( !this.parent ) {\n    //         throw new Error(__filename + ': no parent for page item');\n    //     }\n    //     // if ( this.parent.constructor.name !== 'PageList' ) {\n    //     //     throw new Error(__filename + ': wrong parent for page item');\n    //     // }\n    //     if ( this.parent.currentPage && !(this.parent.currentPage instanceof Page) ) {\n    //         throw new Error(__filename + ': wrong current page item type');\n    //     }\n    // }\n\n    if ( Component.prototype.hide.call(this) ) {\n        visiblePage = null;\n\n        return true;\n    }\n\n    // nothing was done\n    return true;\n};\n\n\n// public\nmodule.exports = Page;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// /home/dp/Projects/sdk/spasdk/component-page/index.js\n// module id = 13\n// module chunks = 0","/**\n * List of note templates\n * @license The MIT License (MIT)\n * @copyright Stanislav Kalashnik <darkpark.main@gmail.com>\n */\n\n'use strict';\n\nvar dom = require('spa-dom'),\n    Component = require('spa-component'),\n    Button = require('spa-component-button');\n    //TagManager = require('./models/tag-manager');\n\n\nfunction NoteSearch ( config ) {\n    var self = this,\n        user = config.model,\n        buttons;\n\n    // parent constructor call\n    Component.call(this, config);\n\n    buttons = {\n        create: new Button({\n            value: 'Create',\n            events: {\n                click: function () {\n                    self.emit('create');\n                }\n            }\n        })\n    };\n\n\n    /*this.$node.appendChild(\n        this.$title = dom.tag('div', {className: this.name + '__title'}, 'NoteSearch')\n    );\n\n    this.$node.appendChild(\n        this.$items = dom.tag('div', {className: this.name + '__items'})\n    );*/\n\n    //this.fill(config.data);\n\n    this.$node.appendChild(dom.fragment(\n        //buttons.create.$node,\n        this.$input = dom.tag('input', {className: this.name + '__input', autofocus: true, value: '-icq site :month'})\n    ));\n\n    this.$input.addEventListener('keydown', function ( event ) {\n        if ( event.keyCode === 13 ) {\n            self.emit('search', user.tags.strParse(self.$input.value));\n        }\n    });\n}\n\n\n// inheritance\nNoteSearch.prototype = Object.create(Component.prototype);\nNoteSearch.prototype.constructor = NoteSearch;\n\n// set component name\nNoteSearch.prototype.name = 'note-search';\n\n\n// public\nmodule.exports = NoteSearch;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/js/note-search.js\n// module id = 14\n// module chunks = 0","/**\n * List of note templates\n * @license The MIT License (MIT)\n * @copyright Stanislav Kalashnik <darkpark.main@gmail.com>\n */\n\n'use strict';\n\nvar //crypto = require('./crypto'),\n    tag = require('spa-dom').tag,\n    List = require('spa-component-list');\n    //Component = require('spa-component'),\n    //TagManager = require('./models/tag-manager');\n\n\nfunction NoteList ( config ) {\n    config.modifiers = ['note-list'];\n\n    // parent constructor call\n    List.call(this, config);\n\n    this.user = config.model;\n\n    // this.$title = this.$node.appendChild(\n    //     tag('div', {className: this.name + '__title'}, 'NoteList')\n    // );\n    //\n    // this.$items = this.$node.appendChild(\n    //     tag('div', {className: this.name + '__items'})\n    // );\n}\n\n\n// inheritance\nNoteList.prototype = Object.create(List.prototype);\nNoteList.prototype.constructor = NoteList;\n\n// set component name\n//NoteList.prototype.name = 'note-list';\n\n\nNoteList.prototype.render = function ( $item, note ) {\n    var self     = this,\n        $check   = tag('img', {className: self.name + '__check', src: 'https://image.flaticon.com/icons/svg/25/25235.svg'}),\n        $icon    = tag('img', {className: self.name + '__icon', src: 'https://image.flaticon.com/icons/svg/137/137132.svg'}),\n        $entries = tag('div', {className: this.name + '__entries'}),\n        $tags    = tag('div', {className: this.name + '__tags'}),\n        $body    = tag('div', {className: self.name + '__body'}, $entries, $tags),\n        firstUrl, $firstUrlImage;\n\n    //console.log('note', note);\n\n    // iterate all note entries\n    note.entries.forEach(function ( entry ) {\n        var plain = {\n                name: self.user.crypto.decrypt(entry.name),\n                data: self.user.crypto.decrypt(entry.data)\n            },\n            $entryData;\n\n        // store for viewer/editor\n        entry.plain = plain;\n\n        // there is data and it's not a password\n        if ( entry.id_type !== 4 && plain.name && plain.data ) {\n            // url\n            if ( entry.id_type === 2 ) {\n                $entryData = tag('a', {target: '_blank', href: plain.data}, plain.data);\n\n                // store the first available url for icon\n                if ( !firstUrl ) {\n                    firstUrl = plain.data;\n                }\n            }\n\n            // email\n            if ( entry.id_type === 5 ) {\n                $entryData = tag('a', {href: 'mailto:' + plain.data}, plain.data);\n            }\n\n            $entries.appendChild(tag('div', {className: self.name + '__entry'},\n                tag('div', {className: self.name + '__name'}, plain.name + ':'),\n                tag('div', {className: self.name + '__data'}, $entryData ? $entryData : plain.data)\n            ));\n        }\n    });\n\n    // has valid url (the first one)\n    if ( firstUrl ) {\n        //console.log('firstUrl raw', firstUrl);\n        // get rid of all unnecessary parts\n        firstUrl = firstUrl.split('/');\n        // schema can be missing\n        firstUrl = firstUrl.length === 1 ? firstUrl[0] : firstUrl[2];\n        //console.log('firstUrl', firstUrl);\n\n        // try to get favicon\n        $firstUrlImage = new Image();\n        $firstUrlImage.src = 'https://favicons.githubusercontent.com/' + firstUrl;\n        $firstUrlImage.onload = function () {\n            //$item.style.backgroundImage = 'url(' + $firstUrlImage.src + ')';\n            $icon.src = $firstUrlImage.src;\n        };\n    }\n\n    this.user.tags.ids2names(note.tags).forEach(function ( tag ) {\n        var $tag = document.createElement('div');\n\n        $tag.className = self.name + '__tag';\n        $tag.textContent = tag;\n\n        $tags.appendChild($tag);\n    });\n\n    // use template for a new note creation\n    $item.addEventListener('click', function () {\n        //self.emit('create', note);\n    });\n\n    $check.addEventListener('click', function () {\n        $check.src = 'https://image.flaticon.com/icons/svg/25/25643.svg';\n    });\n\n    $item.appendChild($check);\n    $item.appendChild($icon);\n    $item.appendChild($body);\n    // $item.appendChild($entries);\n    // $item.appendChild($tags);\n};\n\n\n/*NoteList.prototype.fill = function ( data ) {\n    var self = this,\n        $fragment = document.createDocumentFragment();\n\n    // clear items\n    while ( this.$items.lastChild ) {\n        this.$items.removeChild(this.$items.lastChild);\n    }\n\n    // iterate all templates\n    data.notes.forEach(function ( note ) {\n        var $entries = tag('div', {className: self.name + '__item-entries'}),\n            $tags    = tag('div', {className: self.name + '__item-tags'}),\n            $item    = tag('div', {className: self.name + '__item'}, $entries, $tags),\n            firstUrl, $firstUrlImage;\n\n        console.log('note', note);\n\n        // iterate all note entries\n        note.entries.forEach(function ( entry ) {\n            var entryName = crypto.decrypt(entry.name),\n                entryData = crypto.decrypt(entry.data),\n                $entryData;\n\n            // there is data and it's not a password\n            if ( entry.id_type !== 4 && entryName && entryData ) {\n                // url\n                if ( entry.id_type === 2 ) {\n                    $entryData = tag('a', {target: '_blank', href: entryData}, entryData);\n\n                    // store the first available url for icon\n                    if ( !firstUrl ) {\n                        firstUrl = entryData;\n                    }\n                }\n\n                // email\n                if ( entry.id_type === 5 ) {\n                    $entryData = tag('a', {href: 'mailto:' + entryData}, entryData);\n                }\n\n                $entries.appendChild(tag('div', {className: self.name + '__item-entry'},\n                    tag('div', {className: self.name + '__item-name'}, entryName + ':'),\n                    tag('div', {className: self.name + '__item-data'}, $entryData ? $entryData : entryData)\n                ));\n            }\n        });\n\n        // has valid url (the first one)\n        if ( firstUrl ) {\n            console.log('firstUrl raw', firstUrl);\n            // get rid of all unnecessary parts\n            firstUrl = firstUrl.split('/');\n            // schema can be missing\n            firstUrl = firstUrl.length === 1 ? firstUrl[0] : firstUrl[2];\n            console.log('firstUrl', firstUrl);\n\n            // try to get favicon\n            $firstUrlImage = new Image();\n            $firstUrlImage.src = 'https://favicons.githubusercontent.com/' + firstUrl;\n            $firstUrlImage.onload = function () {\n                $item.style.backgroundImage = 'url(' + $firstUrlImage.src + ')';\n            };\n        }\n\n        TagManager.ids2names(note.tags).forEach(function ( tag ) {\n            var $tag = document.createElement('div');\n\n            $tag.className = self.name + '__item-tag';\n            $tag.textContent = tag;\n\n            $tags.appendChild($tag);\n        });\n\n        // use template for a new note creation\n        $item.addEventListener('click', function () {\n            self.hide();\n            self.emit('create', note);\n        });\n\n        $fragment.appendChild($item);\n    });\n\n    this.$items.appendChild($fragment);\n};*/\n\n\n// public\nmodule.exports = NoteList;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/js/note-list.js\n// module id = 15\n// module chunks = 0","/**\n * @license The MIT License (MIT)\n * @copyright Stanislav Kalashnik <darkpark.main@gmail.com>\n */\n\n'use strict';\n\nvar Component = require('spa-component');\n\n\n/**\n *\n * @constructor\n * @extends Component\n *\n * @param {Object} [config={}] init parameters (all inherited from the parent)\n */\nfunction List ( config ) {\n    var self = this;\n\n    console.assert(typeof this === 'object', 'must be constructed via new');\n    console.assert(typeof config === 'object', 'wrong config type');\n    console.assert(Array.isArray(config.data), 'wrong config.data type');\n\n    // parent constructor call\n    Component.call(this, config);\n\n    /**\n     * Link to the currently focused DOM element.\n     *\n     * @type {Element}\n     */\n    this.$focusItem = null;\n\n    config.render && (this.render = config.render);\n\n    // component setup\n    // todo: remove init?\n    this.init(config);\n\n    this.addListener('click', function ( event ) {\n        var $target = event.target;\n\n        //console.log(event);\n        // @todo: remove event.path - not supported in Firefox\n        // there can be children in list item\n        // so need to travers through propagation chain\n        var $item = event.path.find(function ( element ) {\n            //console.log('===', element.parentNode, self.$node);\n            return element.parentNode === self.$node;\n        });\n\n        /*while ( $target.parentNode === self.$node ) {\n            $target = $target.parentNode;\n        }*/\n\n        //console.log('click in constructor');\n\n        // notify listeners\n        self.events['click:item'] && self.emit('click:item', self.data[$item.index], event);\n\n        //console.log(event);\n\n        if ( !event.defaultPrevented ) {\n            //console.log('$item', $item);\n\n            if ( $item ) {\n                self.focusItem($item);\n            }\n\n            // if ( self.$focusItem ) {\n            //     self.$focusItem.className = self.CLASS_ITEM;\n            // }\n            //\n            // event.target.className = self.CLASS_ITEM_FOCUSED;\n            // self.$focusItem = event.target;\n            //\n            // // there are some listeners\n            // if ( self.events['focus:item'] ) {\n            //     // notify listeners\n            //     self.emit('focus:item', data[event.target.index], event);\n            // }\n        }\n    });\n}\n\n\n// inheritance\nList.prototype = Object.create(Component.prototype);\nList.prototype.constructor = List;\n\n// set component name\nList.prototype.name = 'list';\n\n// base classes\nList.prototype.CLASS_NODE         = 'list';\nList.prototype.CLASS_ITEM         = List.prototype.CLASS_NODE + '__item';\nList.prototype.CLASS_ITEM_FOCUSED = List.prototype.CLASS_ITEM + ' ' + List.prototype.CLASS_ITEM + '--focused';\n\n\n/**\n * Method to build each list item content.\n *\n * @param {Element} $item item DOM link\n * @param {*} data associated with this item data\n */\nList.prototype.render = function ( $item, data ) {\n    $item.textContent = data;\n};\n\n\n/**\n * Init or re-init of the component inner structures and HTML.\n *\n * @param {Object} config init parameters (subset of constructor config params)\n */\nList.prototype.init = function ( config ) {\n    var $fragment = document.createDocumentFragment(),\n        $node     = this.$node,\n        data      = config.data,\n        itemClass = this.name + '__item',\n        self      = this;\n\n    this.data = data;\n\n    // clear container\n    while ( $node.lastChild ) {\n        $node.removeChild($node.lastChild);\n    }\n\n    // create items\n    data.forEach(function ( value, index ) {\n        var $item = document.createElement('div');\n\n        $item.index = index;\n        $item.className = itemClass;\n        self.render($item, value);\n\n        $fragment.appendChild($item);\n    });\n\n    $node.appendChild($fragment);\n\n\n\n    // this.addListener('focus', function ( event ) {\n    //\n    // });\n\n    // $node.addEventListener('click', function ( event ) {\n    //     if ( self.$focusItem ) {\n    //         self.$focusItem.className = self.CLASS_ITEM;\n    //     }\n\t//\n    //     event.target.className = self.CLASS_ITEM_FOCUSED;\n\t//\n    //     self.$focusItem = event.target;\n\t//\n    //     // there are some listeners\n    //     if ( self.events['click'] ) {\n    //         // notify listeners\n    //         self.emit('click', data[event.target.index], event);\n    //     }\n\t//\n    //     event.stopPropagation();\n    // });\n};\n\n\nList.prototype.focusItem = function ( $target ) {\n    var result    = false,\n        itemClass = this.name + '__item--focused';\n\n    // something has changed\n    if ( $target !== this.$focusItem ) {\n        // process the previous focused element\n        if ( this.$focusItem ) {\n            //this.$focusItem.className = this.CLASS_ITEM;\n            this.$focusItem.classList.remove(itemClass);\n        }\n\n        // apply\n        //$target.className = this.CLASS_ITEM_FOCUSED;\n        $target.classList.add(itemClass);\n        this.$focusItem = $target;\n\n        // notify listeners\n        this.events['focus:item'] && this.emit('focus:item', this.data[$target.index]);\n\n        // ok\n        result = true;\n    }\n\n    // status\n    return result;\n};\n\n\n// public\nmodule.exports = List;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// /home/dp/Projects/sdk/spasdk/component-list/index.js\n// module id = 16\n// module chunks = 0","/**\n * @license The MIT License (MIT)\n * @copyright Stanislav Kalashnik <darkpark.main@gmail.com>\n */\n\n'use strict';\n\nvar list = [\n    {\n        name: 'note',\n        description: 'simple note with title and text',\n        entries: [\n            {id: 1, name: 'title'},\n            {id: 6, name: 'description'}\n        ]\n    },\n    {\n        name: 'site',\n        description: 'regular site bookmark',\n        entries: [\n            {id: 2, name: 'site url'},\n            {id: 5, name: 'email'},\n            {id: 4, name: 'password'},\n            {id: 6, name: 'comments'}\n        ]\n    },\n    {\n        name: 'email',\n        description: 'email address record',\n        entries: [\n            {id: 2, name: 'site url'},\n            {id: 5, name: 'email'},\n            {id: 4, name: 'password'},\n            {id: 6, name: 'comments'}\n        ]\n    },\n    {\n        name: 'messenger',\n        description: 'instant messenger account information',\n        entries: [\n            {id: 2, name: 'site url'},\n            {id: 5, name: 'email'},\n            {id: 3, name: 'username'},\n            {id: 4, name: 'password'},\n            {id: 1, name: 'phone'},\n            {id: 6, name: 'comments'}\n        ]\n    },\n    {\n        name: 'ftp',\n        description: 'ftp server data',\n        entries: [\n            {id: 2, name: 'server address'},\n            {id: 3, name: 'username'},\n            {id: 4, name: 'password'},\n            {id: 6, name: 'comments'}\n        ]\n    },\n    {\n        name: 'ssh',\n        description: 'ssh server data',\n        entries: [\n            {id: 2, name: 'server address'},\n            {id: 3, name: 'username'},\n            {id: 4, name: 'password'},\n            {id: 6, name: 'comments'}\n        ]\n    },\n    {\n        name: 'database',\n        description: 'database access parameters',\n        entries: [\n            {id: 2, name: 'server address'},\n            {id: 1, name: 'database name'},\n            {id: 3, name: 'username'},\n            {id: 4, name: 'password'},\n            {id: 6, name: 'comments'}\n        ]\n    }\n];\n\n\n// public\nmodule.exports = list;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/js/data.templates.js\n// module id = 17\n// module chunks = 0","/**\n * @license The MIT License (MIT)\n * @copyright Stanislav Kalashnik <darkpark.main@gmail.com>\n */\n\n'use strict';\n\nvar app = require('./app'),\n    api = require('./api'),\n    //NoteFilter = require('./app.note.filter'),\n    //NoteEditor = require('./app.note.editor'),\n    TagManager = require('./models/tag-manager');\n\n\n/**\n * Module to work with note list\n * view all, selecting, checking, appending, filtering\n */\nvar NoteList = new function () {\n    // for limited scopes\n    var self = this;\n\n    // component state flag\n    // true  - everything is decoded\n    // false - no plain data, everything is encrypted\n    this.open = false;\n\n    var hint_tag_include = 'click on this tag to include it to the search';\n    var hint_tag_exclude = 'click on this tag to exclude it from the search';\n    var hint_info_missing = 'there is no data';\n    var hint_tags_missing = 'there are no tags';\n    var hint_notes_visible = 'the limited amount of visible notes received according the search options (usually the first 20)';\n    var hint_notes_total = 'the general amount of notes satisfying the giving search options';\n    var hint_notes_filtered = 'the amount of notes excluded from the note list due to the search filter';\n\n    var msg_checked_notes_remove = 'You are going to delete all checked notes in the note list. Do you really want to continue?';\n    var msg_checked_notes_restore = 'You are going to restore all checked notes in the note list. Do you really want to continue?';\n\n    var msg_checked_notes_removed = 'The selected notes were successfully removed ';\n    var msg_checked_notes_restored = 'The selected notes were successfully restored ';\n\n    /**\n     * Open the subscriber\n     * master password is accessible\n     * decrypt all the data and show it\n     */\n    this.EventOpen = function () {\n        elclear(this.dom.notes);\n        // show info and controls\n        this.dom.tpbar.style.display = 'block';\n        // component state flag\n        this.open = true;\n    };\n\n    /**\n     * Close the subscriber\n     * master password is expired and cleared\n     * clear all the decrypted data\n     */\n    this.EventClose = function () {\n        // close only if opened at the moment\n        if ( this.open ) {\n            // clear decoded entries data in the requested notes\n            this.data.notes.forEach(function ( note ) {\n                // all note entries\n                note.entries.forEach(function ( entry ) {\n                    // remove if exist\n                    delete entry.name_dec;\n                    delete entry.data_dec;\n                });\n                // all data for filtering\n                delete note.fulltext;\n            });\n            // hide info and controls\n            this.dom.tpbar.style.display = 'none';\n            // clear notes\n            elclear(this.dom.notes);\n            // component state flag\n            this.open = false;\n        }\n    };\n\n    /**\n     * Deletes or restores the given list of notes depending on the undo flag\n     * @param list array of note ids\n     * @param undo bool flag: true - restore notes, delete otherwise\n     */\n    var NotesDelete = function ( list, undo ) {\n        // check input\n        if ( list.length > 0 ) {\n            // send request\n            api.post('note/delete' + (undo ? '/undo' : ''), {ids: list}, function ( error, data ) {\n                if ( error ) {\n                    console.error(error);\n                }\n\n                console.log('note delete', data);\n\n                // remove old messages\n                NoteFilter.MsgClear();\n                // on success\n                if ( !data.error ) {\n                    // prepare message body\n                    var message = [(undo ? msg_checked_notes_restored : msg_checked_notes_removed) + '(amount:' + data.count + '). '];\n                    // after deletion allow to go to the deleted notes\n                    if ( !undo ) message.push(' It is still possible to ', element('a', {className: 'bold'}, 'restore them', {\n                        onclick: function () {\n                            NoteFilter.RequestDeleted();\n                        }\n                    }));\n                    // close currently edited note if affected\n                    if ( list.includes(NoteEditor.GetNoteID()) ) NoteEditor.Escape();\n                    // show status message\n                    NoteFilter.MsgAdd(message);\n                    // refresh note list\n                    NoteFilter.NotesRequest();\n                } else {\n                    NoteFilter.MsgAdd('The request was not successful. The response from the server: ' + data.error, 'error');\n                }\n            });\n        }\n    };\n\n    /**\n     * Makes a visualization of the given note entries details\n     * @param note array note attributes\n     * @param icon img node for note icon\n     * @return array of html nodes or hint string\n     */\n    var BuildNoteInfo = function ( note, icon ) {\n        var list = [], fulltext = [], url = null;\n\n        // iterate all note entries\n        note.entries.forEach(function ( entry ) {\n            // decrypt data\n            var name = crypto.decrypt(entry.name);\n            var data = crypto.decrypt(entry.data);\n\n            // prepare fulltext data\n            fulltext.push(name.toLowerCase());\n            fulltext.push(data.toLowerCase());\n            // there is data and it's not a password\n            if ( entry.id_type !== 4 && data ) {\n                // truncate\n                var sname = name.length > 30 ? name.slice(0, 25) + '...' : name;\n                var sdata = data.length > 50 ? data.slice(0, 35) + '...' : data;\n                // url\n                if ( entry.id_type === 2 ) {\n                    // http/https/ftp and have point\n                    if ( (data.search('http://') >= 0 || data.search('https://') >= 0 || data.search('ftp://') >= 0) && data.search('.') >= 0 ) {\n                        sdata = element('a', {target: '_blank', href: data}, sdata);\n                        // the first available url\n                        if ( !url ) url = data;\n                    } else {\n                        // just server name\n                        sdata = element('b', {}, sdata);\n                    }\n                }\n                list.push(element('span', {className: 'name'}, sname + ':'));\n                list.push(element('span', {className: 'data'}, sdata));\n            }\n        });\n\n        // has valid url (the first one)\n        if ( url ) {\n            // get rid of all unnecessary parts\n            url = url.split('/');\n            // parts are valid\n            if ( url[2] && url[2] !== 'localhost' ) {\n                // try to get image, won't repclace the current one if no icon found\n                // https://www.google.com/s2/favicons?domain=google.com gives only 16px images\n                element('img', {className: 'icon', src: 'https://favicons.githubusercontent.com/' + url[2]}, null, {\n                    onload: function () {\n                        // icon loaded so get current icon parent\n                        var parent = icon.parentNode;\n                        // and replace the current one\n                        parent.removeChild(icon);\n                        // with new\n                        elchild(parent, this);\n                        //self.dom.entries.insertBefore(entry, entry.previousSibling);\n                    }\n                });\n            }\n        }\n\n        // build search full text data\n        note.fulltext = fulltext.join('\\n');\n        // warning if no data\n        return list.length > 0 ? list : element('div', {className: 'warn'}, hint_info_missing);\n    }\n\n    /**\n     * Tag button click handler\n     * include, exclude and subtract\n     */\n    var TagClickHandler = function ( event ) {\n        // ctrl holding\n        if ( event.ctrlKey ) {\n            NoteFilter.TagSubtract(this.tagnm);\n        } else {\n            if ( this.finc ) {\n                // available for selection\n                NoteFilter.TagInclude(this.tagnm);\n            } else {\n                // already selected\n                NoteFilter.TagExclude(this.tagnm);\n            }\n        }\n        // prevent bubbling\n        return false;\n    };\n\n    /**\n     * Makes a list of note tags buttons with handlers\n     * @param note array note attributes\n     * @return array of html tag nodes or hint string\n     */\n    var BuildNoteTags = function ( note ) {\n        var list = [], exc = [], inc = [];\n        // there is some data\n        if ( note.tags.length > 0 ) {\n            // separate tags\n            note.tags.forEach(function ( item ) {\n                if ( NoteFilter.data.tinc.includes(item) ) {\n                    inc.push(TagManager.dataTagsIdlist[item]);\n                } else {\n                    exc.push(TagManager.dataTagsIdlist[item]);\n                }\n            });\n            // forms the list of tags already selected\n            inc.sort().forEach(function ( item ) {\n                // create html wrapper for tag\n                item = element('span', {className: 'tag include', tagnm: item, title: hint_tag_exclude}, item);\n                // mouse click handler\n                //$(item).bind('click', TagClickHandler);\n                item.addEventListener('click', TagClickHandler);\n                list.push(item);\n            });\n            // forms the list of tags available for selection\n            exc.sort().forEach(function ( item ) {\n                // create html wrapper for tag\n                item = element('span', {className: 'tag', finc: true, tagnm: item, title: hint_tag_include}, item);\n                // mouse click handler\n                //$(item).bind('click', TagClickHandler);\n                item.addEventListener('click', TagClickHandler);\n                list.push(item);\n            });\n        }\n        // list of tags or missing hint\n        return list.length > 0 ? list : hint_tags_missing;\n    }\n\n    /**\n     * Returns the corresponding note icon image address\n     * @param note array note attributes\n     * @return url string\n     */\n    var GetNoteIcon = function ( note ) {\n        // prepare\n        var //icon = 'img/tag_note.png',\n            icon = 'img/tags/note.svg',\n            tags = TagManager.ids2names(note.tags);\n        // iterate words in the tag list\n        tags.forEach(function ( item ) {\n            // it's a tag from the global set\n            if ( window.iconTags.includes(item) ) {\n                // get the first match\n                //icon = 'img/tag_' + item + '.png';\n                icon = 'img/tags/' + item + '.svg';\n\n                return;\n            }\n        });\n        return icon;\n    }\n\n    /**\n     * Shows/hides checked notes controls and general notes info\n     * @param ctrlonly flag to skip or not the control buttons\n     */\n    this.UpdateCtrlBlock = function ( ctrlonly ) {\n        //var total = self.dom.notes.childNodes.length;\n        if ( !ctrlonly ) {\n            // list of visible notes\n            var visible = this.GetNotesVisible();\n            // clear and fill\n            elchild(elclear(self.dom.tpinfo), [\n                // block with amount\n                element('span', {className: 'amount'}, [\n                    // title\n                    element('p', {}, 'notes '),\n                    // amount of visible notes\n                    element('b', {title: hint_notes_visible}, visible.length), ' of ', element('span', {title: hint_notes_total}, this.data.total),\n                    // total amount of notes\n                    (visible.length < this.data.notes.length ? [element('p', {className: 'div'}, '|'), element('b', {title: hint_notes_filtered}, this.data.notes.length - visible.length), ' filtered'] : null),\n                    // link to load all available notes\n                    (this.data.notes.length < this.data.total ? [element('p', {className: 'div'}, '|'), element('a', {}, 'load all', {\n                        onclick: function () {\n                            NoteFilter.NotesRequest(true);\n                        }\n                    })] : null)\n                ]),\n                // block with selection\n                element('span', {}, [\n                    // title\n                    element('p', {}, 'select '),\n                    // link to select all notes\n                    element('a', {}, 'all', {\n                        onclick: function () {\n                            self.SetNotesState(visible, 'marked', true);\n                            self.UpdateCtrlBlock(true);\n                        }\n                    }),\n                    element('p', {className: 'div'}, '|'),\n                    // link to remove selection from all notes\n                    element('a', {}, 'none', {\n                        onclick: function () {\n                            self.SetNotesState(visible, 'marked', false);\n                            self.UpdateCtrlBlock(true);\n                        }\n                    }),\n                    element('p', {className: 'div'}, '|'),\n                    // link to invert selection\n                    element('a', {}, 'invert', {\n                        onclick: function () {\n                            self.SetNotesState(visible, 'marked');\n                            self.UpdateCtrlBlock(true);\n                        }\n                    })\n                ])\n            ]);\n        }\n        // get the list of checked notes\n        var checked = this.GetNotesByState('marked');\n        // hide all buttons\n        this.dom.btndelete.style.display = 'none';\n        this.dom.btnrestore.style.display = 'none';\n        // show only the corresponding one\n        if ( checked.length > 0 ) (NoteFilter.data.wcmd.includes('deleted') ? this.dom.btnrestore : this.dom.btndelete).style.display = 'block';\n        // show/hide block depending on notes amount\n        this.dom.tpbar.style.display = this.data.total === 0 ? 'none' : 'block';\n    }\n\n    /**\n     * Set the default note state, removes additional classes and resets the state flags\n     * @param notes if given than it's the only note list to be reset\n     */\n    this.ClearNotesState = function ( notes ) {\n        // all notes or the given one/ones\n        var i, list = notes || self.dom.notes.childNodes;\n        // iterate formed list\n        for ( i = 0; i < list.length; i++ ) {\n            // reset class\n            list[i].className = 'note';\n            // reset state flags\n            list[i].state.active = list[i].state.marked = false;\n        }\n    }\n\n    /**\n     * Sets the flag and clall to the given note/notes\n     * @param notes to be processed\n     * @param type string name active | marked\n     * @param state optional bool flag, if set true - set, false - unset\n     */\n    this.SetNotesState = function ( notes, type, state ) {\n        // check input\n        if ( notes.length > 0 ) {\n            notes.forEach(function ( note ) {\n                // determine the state to switch to\n                note.state[type] = state !== undefined ? state : (note.state[type] ? false : true);\n                // invert class\n                //$(note).toggleClass(type, note.state[type]);\n                note.classList.toggle(type, note.state[type]);\n            });\n        }\n    };\n\n    /**\n     * Returns the list of notes with the given state\n     * @param type string state name active | marked\n     * @return array of nodes\n     */\n    this.GetNotesByState = function ( type ) {\n        // all notes or only the given one\n        var i, result = [], list = self.dom.notes.childNodes;\n        // iterate formed list\n        for ( i = 0; i < list.length; i++ ) {\n            if ( list[i].state[type] === true ) result.push(list[i]);\n        }\n        return result;\n    }\n\n    /**\n     * Returns the html note block by id if found or false otherwise\n     * @param id int note attribute\n     * @return node with data or false on failure\n     */\n    this.GetNoteByID = function ( id ) {\n        // iterate note list\n        for ( var i = 0, list = this.dom.notes.childNodes; i < list.length; i++ ) {\n            // return if matched\n            if ( list[i].data.id === id ) return list[i];\n        }\n        return false;\n    };\n\n    /**\n     * Returns the list of visible notes\n     * @return array of nodes\n     */\n    this.GetNotesVisible = function () {\n        // iterate note list\n        for ( var i = 0, result = [], list = this.dom.notes.childNodes; i < list.length; i++ ) {\n            // fill the visible notes list\n            if ( !list[i].style.display ) result.push(list[i]);\n        }\n        return result;\n    };\n\n    /**\n     * Whole note click handler\n     * highlights the active note or note range\n     * holding Ctrl checks/unchecks the selected notes\n     * holding Shift selects all the notes between old and new selected notes\n     * @param event event object\n     */\n    var NoteClickHandler = function ( event ) {\n        // holding Ctrl key\n        if ( event.ctrlKey ) {\n            self.SetNotesState([this], 'marked');\n            // simple mouse click\n        } else {\n            // currently active note list\n            var alast = self.GetNotesByState('active');\n            // flag true if the clicked note is the same as already active\n            var fsame = alast.length > 0 && alast[0].data.id === this.data.id;\n            // check current note modifications\n            var has_changes = NoteEditor.HasChanges();\n            // not changed or user confirmed his wish\n            if ( !has_changes || fsame || (has_changes && NoteEditor.ConfirmExit()) ) {\n                // reset all notes states\n                self.ClearNotesState();\n                // check if the edited note is not already active\n                if ( NoteEditor.GetNoteID() !== this.data.id ) {\n                    console.log('NoteEditor.Load', this.data);\n                    // show note details\n                    NoteEditor.Load(this.data);\n                }\n                // make active\n                self.SetNotesState([this], 'active');\n                // holding Shift key\n                if ( event.shiftKey ) {\n                    var i, item, cflag = false;\n                    // iterate all notes\n                    for ( i = 0; i < self.dom.notes.childNodes.length; i++ ) {\n                        // cursor\n                        item = self.dom.notes.childNodes[i];\n                        // flag showing that the cursor is inside the range\n                        if ( item.data.id === alast[0].data.id || item.data.id === this.data.id ) cflag = !cflag;\n                        // check inside the range or edge items\n                        if ( cflag || item.data.id === alast[0].data.id || item.data.id === this.data.id ) {\n                            self.SetNotesState([item], 'marked');\n                        }\n                    }\n                } else {\n                    // check the only clicked note\n                    self.SetNotesState([this], 'marked');\n                }\n            }\n        }\n        // show/hide checked notes controls\n        self.UpdateCtrlBlock();\n        // prevent bubbling\n        //return false;\n    }\n\n    /**\n     * Note checkbox ckick handler\n     */\n    var NoteTickClickHandler = function () {\n        // check/uncheck\n        self.SetNotesState([this.note], 'marked');\n        // show/hide checked notes controls\n        self.UpdateCtrlBlock();\n        // prevent bubbling\n        return false;\n    }\n\n    /**\n     * Forms the note wrapper\n     * @param data array of note parameters\n     * @return formed node with data\n     */\n    this.BuildNote = function ( data ) {\n        // note body\n        var note = element('div', {className: 'note', data: data, dom: {}, state: {}});\n        // note content\n        elchild(note, [\n            element('div', {className: 'icon'}, [\n                note.dom.icon = element('img', {className: 'icon', src: GetNoteIcon(data)}),\n                //note.dom.icon = BuildNoteIcon(data),\n                note.dom.tick = element('div', {className: 'tick', note: note})\n            ]),\n            element('div', {className: 'body'}, [\n                note.dom.info = element('div', {className: 'info'}, BuildNoteInfo(data, note.dom.icon)),\n                //note.dom.time = element('div', {className: 'time'}, TimestampToDateStr(data.mtime)),\n                note.dom.tags = element('div', {className: 'tags'}, BuildNoteTags(data))\n            ])\n        ]);\n        // whole note ckick\n        //$(note).bind('click', NoteClickHandler);\n        note.addEventListener('click', NoteClickHandler);\n        // checkbox click\n        //$(note.dom.tick).bind('click', NoteTickClickHandler);\n        note.dom.tick.addEventListener('click', NoteTickClickHandler);\n        // note html body\n        return note;\n    };\n\n    /**\n     * Shows/hides notes according to the filter\n     * @param notes array of notes that should be processed, all if not given\n     */\n    this.SetNotesVisibility = function ( notes ) {\n        // all notes or the given one/ones\n        notes = notes || this.dom.notes.childNodes;\n        var i, visible,  // flag for visibility\n            hlist = [];  // list of the notes that should be hidden\n        // iterate formed list\n        for ( i = 0; i < notes.length; i++ ) {\n            // by default is visible\n            visible = true;\n            // check by tags\n            //TODO:???\n            // check by filter string if still visible\n            if ( visible ) {\n                // check included words\n                NoteFilter.data.winc.forEach(function ( word ) {\n                    // not found in fulltext so exit\n                    if ( notes[i].data.fulltext.indexOf(word.toLowerCase()) < 0 ) {\n                        visible = false;\n                        return;\n                    }\n                });\n                // still visible\n                if ( visible ) {\n                    // check excluded words\n                    NoteFilter.data.wexc.forEach(function ( word ) {\n                        // found in fulltext so exit\n                        if ( notes[i].data.fulltext.indexOf(word.toLowerCase()) >= 0 ) {\n                            visible = false;\n                            return;\n                        }\n                    });\n                }\n            }\n            // apply visibility flag\n            notes[i].style.display = visible ? '' : 'none';\n            // fill the list of notes to be hidden\n            if ( !visible ) hlist.push(notes[i]);\n        }\n        // clear inner state for hidden notes\n        this.ClearNotesState(hlist);\n        this.UpdateCtrlBlock();\n    }\n\n    /**\n     * Fills the note list with generated notes\n     * @param notes array of notes or false if gloabal latest list should be used\n     * @param total int general amount of notes\n     */\n    this.BuildTable = function ( notes, total ) {\n        // check input\n        notes = notes instanceof Array ? notes : [];\n        // set global data\n        this.data.notes = notes;\n        this.data.total = total;\n        // clearing the container\n        elclear(this.dom.notes);\n        // there are some notes\n        if ( total > 0 ) {\n            // determine the note id beeing edited at the moment\n            var note, neid = NoteEditor.GetNoteID();\n            // iterate all notes\n            notes.forEach(function ( item ) {\n                // append the created note to the list\n                note = self.BuildNote(item);\n                self.SetNotesVisibility([note]);\n                elchild(self.dom.notes, note);\n                // highlight the edited at the moment note\n                if ( neid === item.id ) {\n                    self.SetNotesState([note], 'active');\n                }\n            });\n        }\n        // show/hide control panel\n        this.UpdateCtrlBlock();\n    };\n\n    /**\n     * Deletes or restore selected notes depending on undo flag\n     */\n    var BtnDeleteHandler = function () {\n        // ask user\n        if ( confirm(this.undo ? msg_checked_notes_restore : msg_checked_notes_remove) ) {\n            var list = [];\n            // iterate all checked notes\n            self.GetNotesByState('marked').forEach(function ( note ) {\n                // fill id list\n                if ( note.data.id ) list.push(note.data.id);\n            });\n            // send request\n            NotesDelete(list, this.undo);\n        }\n    }\n\n    /**\n     * Main init method\n     * @param params list of configuration parameters\n     */\n    this.Init = function ( params ) {\n        // check input\n        if ( !params.handle ) return;\n        // html parent object\n        this.dom = {handle: params.handle};\n\n        this.data = {\n            total: 0,  // total amount on notes\n            notes: []  // all requested notes data array\n        };\n\n        // build all blocks together\n        elchild(this.dom.handle, [\n            // top panel\n            this.dom.tpbar = element('div', {className: 'tpbar'}, [\n                // controls\n                this.dom.tpctrl = element('div', {className: 'ctrl'}, [\n                    this.dom.btndelete = element('input', {\n                        type: 'button',\n                        value: 'Delete',\n                        undo: false,\n                        className: 'button hidden'\n                    }, null, {onclick: BtnDeleteHandler}),\n                    this.dom.btnrestore = element('input', {\n                        type: 'button',\n                        value: 'Restore',\n                        undo: true,\n                        className: 'button hidden'\n                    }, null, {onclick: BtnDeleteHandler})\n                ]),\n                // general info, load all, select all/none/invert\n                this.dom.tpinfo = element('div', {className: 'info'})\n            ]),\n            // note list\n            this.dom.notes = element('div', {className: 'notes'})\n            // bottom panel\n            //this.dom.btbar = element('div', {className: 'btbar'})\n        ]);\n\n        // disable selection\n        // this.dom.notes.onselectstart = function () {\n        //     return false;\n        // } // ie\n        // this.dom.notes.onmousedown = function () {\n        //     return false;\n        // } // mozilla\n    };\n};\n\n\n// public\nmodule.exports = NoteList;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/js/note.list.js\n// module id = 18\n// module chunks = 0","/**\n * Main application entry point.\n * @license The MIT License (MIT)\n * @copyright Stanislav Kalashnik <darkpark.main@gmail.com>\n */\n\n'use strict';\n\nvar app      = require('spa-app'),\n    gettext  = require('spa-gettext'),\n    api      = require('./api'),\n    //crypto   = require('./crypto'),\n    User     = require('./models/user'),\n    MainView = require('./views/main'),\n    UserView = require('./views/user');\n\n\n// setup environment\napp.language = localStorage.getItem('language') || 'en';\n\n\n// load localization\ngettext.load({name: app.language}, function () {\n    var user     = new User(),\n        mainView = new MainView({model: user}),\n        userView = new UserView({model: user});\n\n    user.init();\n    app.user = user;\n\n    user.addListeners({\n        session: function () {\n            // open page anyway\n            userView.show();\n        },\n        unlock: function ( error ) {\n            if ( !error ) {\n                // clear\n                userView.remove();\n                // navigate\n                mainView.show();\n            }\n        }\n    });\n\n    // add to DOM\n    document.body.appendChild(mainView.$node);\n    document.body.appendChild(userView.$node);\n\n    /*var pageUser = require('./pages/user');\n\n    pageUser.addListeners({\n        unlock: function ( tags ) {\n            var pageMain = require('./pages/main');\n\n            document.body.appendChild(pageMain.$node);\n            pageMain.show(tags);\n            pageUser.remove();\n        }\n    });\n\n    // add to DOM\n    document.body.appendChild(pageUser.$node);\n\n    api.get('user/info', function ( error, data ) {\n        if ( error ) {\n            console.error(error);\n        }\n\n        console.log('user info', data);\n\n        app.user = data;\n\n        if ( data ) {\n            // apply current pass hash\n            crypto.setPassHash(data.hash);\n        }\n\n        pageUser.show();\n    });/**/\n});\n\n\n\n\nfunction noop () {\n    var gettext = require('spa-gettext'),\n        app     = require('./app'),\n        sjcl    = require('./sjcl.min'),\n        //dialogs = require('./app.dialogs'),\n        //NoteFilter   = require('./app.note.filter'),\n        //NoteList     = require('./note.list'),\n        NoteSearch   = require('./note-search'),\n        NoteList     = require('./note-list'),\n        TemplateList = require('./template-list'),\n        //NoteEditor   = require('./app.note.editor'),\n        TagManager   = require('./models/tag-manager'),\n        templates    = require('./data.templates'),\n        collectTimer;\n\n\n    require('./note.filter');\n    require('./note.editor');\n    require('./tools');\n    require('./dialogs');\n\n//require('./jquery');\n//window.$ = require('jquery');\n//require('./_jquery-1.9.1.min');\n//require('./_jquery.simplemodal.1.4.4.min');\n\n    window.SignOut = function SignOut () {\n        api.post('user/logout', null, function ( error, data ) {\n            if ( error ) {\n                console.error(error);\n                return;\n            }\n\n            // true or false\n            console.log('logout', data);\n\n            location.reload();\n        });\n    };\n\n\n    window.initData = function initData ( data, callback ) {\n        var $panelRight = document.getElementById('panelRight');\n        var $panelLeft  = document.getElementById('panelLeft');\n\n        console.log('window.initData');\n\n        window.dataUser = data;\n\n        api.get('user/tags', function ( error, data ) {\n            var notes, search;\n\n            if ( error ) {\n                console.error(error);\n                callback();\n\n                return;\n            }\n\n            console.log('user tags', data);\n\n            //window.dataEntryTypes = data.entry_types;\n            //window.dataTemplates = data.templates;\n            //window.dataTemplateEntries = data.template_entries;\n\n            // compacted list of all encoded tags with links and use counters\n            //window.dataTags = data;\n            // need to correct type if empty\n            // if ( !window.dataTags.data.length ) {\n            //     window.dataTags.data = {};\n            //     window.dataTags.defn = {name:0, links:1, uses:2};\n            // }\n\n            // main components initialization\n            //NoteFilter.Init({handle: document.querySelector('div.notefilter')});\n            //NoteList.Init({handle: document.querySelector('div.notelist')});\n            //TemplateList.Init({handle: document.querySelector('div.template-list')});\n            NoteEditor.Init({handle: document.querySelector('div.noteeditor')});\n\n            // to receive password change events\n            app.subscribe(TagManager);\n            //app.subscribe(TemplateList);\n            //app.subscribe(NoteList);\n            //app.subscribe(NoteFilter);\n            app.subscribe(NoteEditor);\n\n\n            notes = new NoteList({\n                data: [],\n                events: {\n                    'click:item': function ( note ) {\n                        console.log(note);\n                        window.templateList.hide();\n                        NoteEditor.Load(note);\n                    }\n                }\n            });\n\n            $panelLeft.insertBefore(notes.$node, $panelLeft.firstChild);\n\n            search = new NoteSearch({\n                events: {\n                    search: function ( value ) {\n                        var data = {\n                            tinc: value.tinc,\n                            texc: value.texc,\n                            wcmd: value.wcmd,\n                            all: false\n                        };\n\n                        console.log(value, data);\n\n                        api.post('note/search', data, function ( error, data ) {\n                            if ( error ) {\n                                console.error(error);\n                            }\n\n                            console.log('note search', data);\n\n                            notes.init({data: data.notes});\n                        });\n                    }\n                }\n            });\n\n            $panelLeft.insertBefore(search.$node, $panelLeft.firstChild);\n\n            window.templateList = new TemplateList({\n                data: templates,\n                events: {\n                    'click:item': function ( template ) {\n                        this.hide();\n                        NoteEditor.Create(template);\n                    }\n                }\n            });\n\n            $panelRight.appendChild(window.templateList.$node);\n\n\n            // show\n            //window.pageMain.style.display = 'block';\n\n            callback();\n        });\n    };\n\n\n// contains encrypted data for export\n// if not null an export window appears\n    window.exportData = null;\n\n// list of tag names with title images\n    window.iconTags = ['email', 'ftp', 'ssh', 'icq', 'note', 'site', 'skype', 'jabber', 'msn', 'database'];\n\n    window.pageInit = document.getElementById('pageInit');\n    window.pageMain = document.getElementById('pageMain');\n\n    document.body.removeChild(window.pageInit);\n    document.body.removeChild(window.pageMain);\n\n\n    // start entropy collection\n    sjcl.random.startCollectors();\n    // check each 5 sec if has enough\n    collectTimer = setInterval(function () {\n        if ( sjcl.random.isReady() ) {\n            console.log('entropy collected');\n            // has enough\n            sjcl.random.stopCollectors();\n            // stop checking\n            clearInterval(collectTimer);\n        }\n    }, 1000);\n\n\n    api.get('user/info', function ( error, data ) {\n        if ( error ) {\n            console.error(error);\n            //return;\n        }\n\n        console.log('user info', data);\n\n        if ( data ) {\n            window.dataUser = data;\n\n            // apply current pass hash\n            app.setPassHash(data.hash);\n            // ask for a pass\n            DlgPassGet.Show({escClose: false});\n        } else {\n            //window.pageInit.style.display = 'block';\n        }\n    });\n}\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/js/main.js\n// module id = 19\n// module chunks = 0","/**\n * @license The MIT License (MIT)\n * @copyright Stanislav Kalashnik <darkpark.main@gmail.com>\n */\n\n/* eslint no-path-concat: 0 */\n\n'use strict';\n\nvar Emitter = require('cjs-emitter'),\n    //parse   = require('cjs-query').parse,\n    app     = new Emitter();\n\n\n/**\n * Make the given inactive/hidden page active/visible.\n * Pass some data to the page and trigger the corresponding event.\n *\n * @param {Page} page item to show\n * @param {*} [data] data to send to page\n *\n * @return {boolean} operation status\n */\n// function showPage ( page, data ) {\n//     // page available and can be hidden\n//     if ( page && !page.active ) {\n//         // apply visibility\n//         page.$node.classList.add('active');\n//         page.active = true;\n//         app.activePage = page;\n//\n//         debug.info('show component ' + page.name + '#' + page.id, null, {\n//             tags: ['show', 'component', page.name, page.id]\n//         });\n//         //console.log('component ' + page.name + '.' + page.id + ' show', 'green');\n//\n//         // there are some listeners\n//         if ( page.events['show'] ) {\n//             // notify listeners\n//             page.emit('show', {page: page, data: data});\n//         }\n//\n//         return true;\n//     }\n//\n//     // nothing was done\n//     return false;\n// }\n\n\n/**\n * Make the given active/visible page inactive/hidden and trigger the corresponding event.\n *\n * @param {Page} page item to hide\n *\n * @return {boolean} operation status\n */\n// function hidePage ( page ) {\n//     // page available and can be hidden\n//     if ( page && page.active ) {\n//         // apply visibility\n//         page.$node.classList.remove('active');\n//         page.active  = false;\n//         app.activePage = null;\n//\n//         debug.info('hide component ' + page.name + '#' + page.id, null, {\n//             tags: ['hide', 'component', page.name, page.id]\n//         });\n//         //console.log('component ' + page.name + '.' + page.id + ' hide', 'grey');\n//\n//         // there are some listeners\n//         if ( page.events['hide'] ) {\n//             // notify listeners\n//             page.emit('hide', {page: page});\n//         }\n//\n//         return true;\n//     }\n//\n//     // nothing was done\n//     return false;\n// }\n\n\n// url request params\n//app.query = parse(document.location.search.substring(1));\n\n\n// global application configuration\n// in config.js file in js root\n//app.config = require('app:config');\n\n\n// the only visible page\n//app.activePage = null;\n\n\n/**\n * Browse to a given page.\n * Do nothing if the link is invalid. Otherwise hide the current, show new and update the \"previous\" link.\n *\n * @param {Page} pageTo instance of the page to show\n * @param {*} [data] options to pass to the page on show\n *\n * @return {boolean} operation status\n */\n// app.route = function ( pageTo, data ) {\n//     var pageFrom = app.activePage;\n//\n//     if ( DEVELOP ) {\n//         //if ( router.pages.length > 0 ) {\n//         if ( !pageTo || typeof pageTo !== 'object' ) {\n//             throw new Error(__filename + ': wrong pageTo type');\n//         }\n//         if ( !('active' in pageTo) ) {\n//             throw new Error(__filename + ': missing field \"active\" in pageTo');\n//         }\n//         //}\n//     }\n//\n//     // valid not already active page\n//     if ( pageTo && !pageTo.active ) {\n//         //debug.log('router.navigate: ' + pageTo.id, pageTo === pageFrom ? 'grey' : 'green');\n//         debug.info('app route: ' + pageTo.name + '#' + pageTo.id, null, {tags: ['route', pageTo.name, pageTo.id]});\n//\n//         // update url\n//         //location.hash = this.stringify(name, data);\n//\n//         // apply visibility\n//         hidePage(app.activePage);\n//         showPage(pageTo, data);\n//\n//         // there are some listeners\n//         if ( this.events['route'] ) {\n//             // notify listeners\n//             this.emit('route', {from: pageFrom, to: pageTo});\n//         }\n//\n//         // store\n//         //this.history.push(pageTo);\n//\n//         return true;\n//     }\n//\n//     debug.warn('invalid page to route: ' + pageTo.id, null, {tags: ['route', 'page', pageTo.id]});\n//     //console.log('router.navigate: ' + pageTo.id, 'red');\n//\n//     // nothing was done\n//     return false;\n// };\n\n\nif ( DEVELOP ) {\n    // public app instance\n    window.app = app;\n\n    // window.LiveReloadOptions = {\n    //     host: '10.0.0.100',\n    //     port: 35729\n    // };\n    //\n    // require('livereload-js/dist/livereload.js');\n}\n\n\n// public\nmodule.exports = app;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// /home/dp/Projects/sdk/spasdk/app/index.js\n// module id = 20\n// module chunks = 0","/**\n * @license The MIT License (MIT)\n * @copyright Stanislav Kalashnik <darkpark.main@gmail.com>\n */\n\n/* eslint no-path-concat: 0 */\n\n'use strict';\n\n\n/**\n * Translations handler.\n *\n * @constructor\n *\n * @param {Object} config init parameters\n */\nfunction Gettext ( config ) {\n    var data, meta;\n\n    // sanitize\n    config   = config || {};\n    data     = config.data || {};\n    data[''] = data[''] || {};\n\n    // shortcut\n    meta = config.meta;\n\n    /**\n     * Display the native language translation of a textual message.\n     *\n     * @param {string} msgId textual message\n     *\n     * @return {string} translated text\n     */\n    this.gettext = function ( msgId ) {\n        return data[''][msgId] || msgId;\n    };\n\n\n    /**\n     * The \"p\" in \"pgettext\" stands for \"particular\": fetches a particular translation of the textual message.\n     *\n     * @param {string} context message context\n     * @param {string} msgId textual message\n     *\n     * @return {string} translated text\n     */\n    this.pgettext = function ( context, msgId ) {\n        return data[context] && data[context][msgId] || msgId;\n    };\n\n\n    /**\n     * Display the native language translation of a textual message whose grammatical form depends on a number.\n     *\n     * @param {string} msgId textual message in a singular form\n     * @param {string} plural textual message in a plural form\n     * @param {number} value message number\n     *\n     * @return {string} translated text\n     */\n    this.ngettext = function ( msgId, plural, value ) {\n        /* eslint no-unused-vars: 0 */\n        /* eslint no-eval: 0 */\n        /* eslint id-length: 0 */\n        var n;\n\n        if ( DEVELOP ) {\n            if ( Number(value) !== value ) {\n                throw new Error(__filename + ': value must be a number');\n            }\n        }\n\n        if ( data && meta && data[''][msgId] ) {\n            // translation\n            return data[''][msgId][eval('n = ' + value + '; ' + meta.plural)];\n        }\n\n        // english\n        return value === 1 ? msgId : plural;\n    };\n}\n\n\n// correct constructor name\nGettext.prototype.constructor = Gettext;\n\n\n// public\nmodule.exports = Gettext;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// /home/dp/Projects/sdk/cjssdk/gettext/index.js\n// module id = 21\n// module chunks = 0","/**\n * @license The MIT License (MIT)\n * @copyright Stanislav Kalashnik <darkpark.main@gmail.com>\n */\n\n'use strict';\n\nvar Emitter = require('cjs-emitter'),\n    Crypto  = require('../crypto'),\n    api     = require('../api'),\n    TagManager = require('./tag-manager');\n\n\n/**\n * events:\n * session - there is a user session\n * signup  - user was registered\n * login   - new session was created\n * unlock  - has pass\n * logout  - session was deleted\n *\n * @param {Object} [config] init parameters\n * @constructor\n */\nfunction User ( config ) {\n    // parent constructor call\n    Emitter.call(this, config);\n\n    this.crypto = new Crypto();\n\n    this.tags = new TagManager(this.crypto);\n}\n\n\n// inheritance\nUser.prototype = Object.create(Emitter.prototype);\nUser.prototype.constructor = User;\n\n\nUser.prototype.init = function () {\n    var self = this;\n\n    api.get('user/info', function ( error, data ) {\n        error && console.error(error);\n\n        //console.log('user info', data);\n\n        if ( !error ) {\n            // valid reply\n            if ( data && data.hash ) {\n                // apply\n                self.crypto.setPassHash(data.hash);\n            } else {\n                // status\n                error = true;\n            }\n        }\n\n        self.emit('session', error, data);\n    });\n};\n\n\nUser.prototype.captcha = function () {\n    var self = this;\n\n    api.get('captcha/uri', function ( error, data ) {\n        error && console.error(error);\n\n        if ( !error ) {\n            // valid reply\n            if ( data && data.src ) {\n                // apply\n                data.src = api.defaults.server + data.src;\n            } else {\n                // status\n                error = true;\n            }\n        }\n\n        self.emit('captcha', error, data);\n    });\n};\n\n\nUser.prototype.signup = function ( name, pass, code ) {\n    var self = this,\n        data = {\n            name: this.crypto.calcHash(name),\n            pass: this.crypto.calcHash(pass),\n            code: code,\n            mode: 'signup'\n        };\n\n    api.post('user/auth', data, function ( error, data ) {\n        error && console.error(error);\n\n        //console.log('user auth', data);\n\n        if ( !error ) {\n            // valid reply\n            if ( data && data.id ) {\n                // apply\n                self.unlock(pass);\n                // for autocomplete\n                localStorage.setItem('username_last_used', name);\n            } else {\n                // status\n                error = true;\n            }\n        }\n\n        self.emit('signup', error, data);\n    });\n};\n\n\nUser.prototype.login = function ( name, pass ) {\n    var self = this,\n        data = {\n            name: this.crypto.calcHash(name),\n            pass: this.crypto.calcHash(pass),\n            mode: 'login'\n        };\n\n    api.post('user/auth', data, function ( error, data ) {\n        error && console.error(error);\n\n        //console.log('user auth', data);\n\n        if ( !error ) {\n            // valid reply\n            if ( data && data.id ) {\n                // apply\n                self.unlock(pass);\n                // for autocomplete\n                localStorage.setItem('username_last_used', name);\n            } else {\n                // status\n                error = true;\n            }\n        }\n\n        self.emit('login', error, data);\n    });\n};\n\n\nUser.prototype.unlock = function ( pass ) {\n    var error = null;\n\n    // no hash or match\n    if ( !this.crypto.hasHash() || this.crypto.checkPass(pass) ) {\n        // apply\n        this.crypto.setPass(pass);\n    } else {\n        // status\n        error = true;\n    }\n\n    //console.log('user unlock', error);\n\n    this.emit('unlock', error);\n};\n\n\nUser.prototype.logout = function () {\n    var self = this;\n\n    api.post('user/logout', null, function ( error, success ) {\n        error && console.error(error);\n\n        //console.log('user logout', success);\n\n        self.emit('logout', error || !success);\n    });\n};\n\n\n// public\nmodule.exports = User;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/js/models/user.js\n// module id = 22\n// module chunks = 0","/**\n * User login and registration.\n */\n\n'use strict';\n\nvar Page   = require('spa-component-page'),\n    dom    = require('spa-dom'),\n    api    = require('../api'),\n    MainNotes = require('./main-notes'),\n    tag    = dom.tag,\n    page, tabs, images;\n\n\nfunction Main ( config ) {\n    //var self = this;\n    var user = config.model,\n        tabs;\n\n    // defaults\n    config.modifiers = ['main'];\n    config.hidden = true;\n\n    // parent constructor call\n    Page.call(this, config);\n\n    tabs = {\n        notes: new MainNotes({model: user})\n    };\n\n    // model events\n    user.addListeners({\n        unlock: function ( error ) {\n            if ( !error ) {\n                user.tags.init();\n            }\n        }\n    });\n\n    user.tags.addListeners({\n        data: function ( error ) {\n            if ( !error ) {\n                console.log('has tags');\n                tabs.notes.show();\n            }\n        }\n    });\n\n    this.$node.appendChild(dom.fragment(\n        tag('div', {className: this.name + '__header'},\n            tag('img', {className: this.name + '__icon', src: 'img/safebox.svg'}),\n            'FortNotes'\n        ),\n        tag('div', {className: this.name + '__body'},\n            //require('../tabs/main.home').$node\n            tabs.notes.$node\n        ),\n        tag('div', {className: this.name + '__footer'},\n            tag('div', {className: this.name + '__copyright'},\n                _(' 2013-2018 FortNotes. All rights reserved.')\n            )\n        )\n    ));\n}\n\n\n// inheritance\nMain.prototype = Object.create(Page.prototype);\nMain.prototype.constructor = Main;\n\n\n// public\nmodule.exports = Main;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/js/views/main.js\n// module id = 23\n// module chunks = 0","/**\n * @license The MIT License (MIT)\n * @copyright Stanislav Kalashnik <darkpark.main@gmail.com>\n */\n\n'use strict';\n\nvar Tab    = require('spa-component-tab'),\n    Button = require('spa-component-button'),\n    tag    = require('spa-dom').tag,\n    api    = require('../api'),\n    NoteSearch = require('../note-search'),\n    NoteViewer = require('../note-viewer'),\n    NoteList   = require('../note-list'),\n    TemplateList = require('../template-list'),\n    templates    = require('../data.templates');\n\n\nfunction MainNotes ( config ) {\n    var self = this,\n        user = config.model,\n        columns, buttons, inputs, errors,\n        noteSearch, noteList, noteViewer, templateList;\n\n    // defaults\n    config.modifiers = ['main-notes'];\n    config.hidden = true;\n    config.group = 'main';\n\n    // parent constructor call\n    Tab.call(this, config);\n\n\n    // model events\n    // user.addListeners({\n    //     unlock: function ( error ) {\n    //         if ( error ) {\n    //             // todo\n    //         }\n    //     }\n    // });\n\n    noteSearch = new NoteSearch({\n        model: user,\n        events: {\n            create: function () {\n                columns.$main.classList.toggle('tab__column--active');\n                columns.$side.classList.toggle('tab__column--active');\n            },\n\n            search: function ( value ) {\n                var data = {\n                    tinc: value.tinc || [],\n                    texc: value.texc || [],\n                    wcmd: value.wcmd || [],\n                    all: false\n                };\n\n                console.log(value, data);\n\n                api.post('note/search', data, function ( error, data ) {\n                    if ( error ) {\n                        console.error(error);\n                    }\n\n                    console.log('note search', data);\n\n                    noteList.init({data: data.notes});\n                });\n            }\n        }\n    });\n\n    noteList = new NoteList({\n        data: [],\n        model: user,\n        events: {\n            'click:item': function ( note ) {\n                //console.log(note);\n                templateList.hide();\n                noteViewer.init({data: note});\n\n                columns.$main.classList.toggle('tab__column--active');\n                columns.$side.classList.toggle('tab__column--active');\n                //NoteEditor.Load(note);\n            }\n        }\n    });\n\n    noteViewer = new NoteViewer({model: user});\n\n    templateList = new TemplateList({\n        data: templates,\n        model: user,\n        events: {\n            'click:item': function ( template ) {\n                this.hide();\n                NoteEditor.Create(template);\n            }\n        }\n    });\n\n\n    columns = {\n        $main: this.$node.appendChild(\n            tag('div', {className: 'tab__column tab__column--main tab__column--active'},\n                noteSearch.$node,\n                noteList.$node\n            )\n        ),\n\n        $side: this.$node.appendChild(\n            tag('div', {className: 'tab__column tab__column--side'},\n                templateList.$node,\n                noteViewer.$node\n            )\n        )\n    };\n}\n\n\n// inheritance\nMainNotes.prototype = Object.create(Tab.prototype);\nMainNotes.prototype.constructor = MainNotes;\n\n\n// public\nmodule.exports = MainNotes;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/js/views/main-notes.js\n// module id = 24\n// module chunks = 0","/**\n * List of note templates\n * @license The MIT License (MIT)\n * @copyright Stanislav Kalashnik <darkpark.main@gmail.com>\n */\n\n'use strict';\n\nvar //crypto = require('./crypto'),\n    tag = require('spa-dom').tag,\n    //List = require('spa-component-list'),\n    Component = require('spa-component'),\n    //TagManager = require('./models/tag-manager'),\n    NoteEditor = require('./note-editor'),\n    entryTypes = require('./data.entry.types').hash;\n\n\nfunction NoteViewer ( config ) {\n    config.modifiers = ['viewer'];\n\n    // parent constructor call\n    Component.call(this, config);\n\n    this.user = config.model;\n\n    // this.$title = this.$node.appendChild(\n    //     tag('div', {className: this.name + '__title'}, 'NoteViewer')\n    // );\n    //\n    // this.$items = this.$node.appendChild(\n    //     tag('div', {className: this.name + '__items'})\n    // );\n\n    config.data && this.init(config);\n\n    // this.addListener('click', function () {\n    //     console.log(config.data);\n    //     NoteEditor.Load(note);\n    // });\n}\n\n\n// inheritance\nNoteViewer.prototype = Object.create(Component.prototype);\nNoteViewer.prototype.constructor = NoteViewer;\n\n// set component name\nNoteViewer.prototype.name = 'note';\n\n\nNoteViewer.prototype.init = function ( config ) {\n    var self = this,\n        note = config.data,\n        $node = this.$node,\n        $entries = tag('div', {className: this.name + '__entries'}),\n        $tags    = tag('div', {className: this.name + '__tags'});\n        // $body    = tag('div', {className: self.name + '__item-body'}, $entries, $tags),\n        //firstUrl, $firstUrlImage;\n\n    // clear container\n    while ( $node.lastChild ) {\n        $node.removeChild($node.lastChild);\n    }\n\n    //console.log('note', note);\n\n    // iterate all note entries\n    note.entries.forEach(function ( entry ) {\n        var plain = entry.plain,\n            $entryData;\n\n        // there is data and it's not a password\n        //if ( plain.name && plain.data ) {\n        // url\n        if ( entry.id_type === 2 ) {\n            $entryData = tag('a', {target: '_blank', href: plain.data}, plain.data);\n\n            // store the first available url for icon\n            // if ( !firstUrl ) {\n            //     firstUrl = plain.data;\n            // }\n        }\n\n        // email\n        if ( entry.id_type === 5 ) {\n            $entryData = tag('a', {href: 'mailto:' + plain.data}, plain.data);\n        }\n\n        $entries.appendChild(tag('div', {className: self.name + '__entry'},\n            tag('img', {className: self.name + '__icon', src: entryTypes[entry.id_type].icon}),\n            tag('div', {className: self.name + '__body'},\n                tag('div', {className: self.name + '__name'}, plain.name),\n                tag('div', {className: self.name + '__data'}, $entryData ? $entryData : plain.data)\n            )\n        ));\n        //}\n    });\n\n    // has valid url (the first one)\n    /*if ( firstUrl ) {\n        //console.log('firstUrl raw', firstUrl);\n        // get rid of all unnecessary parts\n        firstUrl = firstUrl.split('/');\n        // schema can be missing\n        firstUrl = firstUrl.length === 1 ? firstUrl[0] : firstUrl[2];\n        //console.log('firstUrl', firstUrl);\n\n        // try to get favicon\n        $firstUrlImage = new Image();\n        $firstUrlImage.src = 'https://favicons.githubusercontent.com/' + firstUrl;\n        $firstUrlImage.onload = function () {\n            //$item.style.backgroundImage = 'url(' + $firstUrlImage.src + ')';\n            $icon.src = $firstUrlImage.src;\n        };\n    }*/\n\n    this.user.tags.ids2names(note.tags).forEach(function ( tag ) {\n        var $tag = document.createElement('div');\n\n        $tag.className = self.name + '__tag';\n        $tag.textContent = tag;\n\n        $tags.appendChild($tag);\n    });\n\n    // use template for a new note creation\n    this.$node.addEventListener('click', function () {\n        var noteEditor = new NoteEditor({model: self.user, data: note});\n\n        //self.emit('create', note);\n        console.log(note);\n        noteEditor.Init({});\n        noteEditor.Load(note);\n\n        self.$node.appendChild(noteEditor.$node);\n    });\n\n    //$item.appendChild($icon);\n    //$item.appendChild($body);\n    this.$node.appendChild($entries);\n    this.$node.appendChild($tags);\n};\n\n\n// public\nmodule.exports = NoteViewer;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/js/note-viewer.js\n// module id = 25\n// module chunks = 0","/**\n * Main module to work with single note\n * creation, edit or view\n * @copyright Stanislav Kalashnik <darkpark.main@gmail.com>\n */\n\n'use strict';\n\n/* eslint-disable valid-jsdoc */\n\nvar //autocomplete = require('autocompleter'),\n    //app = require('./app'),\n    dom = require('spa-dom'),\n    tag = dom.tag,\n    Component = require('spa-component'),\n    //crypto = require('./crypto'),\n    api = require('./api'),\n    //NoteFilter   = require('./app.note.filter'),\n    //NoteList = require('./note.list'),\n    //TemplateList = require('./template-list'),\n    //TagManager = require('./models/tag-manager'),\n    entryTypes = require('./data.entry.types');\n\n\nfunction elattr ( obj, attr ) {\n    // check if DOMElement\n    if ( obj && obj.nodeType && attr && attr instanceof Object ) {\n        for ( var akey in attr ) {\n            obj[akey] = attr[akey];\n        }\n    }\n\n    return obj;\n}\n\n\nfunction elchild ( obj, value ) {\n    // check input\n    if ( obj && value ) {\n        // DOMElement\n        if ( value.nodeType ) {\n            obj.appendChild(value);\n        } else if ( value instanceof Array ) {\n            // array of DOMElements of simple values\n            for ( var i = 0; i < value.length; i++ ) {\n                elchild(obj, value[i]);\n            }\n        } else {\n            // simple values\n            obj.appendChild(document.createTextNode(value));\n        }\n    }\n\n    return obj;\n}\n\n\nfunction element ( name, attr, data, handlers ) {\n    var tag = document.createElement(name);\n\n    elattr(tag, attr);\n    elchild(tag, data);\n\n    // set all handlers\n    if ( handlers && handlers instanceof Object ) {\n        for ( var handler in handlers ) {\n            tag[handler] = handlers[handler];\n        }\n    }\n\n    return tag;\n}\n\n\nfunction table ( rows, cols, attr, handlers ) {\n    var el = element('table', attr, null, handlers);\n\n    for ( var i = 0; i < rows; i++ ) {\n        el.insertRow(-1);\n        for ( var j = 0; j < cols; j++ ) {\n            el.rows[i].insertCell(-1);\n        }\n    }\n\n    return el;\n}\n\n\nfunction tblrow ( obj, cells, attrs ) {\n    var row = obj.insertRow(-1);\n\n    for ( var i = 0; i < cells.length; i++ ) {\n        row.insertCell(-1);\n        elchild(row.cells[i], cells[i]);\n        //row.cells[i].appendChild(cells[i]);\n        elattr(row.cells[i], attrs[i]);\n    }\n\n    return obj;\n}\n\n\nfunction NoteEditor ( config ) {\n    // for limited scopes\n    var self = this;\n\n    // input data length limit\n    var maxlengthTags = 1024,  // total length of all tags in the input field\n        maxlengthTitle = 256;   // entry name max length\n\n    // flag to indicate if there are some changes\n    // note entries was moved or type is changed\n    // entry added or deleted\n    var changed = false;\n\n    // messages\n    var msgHasChanges = 'The current note has unsaved changes. Do you really want to continue and lost these changes?';\n\n    // hover hints\n    var hint_back = 'Will discard all your current changes and show the template list.';\n    var hint_new = 'Will create a new note based on the current one.';\n    var hint_clone = 'Will save the current note as a copy.';\n    var hint_save = 'Will save all your changes. You can also press Ctrl+Enter';\n\n    // component state flag\n    // true - everything is decoded\n    // false - no plain data, everything is encrypted\n    //this.open = false;\n\n\n    /**\n     * Open the subscriber\n     * master password is accessible\n     * decrypt all the data and show it\n     */\n    // this.EventOpen = function () {\n    //     // open if there is a note\n    //     if ( this.data ) {\n    //         // iterate all entries\n    //         for ( var i = 0; i < this.dom.entries.childNodes.length; i++ ) {\n    //             var entry = this.dom.entries.childNodes[i];\n    //             //with ( this.dom.entries.childNodes[i] ) {\n    //\n    //             // set post data\n    //             entry.post.name_dec = crypto.decrypt(entry.post.name);\n    //             entry.post.data_dec = crypto.decrypt(entry.post.data);\n    //             // set current data (taking either from post or decrypt)\n    //             entry.data.name_dec = (entry.post.name === entry.data.name) ? entry.post.name_dec : crypto.decrypt(entry.data.name);\n    //             entry.data.data_dec = (entry.post.data === entry.data.data) ? entry.post.data_dec : crypto.decrypt(entry.data.data);\n    //             // enable all inputs\n    //             entry.dom.name.disabled = entry.dom.data.disabled = false;\n    //             // change input to decrypted values\n    //             entry.dom.name.value = entry.data.name_dec;\n    //             entry.dom.data.value = entry.data.data_dec;\n    //             // update counter value\n    //             entry.dom.data.onkeyup();\n    //             //}\n    //         }\n    //         //EnableControls(true);\n    //         // tags block\n    //         this.dom.tags.input.disabled = false;\n    //         this.dom.tags.input.value = TagManager.ids2str(this.data.tags).toLowerCase();\n    //         // fill autocompleter\n    //         var data = [];\n    //         // prepare all tags\n    //         for ( var tid in TagManager.dataTagsIdlist ) data.push([TagManager.dataTagsIdlist[tid], tid]);\n    //         $(this.dom.tags.input).data('autocompleter').options.data = data;\n    //     }\n    //     // component state flag\n    //     this.open = true;\n    // };\n\n\n    /**\n     * Close the subscriber\n     * master password is expired and cleared\n     * clear all the decrypted data\n     */\n    // this.EventClose = function () {\n    //     // close only if opened at the moment and there is a note\n    //     if ( this.data && this.open ) {\n    //         // iterate all entries\n    //         for ( var i = 0; i < this.dom.entries.childNodes.length; i++ ) {\n    //             var entry = this.dom.entries.childNodes[i];\n    //             //with ( this.dom.entries.childNodes[i] ) {\n    //             // if data changed than reassing (taking either from post or encrypt)\n    //             if ( entry.data.name_dec !== entry.dom.name.value ) entry.data.name = (entry.post.name_dec === entry.dom.name.value) ? entry.post.name : crypto.encrypt(entry.dom.name.value);\n    //             if ( entry.data.data_dec !== entry.dom.data.value ) entry.data.data = (entry.post.data_dec === entry.dom.data.value) ? entry.post.data : crypto.encrypt(entry.dom.data.value);\n    //             // clear post and current data\n    //             entry.post.name_dec = entry.data.name_dec = null;\n    //             entry.post.data_dec = entry.data.data_dec = null;\n    //             // disable all inputs\n    //             entry.dom.name.disabled = entry.dom.data.disabled = true;\n    //             // change input to default hidden values\n    //             entry.dom.name.value = '********';\n    //             entry.dom.data.value = '[encrypted data]';\n    //             // hide counter value\n    //             entry.dom.counter.innerHTML = '';\n    //             // hide history block and clear content\n    //             entry.dom.history.style.display = 'none';\n    //             elclear(entry.dom.history);\n    //             delete entry.data.history;\n    //             //}\n    //         }\n    //         //EnableControls(false);\n    //         // tags block\n    //         this.dom.tags.input.disabled = true;\n    //         this.data.tags = TagManager.str2ids(this.dom.tags.input.value.toLowerCase());\n    //         this.dom.tags.input.value = '[encrypted tags]';\n    //         // clear autocompleter\n    //         $(this.dom.tags.input).data('autocompleter').options.data = [];\n    //     }\n    //     // component state flag\n    //     this.open = false;\n    // };\n\n\n    /**\n     * Quick check if the tag input changed since the last post\n     * @param data tags string\n     * @param post array of tag ids posted\n     * @return bool flag of change\n     */\n    function TagsChanged ( data, post ) {\n        // prepare input\n        data = self.user.tags.str2names(data);\n        post = post || [];\n        // different size\n        if ( data.length !== post.length ) return true;\n        // check parsed string\n        for ( var id = null, i = 0; i < data.length; i++ ) {\n            id = self.user.tags.dataTagsNmlist[data[i]];\n            // new tag not posted to the server\n            if ( !id ) return true;\n            // posted tags not include this id\n            if ( !post.includes(id) ) return true;\n        }\n        return false;\n    }\n\n\n    /**\n     * Collect all the note and entries data\n     */\n    function GetData () {\n        // local vars\n        var i = 0, entry = null, deleted = [], ids = [];\n\n        // get the list of tags ids and names\n        self.data.tags = self.user.tags.str2ids(self.dom.tags.input.value.toLowerCase());\n        // tags changed since the last post\n        if ( self.data.tags.join() !== self.post.tags.join() ) {\n            // drop flag or copy of tags\n            self.post.tags = (self.data.tags.length === 0) ? 0 : self.data.tags.slice();\n        } else {\n            // no changes so nothing to be sent\n            delete self.post.tags;\n        }\n\n        // clear previous data\n        self.post.entries = [];\n\n        // fill the list of entries to be deleted\n        for ( i = 0; i < self.dom.entries.childNodes.length; i++ )\n            if ( self.dom.entries.childNodes[i].deleted ) deleted.push(self.dom.entries.childNodes[i]);\n\n        // remove deleted entries\n        for ( i = 0; i < deleted.length; i++ ) {\n            // edit mode\n            if ( deleted[i].data.id ) ids.push(deleted[i].data.id);\n            // remove from dom\n            self.dom.entries.removeChild(deleted[i]);\n        }\n        // there are some deleted entry ids\n        if ( ids.length > 0 ) self.post.deleted = ids;\n\n        //TODO: add real entries check (there maybe no one left)\n\n        // iterate all entries\n        for ( i = 0; i < self.dom.entries.childNodes.length; i++ ) {\n            entry = self.dom.entries.childNodes[i];\n            // collected data\n            var post = {};\n            // edit mode\n            if ( entry.data.id ) post.id = entry.data.id;\n            // if type changed since the last save or new mode\n            if ( entry.post.id_type !== entry.data.id_type || entry.data.id === undefined )\n                post.id_type = entry.data.id_type;\n            // entry name changed or new mode\n            if ( entry.post.name_dec !== entry.dom.name.value || entry.data.id === undefined ) {\n                entry.data.name = post.name = (entry.data.name_dec === entry.dom.name.value) ? entry.data.name : self.user.crypto.encrypt(entry.dom.name.value);\n                entry.data.name_dec = entry.dom.name.value;\n            }\n            // entry value changed or new mode\n            if ( entry.post.data_dec !== entry.dom.data.value || entry.data.id === undefined ) {\n                entry.data.data = post.data = (entry.data.data_dec === entry.dom.data.value) ? entry.data.data : self.user.crypto.encrypt(entry.dom.data.value);\n                entry.data.data_dec = entry.dom.data.value;\n            }\n            // type change block\n            entry.dom.type.style.display = 'none';\n            // hide history block\n            entry.dom.history.style.display = 'none';\n            // history block clear content\n            dom.clear(entry.dom.history);\n            delete entry.data.history;\n\n            self.post.entries.push(post);\n        }\n\n        console.log('note data to post', self.post);\n\n        return self.post;\n    }\n\n\n    /**\n     * Control button change type\n     * @param entry pointer to the entry data\n     */\n    function EntryBtnConfig ( entry ) {\n        // crete list if not exist\n        if ( entry.dom.type.childNodes.length === 0 ) {\n            var list = table(1, 0, {className: 'list'}, {\n                // set old desc\n                onmouseout: function () {\n                    entry.dom.desc.innerHTML = entry.dom.desc.value;\n                }\n            });\n\n            var cell = null;\n            // build type list\n            //for ( var id in window.dataEntryTypes.data ) {\n            for ( var id in entryTypes.hash ) {\n                id = parseInt(id, 10);\n                //cell = element('td', {className: entry.data.id_type === id ? 'current' : 'item'}, window.dataEntryTypes.data[id][window.dataEntryTypes.defn.name], {\n                cell = element('td', {className: entry.data.id_type === id ? 'current' : 'item'}, entryTypes.hash[id].name, {\n                    // set desc on mouse over action\n                    onmouseover: function () {\n                        entry.dom.desc.innerHTML = this.desc;\n                    },\n                    onclick: function () {\n                        if ( this.className === 'item' ) {\n                            // change name if default\n                            //if ( entry.dom.name.value == window.dataEntryTypes.data[entry.data.id_type][window.dataEntryTypes.defn.name] ) {\n                            //entry.dom.name.value = window.dataEntryTypes.data[this.type][window.dataEntryTypes.defn.name];\n                            entry.dom.name.value = entryTypes.hash[this.type].name;\n                            //}\n                            // prepare type, name and value\n                            entry.data.id_type = this.type;\n                            entry.data.name = self.user.crypto.encrypt(entry.dom.name.value);\n                            entry.data.name_dec = entry.dom.name.value;\n                            entry.data.data = self.user.crypto.encrypt(entry.dom.data.value);\n                            entry.data.data_dec = entry.dom.data.value;\n                            // clone entry and do some sync\n                            var entry_new = EntryCreate(entry.data);\n                            entry_new.post = entry.post;\n                            entry_new.dom.name.onchange();\n                            entry_new.dom.data.onchange();\n                            // insert and remove\n                            self.dom.entries.insertBefore(entry_new, entry);\n                            self.dom.entries.removeChild(entry);\n                            // set flag\n                            changed = true;\n                        }\n                    }\n                });\n                cell.type = id;\n                //cell.name = window.dataEntryTypes.data[id][window.dataEntryTypes.defn.name];\n                cell.name = entryTypes.hash[id].name;\n                //cell.desc = window.dataEntryTypes.data[id][window.dataEntryTypes.defn.description];\n                cell.desc = entryTypes.hash[id].description;\n                //elchild(list, cell);\n                list.appendChild(cell);\n            }\n            //elchild(entry.dom.type, list);\n            entry.dom.type.appendChild(list);\n        }\n        // show/hide block\n        entry.dom.type.style.display = (entry.dom.type.style.display !== 'block' ? 'block' : 'none');\n    }\n\n\n    /**\n     * Control button to obtain and show entry history\n     * @param entry pointer to the entry data\n     */\n    function EntryBtnHistory ( entry ) {\n        // first time\n        if ( !entry.data.history ) {\n            // note and entry are from server\n            if ( self.data.id && entry.data.id ) {\n                elchild(dom.clear(entry.dom.history), tag('div', {className: 'info'}, 'loading ...'));\n\n                api.get('note/history/' + self.data.id + '/' + entry.data.id, function ( error, history ) {\n                    if ( error ) {\n                        console.error(error);\n                        return;\n                    }\n\n                    console.log('note history', history);\n\n                    dom.clear(entry.dom.history);\n                    entry.data.history = history;\n                    var tbl = tag('table', {className: 'maxw'});\n                    if ( history.data.length ) {\n                        for ( var i = 0; i < history.data.length; i++ ) {\n                            var name = history.data[i][history.defn.name] ? self.user.crypto.decrypt(history.data[i][history.defn.name]) : '';\n                            var data = history.data[i][history.defn.data] ? self.user.crypto.decrypt(history.data[i][history.defn.data]) : '';\n                            tblrow(tbl, [\n                                // name and data\n                                tag('span', {title: name}, (name.length > 20) ? name.slice(0, 15) + '...' : name),\n                                tag('span', {title: data}, (data.length > 30) ? data.slice(0, 25) + '...' : data),\n                                // link to use\n                                element('a', {name: name, data: data}, 'use', {\n                                    onclick: function () {\n                                        entry.dom.name.value = this.name;\n                                        entry.dom.data.value = this.data;\n                                        entry.dom.name.onchange();\n                                        entry.dom.data.onchange();\n                                        entry.dom.history.style.display = 'none';\n                                    }\n                                })\n                            ], [{className: 'name'}, {className: 'data'}, {className: 'ctrl'}]);\n                        }\n                        elchild(dom.clear(entry.dom.history), tbl);\n                    } else {\n                        // no history on the server\n                        elchild(dom.clear(entry.dom.history), tag('div', {className: 'info'},\n                            'there are no history records for this entry'));\n                    }\n                });\n            } else {\n                // new entry\n                entry.data.history = [];\n                elchild(dom.clear(entry.dom.history), tag('div', {className: 'info'},\n                    'there are no history records for this entry'));\n            }\n        }\n        // show/hide block\n        entry.dom.history.style.display = (entry.dom.history.style.display !== 'block' ? 'block' : 'none');\n    }\n\n\n    /**\n     * Control button add new\n     * @param entry pointer to the entry data\n     */\n    function EntryBtnAdd ( entry ) {\n        // prepare name and value\n        //var name = window.dataEntryTypes.data[entry.data.id_type][window.dataEntryTypes.defn.name];\n        var name = entryTypes.hash[entry.data.id_type].name;\n        // generate some password if pass type\n        var data = (entry.data.id_type === 4) ? pwdgen(20) : '';\n        // clone\n        var entry_new = EntryCreate({\n            id_type: entry.data.id_type,\n            name: self.user.crypto.encrypt(name),\n            name_dec: name,\n            data: self.user.crypto.encrypt(data),\n            data_dec: data\n        });\n        self.dom.entries.insertBefore(entry_new, entry);\n        //$(entry_new.dom.name).addClass('changed');\n        entry_new.dom.name.classList.add('changed');\n        //$(entry_new.dom.data).addClass('changed');\n        entry_new.dom.data.classList.add('changed');\n        changed = true;\n    }\n\n\n    /**\n     * Control button move up\n     * @param entry pointer to the entry data\n     */\n    function EntryBtnUp ( entry ) {\n        // can be moved\n        if ( entry.previousSibling ) {\n            self.dom.entries.insertBefore(entry, entry.previousSibling);\n            changed = true;\n        }\n    }\n\n\n    /**\n     * Control button move down\n     * @param entry pointer to the entry data\n     */\n    function EntryBtnDown ( entry ) {\n        // can be moved\n        if ( entry.nextSibling ) {\n            self.dom.entries.insertBefore(entry, entry.nextSibling.nextSibling);\n            changed = true;\n        }\n    }\n\n\n    /**\n     * Control button delete\n     * @param entry pointer to the entry data\n     */\n    function EntryBtnDelete ( entry ) {\n        if ( self.dom.entries.childNodes.length > 1 ) {\n            // hide entry\n            //$(entry.dom.undo).toggleClass('hidden');\n            entry.dom.undo.classList.toggle('hidden');\n            //$(entry.dom.body).toggleClass('hidden');\n            entry.dom.body.classList.toggle('hidden');\n            // set flag\n            entry.deleted = true;\n            changed = true;\n        }\n    }\n\n\n    /**\n     * Block of note entry title name input with controls\n     * @param entry pointer to the entry data\n     */\n    function EntryBlockTitle ( entry ) {\n        // editable name\n        entry.dom.name = element('input', {\n            type: 'text',\n            maxLength: maxlengthTitle,\n            disabled: false,\n            value: entry.data.name_dec\n        }, '', {\n            onchange: function () {\n                this.value = this.value.trim();\n                // only for edit mode\n                if ( self.data.id ) {\n                    if ( entry.post.name_dec !== null && entry.post.name_dec !== this.value ) {\n                        //$(this).addClass('changed');\n                        this.classList.add('changed');\n                    } else {\n                        //$(this).removeClass('changed');\n                        this.classList.remove('changed');\n                    }\n                }\n            }\n        });\n\n        //$(entry.dom.name).keydown(function(event) {\n        entry.dom.name.addEventListener('keydown', function ( event ) {\n            // up\n            if ( event.keyCode === 38 && entry.previousSibling ) {\n                entry.previousSibling.dom.name.focus();\n            }\n            // down\n            if ( event.keyCode === 40 && entry.nextSibling ) {\n                entry.nextSibling.dom.name.focus();\n            }\n        });\n\n        // icon image\n        // entry.dom.icon = element('img', {\n        //     src: 'img/field_' + window.dataEntryTypes.data[entry.data.id_type][window.dataEntryTypes.defn.name] + '.png'\n        //     //title: 'drag and drop to change the entries order'\n        // });\n        // top title line with name and controls\n        entry.dom.title = tblrow(tag('table', {className: 'title'}), [/*entry.dom.icon,*/ entry.dom.name, entry.dom.controls], [/*{className: 'icon'},*/ {className: 'name'}, {className: 'controls'}]);\n    }\n\n\n    /**\n     * Block of note entry data input\n     * @param entry pointer to the entry data\n     */\n    function EntryBlockInput ( entry ) {\n        // types\n        entry.dom.type = tag('div', {className: 'type'});\n        // get the input data max length\n        //var limit = window.dataEntryTypes.data[entry.data.id_type][window.dataEntryTypes.defn.max];\n        var limit = entryTypes.hash[entry.data.id_type].max;\n        // create input depending on entry type\n        if ( entry.data.id_type === 6 || entry.data.id_type === 7 ) {\n            entry.dom.data = tag('textarea', {\n                className: 'text',\n                maxLength: limit,\n                disabled: false\n            }, entry.data.data_dec);\n\n            // keyboard navigation\n            //$(entry.dom.data).keydown(function(event) {\n            entry.dom.data.addEventListener('keydown', function ( event ) {\n                //TODO: selectionStart is not cross-browser\n                // up\n                if ( event.keyCode === 38 && entry.previousSibling && this.selectionStart === 0 ) {\n                    entry.previousSibling.dom.data.focus();\n                }\n                // down\n                if ( event.keyCode === 40 && entry.nextSibling && this.selectionStart === this.value.length ) {\n                    entry.nextSibling.dom.data.focus();\n                }\n            });\n        } else {\n            entry.dom.data = tag('input', {\n                type: entry.data.id_type === 5 ? 'email' : 'text',\n                maxLength: limit,\n                className: entry.data.id_type === 5 ? 'email' : 'line',\n                disabled: false,\n                value: entry.data.data_dec\n            });\n\n            // email\n            // if ( entry.data.id_type === 5 ) {\n            //     entry.dom.data.autocomplete = 'email';\n            // }\n\n            // keyboard navigation\n            //$(entry.dom.data).keydown(function(event) {\n            entry.dom.data.addEventListener('keydown', function ( event ) {\n                // up\n                if ( event.keyCode === 38 ) if ( entry.previousSibling ) {\n                    entry.previousSibling.dom.data.focus();\n                }\n                // down\n                if ( event.keyCode === 40 ) if ( entry.nextSibling ) {\n                    entry.nextSibling.dom.data.focus();\n                }\n            });\n        }\n\n        entry.dom.data.autocomplete = 'off';\n\n        // change color if changed in edit mode\n        entry.dom.data.onchange = function () {\n            this.value = this.value.trim();\n            // only for edit mode\n            if ( self.data.id ) {\n                if ( entry.post.data_dec != null && entry.post.data_dec != this.value )\n                //$(this).addClass('changed');\n                    this.classList.add('changed');\n                else\n                //$(this).removeClass('changed');\n                    this.classList.remove('changed');\n            }\n            // in case this is url entry type\n            // if ( entry.data.id_type == 2 ) {\n            //     RequestUrlTitle(this.value);\n            // }\n        };\n\n        // values history\n        entry.dom.history = tag('div', {className: 'history'});\n\n        // set chars count\n        entry.dom.data.onkeyup = function () {\n            entry.dom.counter.innerHTML = this.value.length;\n            // red alert if data reached the length limit\n            if ( this.value.length >= this.maxLength && entry.dom.counter.className != 'limit' ) {\n                entry.dom.counter.className = 'limit';\n            } else if ( this.value.length < this.maxLength && entry.dom.counter.className == 'limit' ) {\n                entry.dom.counter.className = '';\n            }\n        };\n        entry.dom.data.onkeydown = entry.dom.data.onkeyup;\n    }\n\n\n    /**\n     * Block of note entry hint\n     * @param entry pointer to the entry data\n     */\n    function EntryBlockHint ( entry ) {\n        // entry description\n        //entry.dom.desc = tag('span', {}, window.dataEntryTypes.data[entry.data.id_type][window.dataEntryTypes.defn.description]);\n        entry.dom.desc = tag('span', {}, entryTypes.hash[entry.data.id_type].description);\n        //entry.dom.desc.value = window.dataEntryTypes.data[entry.data.id_type][window.dataEntryTypes.defn.description];\n        entry.dom.desc.value = entryTypes.hash[entry.data.id_type].description;\n        // letters counter with max length check\n        entry.dom.counter = tag('span', {className: entry.dom.data.value.length === entry.dom.data.maxLength ? 'limit' : ''}, true ? '' : entry.dom.data.value.length);\n        // bottom entry description and counter\n        entry.dom.hint = tblrow(tag('table', {className: 'hint'}), [entry.dom.desc, entry.dom.counter], [{className: 'text'}, {className: 'counter'}]);\n    }\n\n\n    /**\n     * Block of note entry floating controls\n     * @param entry pointer to the entry data\n     */\n    function EntryBlockControls ( entry ) {\n        entry.dom.btn_config = element('img', {\n            src: 'img/settings.svg',\n            className: 'button',\n            title: 'change entry type'\n        }, null, {\n            onclick: function () {\n                EntryBtnConfig(entry);\n            }\n        });\n        entry.dom.btn_history = element('img', {\n            src: 'img/history.svg',\n            className: 'button',\n            title: 'show/hide entry hisory values'\n        }, null, {\n            onclick: function () {\n                EntryBtnHistory(entry);\n            }\n        });\n        entry.dom.btn_add = element('img', {\n            src: 'img/add.svg',\n            className: 'button',\n            title: 'add new entry after this one'\n        }, null, {\n            onclick: function () {\n                EntryBtnAdd(entry);\n            }\n        });\n        entry.dom.btn_up = element('img', {\n            src: 'img/arrow_up.svg',\n            className: 'button',\n            title: 'move this entry one row up'\n        }, null, {\n            onclick: function () {\n                EntryBtnUp(entry);\n            }\n        });\n        entry.dom.btn_down = element('img', {\n            src: 'img/arrow_down.svg',\n            className: 'button',\n            title: 'move this entry one row down'\n        }, null, {\n            onclick: function () {\n                EntryBtnDown(entry);\n            }\n        });\n        entry.dom.btn_delete = element('img', {\n            src: 'img/clear.svg',\n            className: 'button',\n            title: 'delete this entry'\n        }, null, {\n            onclick: function () {\n                EntryBtnDelete(entry);\n            }\n        });\n\n        var buttons = [];\n        // this is a password entry\n        if ( entry.data.id_type === 4 ) {\n            //alert(entry.dom.data.type);\n            entry.dom.btn_pwdgen = element('img', {\n                src: 'img/refresh.svg',\n                className: 'button',\n                title: 'generate a new password'\n            }, null, {\n                onclick: function () {\n                    entry.dom.data.value = pwdgen(20);\n                    entry.dom.data.onchange();\n                }\n            });\n            entry.dom.btn_maskpwd = element('img', {\n                src: 'img/visibility_off.svg',\n                className: 'button',\n                title: 'Show password'\n            }, null, {\n                onclick: function () {\n                    if ( entry.dom.data.type === 'text' ) {\n                        this.title = 'Show password';\n                        this.src = 'img/visibility_off.svg';\n                        entry.dom.data.type = 'password';\n                    } else {\n                        this.src = 'img/visibility.svg';\n                        this.title = 'Hide password';\n                        entry.dom.data.type = 'text';\n                    }\n                }\n            });\n            entry.dom.data.type = 'password';\n            //entry.dom.data.autocomplete = 'off';\n            buttons.push(entry.dom.btn_maskpwd);\n            buttons.push(entry.dom.btn_pwdgen);\n        }\n        // all other buttons\n        buttons.push(entry.dom.btn_config, entry.dom.btn_history, entry.dom.btn_add, entry.dom.btn_up, entry.dom.btn_down, entry.dom.btn_delete);\n\n        // add entry control buttons\n        return (entry.dom.controls = element('div', {className: 'hidden'}, buttons));\n    }\n\n\n    /**\n     * Single entry creation\n     * @param data entry details\n     */\n    function EntryCreate ( data ) {\n        // body of the entry\n        var entry = tag('div', {className: 'entry'});\n        // entry dom elements\n        entry.dom = {\n            undo: tag('div', {className: 'undo hidden'}),\n            body: tag('div', {className: 'body'})\n        };\n        // entry db data\n        entry.data = data || {};\n        // entry type, name and value after each saving\n        entry.post = {\n            id_type: data.id_type,\n            name: data.name,\n            name_dec: data.name_dec,\n            data: data.data,\n            data_dec: data.data_dec\n        };\n\n        // blocks\n        EntryBlockInput(entry);\n        EntryBlockHint(entry);\n        EntryBlockControls(entry);\n        EntryBlockTitle(entry);\n\n        // fill entry\n        elchild(entry.dom.body, [entry.dom.title, entry.dom.type, entry.dom.data, entry.dom.history, entry.dom.hint]);\n        elchild(entry, [entry.dom.undo, entry.dom.body]);\n        // undo delete\n        elchild(entry.dom.undo, element('a', {}, 'restore deleted entry', {\n            onclick: function () {\n                //$(entry.dom.undo).toggleClass('hidden');\n                entry.dom.undo.classList.toggle('hidden');\n                //$(entry.dom.body).toggleClass('hidden');\n                entry.dom.body.classList.toggle('hidden');\n                entry.deleted = false;\n            }\n        }));\n\n        // events\n        //$(entry).mouseenter(function(){\n        entry.addEventListener('mouseenter', function () {\n            // only if not closed\n            //if ( self.open ) {\n                if ( !entry.previousSibling ) {\n                    entry.dom.btn_up.className = 'disabled';\n                } else {\n                    entry.dom.btn_up.className = 'button';\n                }\n                if ( !entry.nextSibling ) {\n                    entry.dom.btn_down.className = 'disabled';\n                } else {\n                    entry.dom.btn_down.className = 'button';\n                }\n                //TODO: add real entries check (there are hidden entries so failure here)\n                if ( self.dom.entries.childNodes.length === 1 ) {\n                    entry.dom.btn_delete.className = 'disabled';\n                } else {\n                    entry.dom.btn_delete.className = 'button';\n                }\n                //$(entry.dom.controls).fadeIn();\n                entry.dom.controls.classList.remove('hidden');\n            //}\n        });\n        //$(entry).mouseleave(function(){\n        entry.addEventListener('mouseleave', function () {\n            // only if not closed\n            //if ( self.open ) {\n                //$(entry.dom.controls).fadeOut();\n                entry.dom.controls.classList.add('hidden');\n            //}\n        });\n        //$(entry).click(function(){\n        // iterate all entries\n//            for ( var i = 0; i < self.dom.entries.childNodes.length; i++ ) {\n//                entry = self.dom.entries.childNodes[i];\n//                $(entry.dom.body).removeClass('active');\n//            }\n//            $(this.dom.body).addClass('active');\n        //});\n        return entry;\n    }\n\n\n    /**\n     * Block of note title\n     */\n    function BlockTitle () {\n        self.dom.title = tag('div', {className: 'caption'});\n        self.dom.title.icon = tag('img', {width: 32, height: 32});\n        elchild(self.dom.title, tblrow(tag('table', {className: 'maxw'}), [\n                self.dom.title.icon,\n                [tag('div', {className: 'main'}, 'Note')/*, element('div',{className:'hint'},'creation, edit or view')*/],\n                [self.data.ctime ? tag('div', {}, 'created: ' + TimestampToDateStr(self.data.ctime)) : '',\n                    self.data.mtime ? tag('div', {}, 'edited: ' + TimestampToDateStr(self.data.mtime)) : '']\n            ], [{className: 'icon'}, {className: 'name'}, {className: 'info'}])\n        );\n    }\n\n\n    /**\n     * Block of note entries\n     */\n    function BlockEntries () {\n        // list of all entries\n        self.dom.entries = tag('div', {className: 'entries'});\n\n        // iterate all prepared entries\n        for ( var i = 0; i < self.data.entries.length; i++ ) {\n            // new entry creation and add to list\n            //elchild(self.dom.entries, EntryCreate(self.data.entries[i]));\n            self.dom.entries.appendChild(EntryCreate(self.data.entries[i]));\n        }\n\n        // drag and drop\n        //$(self.dom.entries).sortable({containment:'parent', cursor:'move', handle:'.title .icon'});\n\n        // return container\n        return self.dom.entries;\n    }\n\n\n    /**\n     * Block of tags work\n     */\n    function BlockTags () {\n        // tags input\n        var input = tag('input', {\n            type: 'text',\n            maxLength: maxlengthTags,\n            disabled: false,\n            className: 'line',\n            value: ''\n        });\n\n        // icon\n        //var icon = tag('img', {src: 'img/field_tag.png'});\n        // tags container\n        self.dom.tags = tag('div', {className: 'tags'},\n            tblrow(tag('table', {className: 'title'}), ['tags'], [{className: 'name'}]),\n            input,\n            tag('div', {className: 'hint'}, 'list of associated tags separated by space')\n        );\n        // pointers\n        self.dom.tags.input = input;\n        //self.dom.tags.icon = icon;\n        // change color if changed in edit mode\n        input.onchange = function () {\n            // only for edit mode\n            if ( self.data.id ) {\n                // tags changed since the last post\n                if ( TagsChanged(this.value, self.post.tags) ) {\n                    //$(this).addClass('changed');\n                    this.classList.add('changed');\n                } else {\n                    //$(this).removeClass('changed');\n                    this.classList.remove('changed');\n                }\n            }\n            // change icon if necessary\n            //SetTitleIcon();\n        };\n\n        var data = [];\n        // prepare all tags\n        for ( var tid in self.user.tags.dataTagsIdlist ) {\n            data.push([self.user.tags.dataTagsIdlist[tid], tid]);\n        }\n\n        /*autocomplete({\n            minLength: 1,\n            input: self.dom.tags.input,\n            fetch: function ( text, update ) {\n                console.log('data', data);\n                // get tags array\n                var result = [],\n                    tags = self.dom.tags.input.value.toLowerCase().match(/(\\S+)/g);\n\n                console.log('tags', tags);\n\n                // truncate available suggestion options\n                data.forEach(function ( item ) {\n                    if ( !tags.includes(item[0]) ) {\n                        result.push({item: item});\n                    }\n                });\n\n                console.log('result', result);\n                update(result);\n            },\n            render: function ( item ) {\n                var $body = document.createElement('div');\n\n                $body.textContent = item.item[0];\n\n                return $body;\n            },\n            onSelect: function ( item ) {\n                console.log(item);\n                //self.dom.input.value = item[0];\n            }\n        });/**/\n\n        // add autocompletion\n        /*$(self.dom.tags.input).autocomplete({\n            matchInside: false,\n            selectFirst: true,\n            useDelimiter: true,\n            delimiterChar: ' ',\n            delimiterKeyCode: 32,\n            minChars: 1,\n            autoWidth: 'width',\n            delay: 200,\n            data: data,\n            showResult: function ( tag ) {\n                // degradation fix\n                return tag;\n\n                // wrap to div with icon\n                //return '<div class=\"tag\">' + tag + '</div>';\n            },\n            processData: function ( data ) {\n                //console.log('data', data);\n                // get tags array\n                var result = [],\n                    tags = self.dom.tags.input.value.toLowerCase().match(/(\\S+)/g);\n\n                //console.log('tags', tags);\n\n                // truncate available suggestion options\n                data.forEach(function ( item ) {\n                    if ( !tags.includes(item[0]) ) {\n                        result.push(item);\n                    }\n                });\n\n                //console.log('result', result);\n                return result;\n            }\n        });/**/\n\n        // var timer = null;\n        // input.onkeydown = function() {\n        //    // only for edit mode\n        //    if ( self.data.id ) {\n        //        if ( timer ) clearTimeout(timer);\n        //        timer = setTimeout(function(){self.dom.tags.input.onchange();}, 300);\n        //    }\n        // }\n\n        // return container\n        return self.dom.tags;\n    }\n\n\n    /**\n     * Block of button controls\n     */\n    function BlockControls () {\n        // container\n        self.dom.tcontrols = element('div', {className: 'tbuttons'}, [\n            element('input', {\n                type: 'button',\n                value: 'Back',\n                className: 'button left',\n                title: hint_back\n            }, null, {\n                onclick: function () {\n                    self.Escape();\n                }\n            }),\n            element('input', {\n                type: 'button',\n                value: 'New',\n                className: 'button left',\n                title: hint_new\n            }, null, {\n                onclick: function () {\n                    self.New();\n                }\n            }),\n            element('input', {\n                type: 'button',\n                value: 'Duplicate',\n                className: 'button left',\n                title: hint_clone\n            }, null, {\n                onclick: function () {\n                    self.Clone();\n                }\n            }),\n            element('input', {\n                type: 'button',\n                value: 'Save',\n                className: 'button bold',\n                title: hint_save\n            }, null, {\n                onclick: function () {\n                    self.Save();\n                }\n            })\n        ]);\n\n        // self.dom.bcontrols = element('div', {className: 'bbuttons'}, [\n        //     //element('input', {type:'button', value:'Back', className:'button'}, null, {onclick:function(){self.Escape();}}),\n        //     element('input', {\n        //         type: 'button',\n        //         value: 'Save',\n        //         className: 'button bold',\n        //         title: hint_save\n        //     }, null, {\n        //         onclick: function () {\n        //             self.Save();\n        //         }\n        //     })\n        // ]);\n    }\n\n\n    /**\n     * Event management\n     */\n    function SetEvents () {\n        // save\n        //$(self.dom.handle).bind('keypress', function(event) {\n        self.dom.handle.addEventListener('keypress', function ( event ) {\n            if ( event.keyCode === 13 ) {\n                // save on Ctrl+Enter\n                if ( event.ctrlKey ) {\n                    //event.preventDefault();\n                    //event.stopPropagation();\n                    self.Save();\n                } else {\n                    // Enter pressed\n                }\n            }\n        });\n        // cancel\n        //$(self.dom.handle).bind('keydown', function(event) {\n        self.dom.handle.addEventListener('keydown', function ( event ) {\n            if ( event.keyCode === 27 ) {\n                // exit from here\n                self.Escape();\n            }\n        });\n    }\n\n\n    /**\n     * Compiles all blocks together\n     */\n    function Build () {\n        //with ( self ) {\n        changed = false;\n        // all blocks\n        //BlockTitle();\n        BlockEntries();\n        BlockTags();\n        BlockControls();\n\n        // clear previous handle content\n        dom.clear(self.dom.handle);\n\n        // build all blocks together\n        // elchild(self.dom.handle, [\n        //     //self.dom.title,\n        //     self.dom.tcontrols,\n        //     self.dom.entries,\n        //     element('div', {className: 'divider'}),\n        //     self.dom.tags,\n        //     element('div', {className: 'divider'})\n        //     //self.dom.bcontrols\n        // ]);\n\n        self.dom.handle.appendChild(dom.fragment(\n            //self.dom.title,\n            self.dom.tcontrols,\n            self.dom.entries,\n            tag('div', {className: 'divider'}),\n            self.dom.tags,\n            tag('div', {className: 'divider'})\n            //self.dom.bcontrols\n        ));\n\n        //}\n        //TemplateList.Show(false);\n        self.Show(true);\n    }\n\n\n    /**\n     * Asks user about modifications\n     */\n    this.ConfirmExit = function () {\n        return confirm(msgHasChanges);\n    };\n\n\n    /**\n     * Saves the current note as new\n     */\n    this.Clone = function () {\n        // clear note and entries ids\n        delete this.data.id;\n        this.data.entries.forEach(function ( entry ) {\n            delete entry.id;\n        });\n        // reset tags\n        this.post.tags = [];\n        // set flag\n        changed = true;\n        // saving\n        this.Save();\n        // focus to the first input\n        this.dom.entries.childNodes[0].dom.data.focus();\n    };\n\n\n    /**\n     * Prepares a new note with the same set of entries as the current note has\n     */\n    this.New = function () {\n        var name, data, entries = [];\n        // iterate the current entry list\n        this.data.entries.forEach(function ( entry ) {\n            // prepare name and data\n            //name = window.dataEntryTypes.data[entry.id_type][window.dataEntryTypes.defn.name];\n            name = entryTypes.hash[entry.id_type].name;\n            // generate some password if pass type\n            data = (entry.id_type === 4) ? pwdgen(20) : '';\n            // append the entry list\n            entries.push({\n                id_type: entry.id_type,\n                name: self.user.crypto.encrypt(name),\n                name_dec: name,\n                data: self.user.crypto.encrypt(data),\n                data_dec: data\n            });\n        });\n        // if user confirmed the exit\n        if ( this.Escape(true) ) {\n            // replace the entry list with the new one\n            this.data.entries = entries;\n            // compile all blocks together\n            Build();\n            // update the icon\n            //SetTitleIcon();\n            // set flag\n            changed = true;\n            // focus to the first input\n            this.dom.entries.childNodes[0].dom.data.focus();\n        }\n    };\n\n\n    /**\n     * Leaves the current note editing\n     * asks user about modifications if present\n     * @param noswitch bool flag to not return back to the template list\n     * @return bool true if the note was escaped\n     */\n    this.Escape = function ( noswitch ) {\n        // check current note modifications\n        var has_changes = NoteEditor.HasChanges();\n        // not changed or user confirmed his wish\n        if ( !has_changes || (has_changes && this.ConfirmExit()) ) {\n            // get note from the list using current id\n            //var note = NoteList.GetNoteByID(self.data.id);\n            // found\n            /*if ( note !== false ) {\n                // remove acitve cursor\n                NoteList.SetNotesState([note], 'active', false);\n            }*/\n            // clear previous content\n            dom.clear(this.dom.handle);\n            // set data\n            this.data = {tags: [], entries: []};\n            // data to be send on save\n            this.post = {tags: []};\n            //this.open = true;\n            changed = false;\n            // not full escape\n            if ( !noswitch ) {\n                self.Show(false);\n                window.templateList.show();\n            }\n            return true;\n        }\n        return false;\n    };\n\n\n    /**\n     * Creates a new note\n     */\n    this.Create = function ( template ) {\n        console.time('entry create');\n        // set data\n        this.data = {tags: [], entries: []};\n        // data to be send on save\n        this.post = {tags: []};\n        // local vars\n        //var id_template = template[window.dataTemplates.defn.id],\n        var //id_template = template.id,\n            self = this,\n            id_type, name, data, tag;\n\n        // template is given\n        if ( template ) {\n            // fill the list of entries\n            //for ( var i = 0; i < template.entries.length; i++ ) {\n            template.entries.forEach(function ( entry ) {\n                //for ( var i in window.dataTemplateEntries.data[id_template] ) {\n                // get the entry type\n                //id_type = entry.id;\n                // prepare name and data\n                //name = entry.name;\n                // generate some password if pass type\n                data = (entry.id === 4) ? pwdgen(20) : '';\n                // adding\n                self.data.entries.push({\n                    id_type: entry.id,\n                    name: self.user.crypto.encrypt(entry.name),\n                    name_dec: entry.name,\n                    data: self.user.crypto.encrypt(data),\n                    data_dec: data\n                });\n            });\n\n            //}\n            // default tag\n            tag = template.name;\n            this.data.tags = self.user.tags.str2ids(tag);\n            // no templates selected so just add one simple entry\n        } else {\n            //name = window.dataEntryTypes.data[1][window.dataEntryTypes.defn.name];\n            name = entryTypes.hash[1].name;\n            data = tag = '';\n            // adding\n            this.data.entries = [{\n                id_type: 1,\n                name: self.user.crypto.encrypt(name),\n                name_dec: name,\n                data: self.user.crypto.encrypt(data),\n                data_dec: data\n            }];\n        }\n        // compile all blocks together\n        Build();\n        // tags plain string\n        this.dom.tags.input.value = tag.toLowerCase();\n        //SetTitleIcon();\n        // focus to the first input\n        this.dom.entries.childNodes[0].dom.data.focus();\n        console.timeEnd('entry create');\n    };\n\n\n    /**\n     * Loads the existing note\n     * @param data note details\n     */\n    this.Load = function ( data ) {\n        console.time('entry load');\n        // set data\n        this.data = data;\n        // data to be send on save\n        self.post = {\n            tags: data.tags ? data.tags.slice() : [] // copy of tags\n        };\n        // data is given and valid\n        if ( data.id && data.entries && data.entries instanceof Array ) {\n            // decode data in each entry and reorganize\n            for ( var i = 0; i < data.entries.length; i++ ) {\n                var entry = data.entries[i];\n                // wrap encoded and decoded values\n                entry.name_dec = self.user.crypto.decrypt(entry.name);\n                entry.data_dec = self.user.crypto.decrypt(entry.data);\n            }\n        } else {\n            // invalid input so switch to new mode\n            this.Create();\n        }\n        // compile all blocks together\n        Build();\n        // tags plain string\n        this.dom.tags.input.value = self.user.tags.ids2str(this.data.tags).toLowerCase();\n        //SetTitleIcon();\n        console.timeEnd('entry load');\n    };\n\n\n    /**\n     * Saves all note changes\n     * 1. collects note and entries data\n     * 2. does ajax request to save\n     * 3. processing the response\n     */\n    this.Save = function () {\n        // do nothing if there are no modifications\n        if ( !this.HasChanges() ) {\n            return;\n        }\n\n        // disable controls to prevent double posting\n        //EnableControls(false);\n        //SetTitleIcon('img/message.loading.gif');\n\n        api.post('note/save/' + (this.data.id || ''), GetData(), function ( error, data ) {\n            if ( error ) {\n                console.error(error);\n            }\n\n            console.log('note save', data);\n\n            if ( data && data.id && data.entries ) {\n                // the note is just created\n                var is_new = !self.data.id ? true : false;\n                // switch to edit mode if necessary\n                self.data.id = data.id;\n                // data container for entries\n                var entries = [];\n                // iterate all entries\n                for ( var i = 0; i < self.dom.entries.childNodes.length; i++ ) {\n                    var entry = self.dom.entries.childNodes[i];\n                    // update data\n                    entry.data.id = data.entries[i].id;\n                    entry.post.name = entry.data.name;\n                    entry.post.name_dec = entry.data.name_dec;\n                    entry.post.data = entry.data.data;\n                    entry.post.data_dec = entry.data.data_dec;\n                    entry.post.id_type = entry.data.id_type;\n                    // clear color from inputs\n                    //$(entry.dom.name).removeClass('changed');\n                    entry.dom.name.classList.remove('changed');\n                    //$(entry.dom.data).removeClass('changed');\n                    entry.dom.data.classList.remove('changed');\n                    //$(self.dom.tags.input).removeClass('changed');\n                    self.dom.tags.input.classList.remove('changed');\n\n                    // change icons according to status\n                    //if ( data.entries[i].changed ) entry.dom.icon.src = 'img/field_flag_ok.png';\n                    //if ( data.entries[i].added ) entry.dom.icon.src = 'img/field_flag_add.png';\n\n                    // rebuild global data in case some items deleted or added\n                    entries.push(entry.data);\n                }\n                self.data.entries = entries;\n                // tags processed\n                if ( data.tags ) {\n                    // there are tags in response and correspond with sent ones\n                    if ( data.tags instanceof Array && self.data.tags.length === data.tags.length ) {\n                        for ( i = 0; i < data.tags.length; i++ ) {\n                            // check if the ecrypted string\n                            if ( isNaN(self.data.tags[i]) ) {\n                                // add new tag id and enc/dev values to the global lookup tables\n                                self.user.tags.add(data.tags[i], self.data.tags[i]);\n                                // replace the ecrypted string with received id\n                                self.data.tags[i] = data.tags[i];\n                            }\n                        }\n                    }\n                    // show ok image\n                    //self.dom.tags.icon.src = 'img/field_flag_ok.png';\n                }\n                // fill current tags data\n                self.dom.tags.input.value = self.user.tags.ids2str(self.data.tags).toLowerCase();\n                // confirm posted tags\n                self.post.tags = self.data.tags.slice();\n                // clear deleted entries list\n                delete self.post.deleted;\n                // timer to set default images\n                //setTimeout(function () {\n                // iterate all entries\n                //for ( var i = 0; i < self.dom.entries.childNodes.length; i++ ) {\n                //with ( self.dom.entries.childNodes[i] )\n                //var child = self.dom.entries.childNodes[i];\n                //child.dom.icon.src = 'img/field_' + window.dataEntryTypes.data[child.data.id_type][window.dataEntryTypes.defn.name] + '.png';\n                //}\n                //self.dom.tags.icon.src = 'img/field_tag.png';\n                //}, 2000);\n\n                // flag reset\n                changed = false;\n\n                NoteFilter.NotesRequest();\n//                if ( is_new ) {\n//                    self.data.ctime = Math.round(new Date().getTime() / 1000);\n//                    NoteList.NoteCreate(self.data);\n//                } else {\n//                    self.data.mtime = Math.round(new Date().getTime() / 1000);\n//                    //NoteList.dom.notes.removeChild(NoteList.dom.notes.active);\n//                    NoteList.NoteUpdate(self.data);\n//                }\n\n//                if ( NoteList.dom.notes.active ) {\n//                    var note = NoteList.dom.notes.active;\n//                    if ( NoteList.NoteVisible(note) ) NoteList.DrawNoteTags(note);\n//                }\n            } else {\n                // invalid response from the server\n            }\n            // enable controls\n            //EnableControls(true);\n            //$(self.dom.controls).removeClass('loading');\n            // change icon if necessary\n            //SetTitleIcon();\n            //self.Escape();\n        });\n    };\n\n\n    /**\n     * Returns the open at the moment note id\n     */\n    this.GetNoteID = function () {\n        return (this.data && this.data.id ? this.data.id : null);\n    };\n\n\n    /**\n     * Shows/hides the component\n     * @param state visibility flag: true - show, false - hide\n     */\n    this.Show = function ( state ) {\n        this.dom.handle.style.display = state ? 'block' : 'none';\n    };\n\n\n    /**\n     * Checks if there are any unsaved modificatons\n     * @return bool flag\n     */\n    this.HasChanges = function () {\n        var i, entry, flag = changed;\n        // note is opened\n        if ( this.data && this.data.entries && this.data.entries.length > 0 ) {\n            // not sure if has changes already\n            if ( !changed ) {\n                // iterate all entries\n                for ( i = 0; i < this.dom.entries.childNodes.length; i++ ) {\n                    entry = this.dom.entries.childNodes[i];\n                    //fb(i, entry.post.data_dec, entry.dom.data.value);\n                    //fb(i, entry.post.name_dec, entry.dom.name.value);\n                    //fb(i, entry.post.id_type, entry.data.id_type);\n                    if ( (entry.post.data_dec != null && entry.post.data_dec != entry.dom.data.value) ||\n                        (entry.post.name_dec != null && entry.post.name_dec != entry.dom.name.value) ||\n                        (entry.post.id_type != entry.data.id_type) ) {\n                        // change flag and skip all the rest checks\n                        flag = true;\n                        break;\n                    }\n                }\n                // still no changes so check tags\n                if ( !flag && TagsChanged(this.dom.tags.input.value.toLowerCase(), this.post.tags) ) flag = true;\n            }\n        }\n        return flag;\n    };\n\n\n    /**\n     * Parse data and fill the select list\n     */\n    this.ProceedUrlIcon = function ( data ) {\n        if ( data && data.query && data.query.results ) {\n            console.log(data);\n        }\n    };\n\n\n    /**\n     * Main init method\n     * @param params list of configuration parameters\n     */\n    this.Init = function ( params ) {\n        // check input\n        // if ( !params.handle ) {\n        //     return;\n        // }\n\n        // html parent object\n        this.dom = {handle: self.$node};\n        // handler on note save\n        this.onsave = params.onsave || null;\n        // handler on cancel note adding or edit\n        this.oncancel = params.oncancel || null;\n\n        // event handlers\n        SetEvents();\n    };\n\n\n    this.user = config.model;\n\n    // parent constructor call\n    Component.call(this, config);\n\n    this.$node.classList.add('noteeditor');\n}\n\n\n// inheritance\nNoteEditor.prototype = Object.create(Component.prototype);\nNoteEditor.prototype.constructor = NoteEditor;\n\n\n// public\nmodule.exports = NoteEditor;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/js/note-editor.js\n// module id = 26\n// module chunks = 0","/**\n * User login and registration.\n */\n\n'use strict';\n\nvar Page       = require('spa-component-page'),\n    dom        = require('spa-dom'),\n    UserLogin  = require('./user-login'),\n    UserSignup = require('./user-signup'),\n    UserUnlock = require('./user-unlock'),\n    tag        = dom.tag;\n\n\nfunction User ( config ) {\n    //var self = this;\n    var user = config.model,\n        tabs;\n\n    // defaults\n    config.modifiers = ['user'];\n    config.hidden = true;\n\n    // parent constructor call\n    Page.call(this, config);\n\n    tabs = {\n        login: new UserLogin({\n            model: user,\n            events: {\n                signup: function () {\n                    tabs.signup.show();\n                }\n            }\n        }),\n\n        signup: new UserSignup({\n            model: user,\n            events: {\n                cancel: function () {\n                    tabs.login.show();\n                }\n            }\n        }),\n\n        unlock: new UserUnlock({model: user})\n    };\n\n    // model events\n    user.addListeners({\n        session: function ( error ) {\n            if ( error ) {\n                // no session\n                // user should login or signup\n                tabs.login.show();\n            } else {\n                // there is a user session\n                tabs.unlock.show();\n            }\n        },\n        unlock: function ( error ) {\n            if ( !error ) {\n                // remove all tabs\n                tabs.login.remove();\n                tabs.signup.remove();\n                tabs.unlock.remove();\n            }\n        },\n        logout: function ( error ) {\n            !error && location.reload();\n        }\n    });\n\n    // userLogin.addListeners({\n    //     signup: function () {\n    //         userSignup.show();\n    //     }\n    // });\n    //\n    // userSignup.addListeners({\n    //     cancel: function () {\n    //         userLogin.show();\n    //     }\n    // });\n\n\n    this.$node.appendChild(dom.fragment(\n        tag('div', {className: this.name + '__header'}, 'FortNotes'),\n        tag('div', {className: this.name + '__body'},\n            tabs.login.$node,\n            tabs.signup.$node,\n            tabs.unlock.$node\n        ),\n        tag('div', {className: this.name + '__footer'},\n            tag('div', {className: this.name + '__links'},\n                tag('a', {className: this.name + '__link', href: '#'}, 'About'), '\\u2022',\n                tag('a', {className: this.name + '__link', href: '#'}, 'Blog'), '\\u2022',\n                tag('a', {className: this.name + '__link', href: '#'}, 'Help'), '\\u2022',\n                tag('a', {className: this.name + '__link', href: '#'}, 'Terms')\n            ),\n            tag('div', {className: this.name + '__copyright'},\n                _(' 2013-2018 FortNotes. All rights reserved.')\n            )\n        )\n    ));\n}\n\n\n// inheritance\nUser.prototype = Object.create(Page.prototype);\nUser.prototype.constructor = User;\n\n\n// public\nmodule.exports = User;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/js/views/user.js\n// module id = 27\n// module chunks = 0","/**\n * @license The MIT License (MIT)\n * @copyright Stanislav Kalashnik <darkpark.main@gmail.com>\n */\n\n'use strict';\n\nvar Tab    = require('spa-component-tab'),\n    Button = require('spa-component-button'),\n    tag    = require('spa-dom').tag;\n\n\nfunction UserLogin ( config ) {\n    var self = this,\n        user = config.model,\n        buttons, inputs, errors;\n\n    // defaults\n    config.modifiers = ['user-login'];\n    config.hidden = true;\n    config.group = 'user';\n\n    // parent constructor call\n    Tab.call(this, config);\n\n    // model events\n    user.addListeners({\n        login: function ( error ) {\n            if ( error ) {\n                // todo\n            }\n        }\n    });\n\n\n    buttons = {\n        signup: new Button({\n            value: 'Signup',\n            events: {\n                click: function () {\n                    self.emit('signup');\n                }\n            }\n        }),\n\n        login: new Button({\n            value: 'Login',\n            modifiers: ['primary'],\n            events: {\n                click: function () {\n                    var valid = true;\n\n                    if ( !inputs.$name.value ) {\n                        errors.$name.textContent = _('this field can not be empty');\n                        valid = false;\n                    }\n\n                    if ( !inputs.$pass.value ) {\n                        errors.$pass.textContent = _('this field can not be empty');\n                        valid = false;\n                    }\n\n                    if ( valid ) {\n                        user.login(inputs.$name.value, inputs.$pass.value);\n                    }\n                }\n            }\n        })\n    };\n\n    inputs = {\n        $name: tag('input', {\n            type: 'text',\n            className: 'dialog__input',\n            autofocus: true,\n            autocomplete: 'username',\n            value: localStorage.getItem('username_last_used')\n        }),\n        $pass: tag('input', {\n            type: 'password',\n            className: 'dialog__input',\n            autocomplete: 'current-password'\n        })\n    };\n\n    errors = {\n        $name: tag('div', {className: 'dialog__error'}),\n        $pass: tag('div', {className: 'dialog__error'})\n    };\n\n    this.$node.appendChild(\n        tag('form', {className: 'dialog dialog--login'},\n            tag('div', {className: 'dialog__title'},\n                //images.main.$node,\n                _('Login to your account')\n            ),\n            tag('div', {className: 'dialog__info'},\n                _('Please provide your user name and password to get access to your encrypted data.')\n            ),\n            tag('div', {className: 'dialog__entries'},\n                // username\n                tag('div', {className: 'dialog__entry dialog__entry--username'},\n                    //tag('div', {className: 'dialog__icon'}, images.key.$node),\n                    //tag('div', {className: 'dialog__icon'},\n                    tag('img', {className: 'dialog__icon', src: 'https://image.flaticon.com/icons/svg/149/149452.svg'}),\n                    //),\n                    tag('div', {className: 'dialog__body'},\n                        tag('div', {className: 'dialog__name'}, 'Username'),\n                        errors.$name,\n                        inputs.$name,\n                        tag('div', {className: 'dialog__hint'}, _('user identifier in any form'))\n                    )\n                ),\n                // password\n                tag('div', {className: 'dialog__entry dialog__entry--password'},\n                    //tag('div', {className: 'dialog__icon'}, images.key.$node),\n                    //tag('div', {className: 'dialog__icon'},\n                    tag('img', {className: 'dialog__icon', src: 'https://image.flaticon.com/icons/svg/283/283430.svg'}),\n                    //),\n                    tag('div', {className: 'dialog__body'},\n                        tag('div', {className: 'dialog__name'}, 'Password'),\n                        errors.$pass,\n                        inputs.$pass,\n                        tag('div', {className: 'dialog__hint'}, _('encryption/decryption password'))\n                    )\n                )\n            ),\n            //tag('div', {className: 'dialog__errors'}),\n            tag('div', {className: 'dialog__buttons'},\n                buttons.signup.$node,\n                buttons.login.$node\n            )\n        )\n    );\n\n    inputs.$pass.addEventListener('keydown', function ( event ) {\n        if ( event.keyCode === 13 ) {\n            buttons.login.emit('click');\n        }\n    });\n}\n\n\n// inheritance\nUserLogin.prototype = Object.create(Tab.prototype);\nUserLogin.prototype.constructor = UserLogin;\n\n\n// public\nmodule.exports = UserLogin;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/js/views/user-login.js\n// module id = 28\n// module chunks = 0","/**\n * @license The MIT License (MIT)\n * @copyright Stanislav Kalashnik <darkpark.main@gmail.com>\n */\n\n'use strict';\n\nvar Tab    = require('spa-component-tab'),\n    Button = require('spa-component-button'),\n    tag    = require('spa-dom').tag;\n\n\nfunction UserSignup ( config ) {\n    var self = this,\n        user = config.model,\n        buttons, inputs, errors, images;\n\n    // defaults\n    config.modifiers = ['user-signup'];\n    config.hidden = true;\n    config.group = 'user';\n\n    // parent constructor call\n    Tab.call(this, config);\n\n    this.addListeners({\n        show: function () {\n            user.captcha();\n        }\n    });\n\n    // model events\n    user.addListeners({\n        captcha: function ( error, data ) {\n            if ( !error ) {\n                images.$code.src = data.src;\n            }\n        },\n        signup: function ( error ) {\n            if ( error ) {\n                // todo\n            }\n        }\n    });\n\n    images = {\n        $code: tag('img', {className: 'dialog__captcha'})\n    };\n\n    buttons = {\n        cancel: new Button({\n            value: 'Cancel',\n            events: {\n                click: function () {\n                    self.emit('cancel');\n                }\n            }\n        }),\n\n        signup: new Button({\n            value: 'Signup',\n            modifiers: ['primary'],\n            events: {\n                click: function () {\n                    var valid = true;\n\n                    if ( !inputs.$name.value ) {\n                        errors.$name.textContent = _('this field can not be empty');\n                        valid = false;\n                    }\n\n                    if ( !inputs.$passA.value || !inputs.$passB.value ) {\n                        errors.$pass.textContent = _('both passwords can not be empty');\n                        valid = false;\n                    } else if ( inputs.$passA.value !== inputs.$passB.value ) {\n                        errors.$pass.textContent = _('both passwords should be identical');\n                        valid = false;\n                    }\n\n                    if ( !inputs.$code.value ) {\n                        errors.$code.textContent = _('this field can not be empty');\n                        valid = false;\n                    }\n\n                    if ( valid ) {\n                        user.signup(inputs.$name.value, inputs.$passA.value, inputs.$code.value);\n                    }\n                }\n            }\n        })\n    };\n\n    inputs = {\n        $name: tag('input', {\n            type: 'text',\n            className: 'dialog__input',\n            autofocus: true,\n            autocomplete: 'username',\n            value: localStorage.getItem('username_last_used')\n        }),\n        $passA: tag('input', {\n            type: 'password',\n            className: 'dialog__input',\n            autocomplete: 'new-password'\n        }),\n        $passB: tag('input', {\n            type: 'password',\n            className: 'dialog__input',\n            autocomplete: 'new-password'\n        }),\n        $code: tag('input', {\n            type: 'text',\n            className: 'dialog__input',\n            autocomplete: 'off'\n        })\n    };\n\n    errors = {\n        $name: tag('div', {className: 'dialog__error'}),\n        $pass: tag('div', {className: 'dialog__error'}),\n        $code: tag('div', {className: 'dialog__error'})\n    };\n\n    this.$node.appendChild(\n        tag('form', {className: 'dialog dialog--signup'},\n            tag('div', {className: 'dialog__title'},\n                //images.main.$node,\n                _('Create a new account')\n            ),\n            tag('div', {className: 'dialog__info'},\n                _('Your account will contain all your notes and tags. Everything will be encrypted with the password bellow. No password recovery is available!')\n            ),\n            tag('div', {className: 'dialog__entries'},\n                // username\n                tag('div', {className: 'dialog__entry dialog__entry--username'},\n                    //tag('div', {className: 'dialog__icon'}, images.key.$node),\n                    //tag('div', {className: 'dialog__icon'},\n                    tag('img', {className: 'dialog__icon', src: 'https://image.flaticon.com/icons/svg/149/149452.svg'}),\n                    //),\n                    tag('div', {className: 'dialog__body'},\n                        tag('div', {className: 'dialog__name'}, 'Username'),\n                        errors.$name,\n                        inputs.$name,\n                        tag('div', {className: 'dialog__hint'}, _('user identifier in any form'))\n                    )\n                ),\n                // password\n                tag('div', {className: 'dialog__entry dialog__entry--password'},\n                    //tag('div', {className: 'dialog__icon'}, images.key.$node),\n                    //tag('div', {className: 'dialog__icon'},\n                    tag('img', {className: 'dialog__icon', src: 'https://image.flaticon.com/icons/svg/283/283430.svg'}),\n                    //),\n                    tag('div', {className: 'dialog__body'},\n                        tag('div', {className: 'dialog__name'}, 'Password'),\n                        errors.$pass,\n                        inputs.$passA,\n                        tag('div', {className: 'dialog__hint'}, _('encryption/decryption password')),\n                        inputs.$passB,\n                        tag('div', {className: 'dialog__hint'}, _('password once again'))\n                    )\n                ),\n                // code\n                tag('div', {className: 'dialog__entry dialog__entry--code'},\n                    //tag('div', {className: 'dialog__icon'}, images.key.$node),\n                    //tag('div', {className: 'dialog__icon'},\n                    tag('img', {className: 'dialog__icon', src: 'https://image.flaticon.com/icons/svg/109/109730.svg'}),\n                    //),\n                    tag('div', {className: 'dialog__body'},\n                        tag('div', {className: 'dialog__name'}, 'Verification code'),\n                        errors.$code,\n                        inputs.$code,\n                        tag('div', {className: 'dialog__hint'}, _('to make sure you are not a robot')),\n                        images.$code\n                    )\n                )\n            ),\n            //tag('div', {className: 'dialog__errors'}),\n            tag('div', {className: 'dialog__buttons'},\n                buttons.cancel.$node,\n                buttons.signup.$node\n            )\n        )\n    );\n\n    // inputs.$pass.addEventListener('keydown', function ( event ) {\n    //     if ( event.keyCode === 13 ) {\n    //         buttons.signup.emit('click');\n    //     }\n    // });\n}\n\n\n// inheritance\nUserSignup.prototype = Object.create(Tab.prototype);\nUserSignup.prototype.constructor = UserSignup;\n\n\n// public\nmodule.exports = UserSignup;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/js/views/user-signup.js\n// module id = 29\n// module chunks = 0","/**\n * @license The MIT License (MIT)\n * @copyright Stanislav Kalashnik <darkpark.main@gmail.com>\n */\n\n'use strict';\n\nvar Tab    = require('spa-component-tab'),\n    Button = require('spa-component-button'),\n    tag    = require('spa-dom').tag;\n\n\nfunction UserUnlock ( config ) {\n    var user = config.model,\n        buttons, inputs, errors;\n\n    // defaults\n    config.modifiers = ['user-unlock'];\n    config.hidden = true;\n    config.group = 'user';\n\n    // parent constructor call\n    Tab.call(this, config);\n\n\n    // model events\n    user.addListeners({\n        unlock: function ( error ) {\n            if ( error ) {\n                // todo\n            }\n        }\n    });\n\n\n    buttons = {\n        logout: new Button({\n            value: 'Logout',\n            events: {\n                click: function () {\n                    user.logout();\n                }\n            }\n        }),\n\n        unlock: new Button({\n            value: 'Unlock',\n            modifiers: ['primary'],\n            events: {\n                click: function () {\n                    var valid = true;\n\n                    if ( !inputs.$pass.value ) {\n                        errors.$pass.textContent = _('this field can not be empty');\n                        valid = false;\n                    }\n\n                    if ( valid ) {\n                        user.unlock(inputs.$pass.value);\n                    }\n                }\n            }\n        })\n    };\n\n    inputs = {\n        $pass: tag('input', {type: 'password', className: 'dialog__input', autofocus: true, autocomplete: 'current-password'/*, value: '111111'*/})\n    };\n\n    errors = {\n        $pass: tag('div', {className: 'dialog__error'})\n    };\n\n    this.$node.appendChild(\n        tag('form', {className: 'dialog dialog--unlock'},\n            tag('div', {className: 'dialog__title'},\n                //images.main.$node,\n                _('Unlock your data')\n            ),\n            tag('div', {className: 'dialog__info'},\n                _('All profile data is unavailable till the master password is provided. You can unlock it with your password or logout to switch to another user.')\n            ),\n            tag('div', {className: 'dialog__entries'},\n                // password\n                tag('div', {className: 'dialog__entry dialog__entry--password'},\n                    //tag('div', {className: 'dialog__icon'}, images.key.$node),\n                    //tag('div', {className: 'dialog__icon'},\n                    tag('img', {className: 'dialog__icon', src: 'https://image.flaticon.com/icons/svg/283/283430.svg'}),\n                    //),\n                    tag('div', {className: 'dialog__body'},\n                        tag('div', {className: 'dialog__name'}, 'Password'),\n                        tag('input', {type: 'text', autocomplete: 'username', className: 'hidden', value: localStorage.getItem('username_last_used')}),\n                        errors.$pass,\n                        inputs.$pass,\n                        tag('div', {className: 'dialog__hint'}, _('encryption/decryption password'))\n                    )\n                )\n            ),\n            //tag('div', {className: 'dialog__errors'}),\n            tag('div', {className: 'dialog__buttons'},\n                buttons.logout.$node,\n                buttons.unlock.$node\n            )\n        )\n    );\n\n    inputs.$pass.addEventListener('keydown', function ( event ) {\n        if ( event.keyCode === 13 ) {\n            buttons.unlock.emit('click');\n        }\n    });\n}\n\n\n// inheritance\nUserUnlock.prototype = Object.create(Tab.prototype);\nUserUnlock.prototype.constructor = UserUnlock;\n\n\n// public\nmodule.exports = UserUnlock;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/js/views/user-unlock.js\n// module id = 30\n// module chunks = 0","/**\n * @license The MIT License (MIT)\n * @copyright Stanislav Kalashnik <darkpark.main@gmail.com>\n */\n\n'use strict';\n\nvar //autocomplete = require('autocompleter'),\n    app = require('./app'),\n    api = require('./api'),\n    NoteList = require('./note.list'),\n    TagManager = require('./models/tag-manager');\n\n\n/**\n * Main module to work with user tags and words input\n * sends ajax request to the server side, helps to render results, shows messages\n */\nvar NoteFilter = new function () {\n    // for limited scopes\n    var self = this;\n\n    // component state flag\n    // true  - everything is decoded\n    // false - no plain data, everything is encrypted\n    this.open = false;\n\n    // hints\n    var hint_wexclude = 'click on this word to remove it from the filtering';\n    var hint_home = 'reset all search parameters and filters and request the latest active notes';\n\n    // autocompleter commands hints\n    var hint_cmd = {\n        ':day': 'notes modified during the last 24 hours',\n        ':week': 'notes modified during the last week',\n        ':month': 'notes modified during the last month',\n        ':notags': 'notes without tags',\n        ':deleted': 'deleted notes'\n    };\n\n    // message texts\n    var msg_info_no_data = 'There are no records to meet the given search options. You can change these options or see your ';\n    var msg_fail_server_error = 'The request was not successful. The response from the server: ';\n\n    /**\n     * Open the subscriber\n     * master password is accessible\n     * decrypt all the data and show it\n     */\n    this.EventOpen = function () {\n        // decrypt input data if not the first time\n        if ( this.dom.input.data.length ) this.dom.input.data = JSON.parse(crypto.decrypt(this.dom.input.data));\n        // restore backuped value\n        this.dom.input.value = this.dom.input.data.encval;\n        // inner parsed data\n        this.data = TagManager.strParse(this.dom.input.value);\n        this.post = TagManager.strParse();\n        // build notes\n        PerformSearch();\n        // show/hide info and controls\n        NoteList.UpdateCtrlBlock(true);\n        // component state flag\n        this.open = true;\n    };\n\n    /**\n     * Close the subscriber\n     * master password is expired and cleared\n     * clear all the decrypted data\n     */\n    this.EventClose = function () {\n        // close only if opened at the moment\n        if ( this.open ) {\n            // delete messages\n            self.MsgClear();\n            // backup and clear search string\n            this.dom.input.data.encval = this.dom.input.value;\n            // encrypt input data\n            this.dom.input.data = crypto.encrypt(JSON.stringify(this.dom.input.data));\n            // hide current value\n            this.dom.input.value = '[encrypted data]';\n            // inner parsed data\n            this.data = {};\n            this.post = {};\n            // clear autocompleter\n            $(this.dom.input).data('autocompleter').options.data = [true];\n            // component state flag\n            this.open = false;\n        }\n    };\n\n    /**\n     * Removes all the messages\n     */\n    this.MsgClear = function () {\n        elclear(this.dom.messages);\n    }\n\n    /**\n     * Appends the given message\n     * @param text string message to add\n     * @param type string message type: info (default), warn, fail\n     */\n    this.MsgAdd = function ( text, type ) {\n        elchild(this.dom.messages, element('div', {className: type || 'info'}, text));\n    };\n\n    /**\n     * Set focus to tag search field\n     */\n    this.SetFocus = function () {\n        this.dom.input.focus();\n    };\n\n    /**\n     * Visual flags\n     */\n    var LoadingStart = function () {\n        self.dom.icon.className = 'icon loading';\n        self.dom.messages.className = 'messages loading';\n    }\n\n    /**\n     * Visual flags\n     */\n    var LoadingStop = function () {\n        self.dom.icon.className = 'icon';\n        self.dom.messages.className = 'messages';\n    }\n\n    /**\n     * Resets the current search options\n     * and get the lates notes\n     */\n    this.RequestLatest = function () {\n        this.Reset();\n        this.NotesRequest();\n    }\n\n    /**\n     * Resets the current search options\n     * and get the deleted notes using :deleted tag\n     */\n    this.RequestDeleted = function () {\n        //this.Reset();\n        this.MsgClear();\n        // update user input\n        this.dom.input.value = ':deleted';\n        // prepare inner data\n        this.UpdateParsedInput();\n        // get data and build note list\n        this.NotesRequest();\n    }\n\n    /**\n     * Sends ajax request to receive notes by tags and\n     * makes a note list using the received data\n     */\n    this.NotesRequest = function ( isall ) {\n        // show loading progress\n        LoadingStart();\n        // clone current data to post data\n        for ( var item in this.data ) {\n            this.post[item] = this.data[item].slice();\n        }\n\n        api.post('note/search', {\n            tinc: this.post.tinc,\n            texc: this.post.texc,\n            wcmd: this.post.wcmd,\n            all: isall\n        }, function ( error, data ) {\n            if ( error ) {\n                console.error(error);\n            }\n\n            console.log('note search', data);\n\n            if ( !data.error ) {\n                // make note list using the received data\n                NoteList.BuildTable(data.notes, data.total);\n                // check if no data but show message only if there were some search options uses\n                if ( data.total === 0 && (self.data.tinc.length || self.data.texc.length || self.data.wcmd.length) ) {\n                    // no data, need to inform and suggest to see for example the latest notes\n                    self.MsgAdd([msg_info_no_data, element('a', {className: 'bold'}, 'latest notes', {\n                        onclick: function () {\n                            self.RequestLatest();\n                        }\n                    })]);\n                }\n            } else {\n                // server error\n                self.MsgAdd(msg_fail_server_error + data.error, 'fail');\n            }\n\n            // hide loading progress\n            LoadingStop();\n        });\n    };\n\n    /**\n     * Updates inner data from user input if changed since last time\n     */\n    this.UpdateParsedInput = function () {\n        // check if old and current values match\n        if ( this.dom.input.value.trim() !== this.dom.input.data.oldval.trim() ) {\n            // updating parsed data\n            this.data = TagManager.strParse(this.dom.input.value);\n            // save current values\n            this.dom.input.data.oldval = this.dom.input.value;\n        }\n    };\n\n    /**\n     * Search handler\n     * updates the inner parsed data, saves the history and do the search\n     * Ctrl+Enter does the search and reformats the search string\n     * @param ctrl bool flag for Ctrl key holding\n     */\n    this.DoSearch = function ( ctrl ) {\n        var data = this.dom.input.data;\n\n        // prepare inner data\n        this.UpdateParsedInput();\n        // history\n        //with ( self.dom.input ) {\n        // first record or not the same as the last one\n        if ( data.history.length === 0 || data.history[data.history.length - 1] !== this.dom.input.value ) {\n            // fill history and reset cursor\n            data.history.push(this.dom.input.value);\n            data.histpos = data.history.length;\n        }\n        //}\n        // update user input if necessary\n        if ( ctrl ) {\n            this.dom.input.data.oldval = this.dom.input.value = TagManager.strBuild(this.data);\n        }\n        // do search\n        PerformSearch();\n    };\n\n    /**\n     * Keyboard input handler for tag search\n     */\n    var PerformSearch = function () {\n        // delete old messages\n        self.MsgClear();\n        // not empty input\n//        if ( self.dom.input.value.trim() != '' ) {\n        // parsed tags and already posted don't match\n        if ( self.data.tinc.sort().join() != self.post.tinc.sort().join() ||\n            self.data.texc.sort().join() != self.post.texc.sort().join() ||\n            self.data.wcmd.sort().join() != self.post.wcmd.sort().join() ||\n            self.dom.input.value.trim() == '' ) {\n            // there are changes\n            self.NotesRequest();\n        } else {\n            // manual filtering all the table as it was not recreated\n            NoteList.SetNotesVisibility();\n        }\n        // check input for wrong tags\n        if ( self.data.winc.length > 0 || self.data.wexc.length > 0 ) {\n            var list = []; // shows them comma-separated\n            self.data.winc.sort().forEach(function ( item ) {\n                list.push(element('a', {title: hint_wexclude, word: item, fexc: false}, item, {onclick: WordExclude}));\n            });\n            self.data.wexc.sort().forEach(function ( item ) {\n                list.push(element('a', {\n                    title: hint_wexclude,\n                    word: item,\n                    fexc: true\n                }, '-' + item, {onclick: WordExclude}));\n            });\n            self.MsgAdd(['Here is the list of words used which are not your tags:', list, '. It was used for text filtering.']);\n        }\n//        } else {\n//            // show latest\n//            NoteList.BuildTable(false);\n//            // reset inner data\n//            self.data = TagManager.strParse();\n//            self.post = TagManager.strParse();\n//        }\n    };\n\n    /**\n     * Adds the given tag to the search\n     * @param tagnm string tag name to be processed\n     */\n    this.TagInclude = function ( tagnm ) {\n        // determine tag id\n        var tagid = TagManager.dataTagsNmlist[tagnm];\n        // not added already and valid id\n        if ( tagid && !this.data.tinc.includes(tagid) ) {\n            // prepare inner parsed data\n            this.data.tinc.push(tagid);\n            this.data.ninc.push(tagnm);\n            // reforman input\n            this.dom.input.data.oldval = this.dom.input.value = TagManager.strBuild(this.data);\n        }\n        // execute\n        PerformSearch();\n    };\n\n    /**\n     * Removes the given tag from the search\n     * @param tagnm string tag name to be processed\n     */\n    this.TagExclude = function ( tagnm ) {\n        // determine tag id\n        var tagid = TagManager.dataTagsNmlist[tagnm];\n        // exists in the search line and valid id\n        if ( tagid && this.data.tinc.includes(tagid) ) {\n            // locate tag name and id in the inner parsed data\n            var tinci = this.data.tinc.indexOf(tagid);\n            var ninci = this.data.ninc.indexOf(tagnm);\n            // and clear\n            if ( tinci >= 0 ) this.data.tinc.splice(tinci, 1);\n            if ( ninci >= 0 ) this.data.ninc.splice(ninci, 1);\n            // reforman input\n            this.dom.input.data.oldval = this.dom.input.value = TagManager.strBuild(this.data);\n            //ReworkSearchStr();\n        }\n        // execute\n        PerformSearch();\n    };\n\n    /**\n     * Subtracts the given tag in the search\n     * @param tagnm string tag name to be processed\n     */\n    this.TagSubtract = function ( tagnm ) {\n        // determine tag id\n        var tagid = TagManager.dataTagsNmlist[tagnm];\n        // not subtracted already and valid id\n        if ( tagid && !this.data.texc.includes(tagid) ) {\n            // locate tag name and id in the inner parsed data\n            var tinci = this.data.tinc.indexOf(tagid);\n            var ninci = this.data.ninc.indexOf(tagnm);\n            // and clear\n            if ( tinci >= 0 ) this.data.tinc.splice(tinci, 1);\n            if ( ninci >= 0 ) this.data.ninc.splice(ninci, 1);\n            // prepare inner parsed data\n            this.data.texc.push(tagid);\n            this.data.nexc.push(tagnm);\n            // reforman input\n            this.dom.input.data.oldval = this.dom.input.value = TagManager.strBuild(this.data);\n            //ReworkSearchStr();\n        }\n        // execute\n        PerformSearch();\n    };\n\n    /**\n     * Removes the clicked word from the search\n     */\n    var WordExclude = function () {\n        var list = this.fexc ? self.data.wexc : self.data.winc,\n            wind = list.indexOf(this.word);\n        if ( wind >= 0 ) {\n            // delete word from inner data\n            list.splice(wind, 1);\n            // remove html element\n            this.parentNode.removeChild(this);\n            // remove message if there are no more words\n            if ( self.data.winc.length === 0 && self.data.wexc.length === 0 ) {\n                self.MsgClear();\n            }\n            // reforman input\n            self.dom.input.data.oldval = self.dom.input.value = TagManager.strBuild(self.data);\n            // filtering all the table\n            NoteList.SetNotesVisibility();\n        }\n    };\n\n    /**\n     * Set default search hints and remove messages\n     */\n    this.Reset = function () {\n        // clear search string and set focus\n        this.dom.input.data.oldval = this.dom.input.value = '';\n        self.dom.input.focus();\n        // clear tags data\n        this.data = TagManager.strParse();\n        this.post = TagManager.strParse();\n        // delete all messages\n        self.MsgClear();\n    }\n\n    /**\n     * Main init method\n     * @param params list of configuration parameters\n     */\n    this.Init = function ( params ) {\n        // check input\n        if ( !params.handle ) return;\n        // html parent object\n        this.dom = {handle: params.handle};\n\n        // parsed input data and its copy on post\n        this.data = TagManager.strParse();\n        this.post = TagManager.strParse();\n\n        // build all blocks together\n        elchild(this.dom.handle, [\n            // main block\n            element('div', {className: 'search'}, [\n                // home button and tags search input\n                this.dom.home = element('div', {className: 'home'}, element('div', {title: hint_home}, null, {\n                    onclick: function () {\n                        self.RequestLatest();\n                    }\n                })),\n                this.dom.input = element('input', {\n                    className: 'line',\n                    placeholder: 'search by tags or content ...',\n                    type: 'text',\n                    data: {encval: '', oldval: '', history: [], histpos: 0}\n                }),\n                this.dom.icon = element('div', {className: 'icon'})\n            ]),\n            // hidden messages\n            this.dom.messages = element('div', {className: 'messages'})\n        ]);\n\n        /*autocomplete({\n            minLength: 1,\n            input: this.dom.input,\n            fetch: function ( text, update ) {\n                var tags = text.toLowerCase().match(/(\\S+)/g);\n\n                console.log('input', text, tags);\n\n                // only if there should be some results\n                //if ( data.length > 0 ) {\n                // prepare inner parsed data\n                self.UpdateParsedInput();\n                // preparing\n                var data = [];\n                // commands\n                if ( !self.data.wcmd.includes('deleted') ) {\n                    data.push({item: [':deleted', 0]});\n                }\n                if ( !self.data.wcmd.includes('notags') ) {\n                    data.push({item: [':notags', 0]});\n                }\n                if ( !self.data.wcmd.includes('day') && !self.data.wcmd.includes('week') && !self.data.wcmd.includes('month') )\n                    data.push({item: [':day', 0]}, {item: [':week', 0]}, {item: [':month', 0]});\n                // if notags mode than no tags suggesting\n                if ( !self.data.wcmd.includes('notags') ) {\n                    var lnids = [];\n                    // get linked tags to already selected\n                    if ( self.data.tinc.length > 0 ) lnids = TagManager.linked(self.data.tinc);\n                    // iterate all tags\n                    for ( var tnm in window.dataTagsNmlist ) {\n                        // get tag id\n                        var tid = window.dataTagsNmlist[tnm];\n                        // there are no including tags selected or it's one of the linked tag\n                        if ( self.data.tinc.length === 0 || lnids.includes(tid) ) {\n                            // was not added so add it\n                            if ( !self.data.tinc.includes(tid) && !self.data.texc.includes(tid) ) {\n                                data.push({item: [tnm, tid]}, {item: ['-' + tnm, tid]});\n                            }\n                        }\n                    }\n                }\n                console.log('data', data);\n                //}\n\n                update(data);\n                //update(data.filter(function ( item ) {\n                //    return item.item[0].startsWith(text.toLowerCase());\n                //}));\n            },\n            render: function ( item ) {\n                var type  = 'tag',\n                    $body = document.createElement('div'),\n                    $hint;\n\n                $body.textContent = item.item[0];\n\n                if ( item.item[0][0] === ':' ) {\n                    // command\n                    type  = 'cmd';\n                    $hint = document.createElement('div');\n                    $hint.textContent = hint_cmd[item.item[0]];\n                    $body.appendChild($hint);\n                } else {\n                    // tag\n\n                }\n\n                $body.className = type;\n\n                return $body;\n            },\n            onSelect: function ( item ) {\n                console.log(item);\n                self.dom.input.value = item[0];\n            }\n        });/**/\n\n\n        // autocompleter init\n        $(this.dom.input).autocomplete({\n            matchInside: false,\n            selectFirst: true,\n            useDelimiter: true,\n            delimiterChar: ' ',\n            delimiterKeyCode: 32,\n            minChars: 1,\n            autoWidth: 'width',\n            delay: 200,\n            data: [true],\n            showResult: function ( tag ) {\n                // degradation fix\n                return tag;\n\n                var hint = '', fcmd = tag.charAt(0) == ':';\n                if ( fcmd ) {\n                    hint = '<div class=\"hint\">' + hint_cmd[tag] + '</div>';\n                }\n                // wrap to div with icon\n                return '<div class=\"' + (fcmd ? 'cmd' : 'tag') + '\">' + tag + hint + '</div>';\n            },\n            processData: function ( data ) {\n                // only if there should be some results\n                if ( data.length > 0 ) {\n                    // prepare inner parsed data\n                    self.UpdateParsedInput();\n                    // preparing\n                    data = [];\n                    // commands\n                    if ( !self.data.wcmd.includes('deleted') ) data.push([':deleted', 0]);\n                    if ( !self.data.wcmd.includes('notags') ) data.push([':notags', 0]);\n                    if ( !self.data.wcmd.includes('day') && !self.data.wcmd.includes('week') && !self.data.wcmd.includes('month') )\n                        data.push([':day', 0], [':week', 0], [':month', 0]);\n                    // if notags mode than no tags suggesting\n                    if ( !self.data.wcmd.includes('notags') ) {\n                        var lnids = [];\n                        // get linked tags to already selected\n                        if ( self.data.tinc.length > 0 ) lnids = TagManager.linked(self.data.tinc);\n                        // iterate all tags\n                        for ( var tnm in TagManager.dataTagsNmlist ) {\n                            // get tag id\n                            var tid = TagManager.dataTagsNmlist[tnm];\n                            // there are no including tags selected or it's one of the linked tag\n                            if ( self.data.tinc.length === 0 || lnids.includes(tid) )\n                            // was not added so add it\n                                if ( !self.data.tinc.includes(tid) && !self.data.texc.includes(tid) ) data.push([tnm, tid], ['-' + tnm, tid]);\n                        }\n                    }\n                }\n                return data;\n            }\n        });\n\n        // autocompleter for global access\n        this.ac = $(this.dom.input).data('autocompleter');\n        /**/\n\n        // search input handler\n        //$(this.dom.input).bind('keydown', function(event) {\n        this.dom.input.addEventListener('keydown', function ( event ) {\n            // enter\n            if ( event.keyCode === 13 ) {\n                self.DoSearch(event.ctrlKey);\n            }\n\n            // up\n            if ( event.keyCode === 38 ) {\n                // no autocompleter and valid history cursor\n                if ( !self.ac.active_ && this.data.histpos > 0 ) {\n                    // move up cursor position to the first non-duplicate item in the history\n                    while ( this.data.history[--this.data.histpos] && this.data.history[this.data.histpos].trim() === this.value.trim() ) {\n                    }\n                    // valid position found\n                    if ( this.data.histpos >= 0 ) this.value = this.data.history[this.data.histpos];\n                }\n            }\n\n            // down\n            if ( event.keyCode === 40 ) {\n                // no autocompleter and valid history cursor\n                if ( !self.ac.active_ && this.data.histpos < this.data.history.length - 1 ) {\n                    // move down cursor position to the first non-duplicate item in the history\n                    while ( this.data.history[++this.data.histpos] && this.data.history[this.data.histpos].trim() === this.value.trim() ) {\n                    }\n                    // valid position found\n                    if ( this.data.histpos < this.data.history.length ) this.value = this.data.history[this.data.histpos];\n                }\n            }\n\n            // ctrl + space\n            if ( event.ctrlKey && event.keyCode === 32 ) {\n                // show autocompleter if possible\n                self.ac.activate();\n            }\n        });\n    };\n};\n\nwindow.NoteFilter = NoteFilter;\n\n\n// public\nmodule.exports = NoteFilter;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/js/note.filter.js\n// module id = 31\n// module chunks = 0","/**\n * Main module to work with single note\n * creation, edit or view\n * @copyright Stanislav Kalashnik <darkpark.main@gmail.com>\n */\n\n'use strict';\n\nvar //autocomplete = require('autocompleter'),\n    //app = require('./app'),\n    crypto = require('./crypto'),\n    api = require('./api'),\n    //NoteFilter   = require('./app.note.filter'),\n    NoteList = require('./note.list'),\n    TemplateList = require('./template-list'),\n    TagManager = require('./models/tag-manager'),\n    entryTypes = require('./data.entry.types');\n\n\nwindow.NoteEditor = new function () {\n    // for limited scopes\n    var self = this;\n\n    // input data length limit\n    var maxlengthTags = 1024,  // total length of all tags in the input field\n        maxlengthTitle = 256;   // entry name max length\n\n    // flag to indicate if there are some changes\n    // note entries was moved or type is changed\n    // entry added or deleted\n    var changed = false;\n\n    // messages\n    var msgHasChanges = 'The current note has unsaved changes. Do you really want to continue and lost these changes?';\n\n    // hover hints\n    var hint_back = 'Will discard all your current changes and show the template list.';\n    var hint_new = 'Will create a new note based on the current one.';\n    var hint_clone = 'Will save the current note as a copy.';\n    var hint_save = 'Will save all your changes. You can also press Ctrl+Enter';\n\n    // component state flag\n    // true - everything is decoded\n    // false - no plain data, everything is encrypted\n    this.open = false;\n\n    /**\n     * Open the subscriber\n     * master password is accessible\n     * decrypt all the data and show it\n     */\n    this.EventOpen = function () {\n        // open if there is a note\n        if ( this.data ) {\n            // iterate all entries\n            for ( var i = 0; i < this.dom.entries.childNodes.length; i++ ) {\n                var entry = this.dom.entries.childNodes[i];\n                //with ( this.dom.entries.childNodes[i] ) {\n\n                // set post data\n                entry.post.name_dec = crypto.decrypt(entry.post.name);\n                entry.post.data_dec = crypto.decrypt(entry.post.data);\n                // set current data (taking either from post or decrypt)\n                entry.data.name_dec = (entry.post.name === entry.data.name) ? entry.post.name_dec : crypto.decrypt(entry.data.name);\n                entry.data.data_dec = (entry.post.data === entry.data.data) ? entry.post.data_dec : crypto.decrypt(entry.data.data);\n                // enable all inputs\n                entry.dom.name.disabled = entry.dom.data.disabled = false;\n                // change input to decrypted values\n                entry.dom.name.value = entry.data.name_dec;\n                entry.dom.data.value = entry.data.data_dec;\n                // update counter value\n                entry.dom.data.onkeyup();\n                //}\n            }\n            //EnableControls(true);\n            // tags block\n            this.dom.tags.input.disabled = false;\n            this.dom.tags.input.value = TagManager.ids2str(this.data.tags).toLowerCase();\n            // fill autocompleter\n            var data = [];\n            // prepare all tags\n            for ( var tid in TagManager.dataTagsIdlist ) data.push([TagManager.dataTagsIdlist[tid], tid]);\n            $(this.dom.tags.input).data('autocompleter').options.data = data;\n        }\n        // component state flag\n        this.open = true;\n    };\n\n    /**\n     * Close the subscriber\n     * master password is expired and cleared\n     * clear all the decrypted data\n     */\n    this.EventClose = function () {\n        // close only if opened at the moment and there is a note\n        if ( this.data && this.open ) {\n            // iterate all entries\n            for ( var i = 0; i < this.dom.entries.childNodes.length; i++ ) {\n                var entry = this.dom.entries.childNodes[i];\n                //with ( this.dom.entries.childNodes[i] ) {\n                // if data changed than reassing (taking either from post or encrypt)\n                if ( entry.data.name_dec !== entry.dom.name.value ) entry.data.name = (entry.post.name_dec === entry.dom.name.value) ? entry.post.name : crypto.encrypt(entry.dom.name.value);\n                if ( entry.data.data_dec !== entry.dom.data.value ) entry.data.data = (entry.post.data_dec === entry.dom.data.value) ? entry.post.data : crypto.encrypt(entry.dom.data.value);\n                // clear post and current data\n                entry.post.name_dec = entry.data.name_dec = null;\n                entry.post.data_dec = entry.data.data_dec = null;\n                // disable all inputs\n                entry.dom.name.disabled = entry.dom.data.disabled = true;\n                // change input to default hidden values\n                entry.dom.name.value = '********';\n                entry.dom.data.value = '[encrypted data]';\n                // hide counter value\n                entry.dom.counter.innerHTML = '';\n                // hide history block and clear content\n                entry.dom.history.style.display = 'none';\n                elclear(entry.dom.history);\n                delete entry.data.history;\n                //}\n            }\n            //EnableControls(false);\n            // tags block\n            this.dom.tags.input.disabled = true;\n            this.data.tags = TagManager.str2ids(this.dom.tags.input.value.toLowerCase());\n            this.dom.tags.input.value = '[encrypted tags]';\n            // clear autocompleter\n            $(this.dom.tags.input).data('autocompleter').options.data = [];\n        }\n        // component state flag\n        this.open = false;\n    };\n\n    /**\n     * Quick check if the tag input changed since the last post\n     * @param data tags string\n     * @param post array of tag ids posted\n     * @return bool flag of change\n     */\n    var TagsChanged = function ( data, post ) {\n        // prepare input\n        data = TagManager.str2names(data);\n        post = post || [];\n        // different size\n        if ( data.length !== post.length ) return true;\n        // check parsed string\n        for ( var id = null, i = 0; i < data.length; i++ ) {\n            id = TagManager.dataTagsNmlist[data[i]];\n            // new tag not posted to the server\n            if ( !id ) return true;\n            // posted tags not include this id\n            if ( !post.includes(id) ) return true;\n        }\n        return false;\n    };\n\n    /**\n     * Collect all the note and entries data\n     */\n    var GetData = function () {\n        // local vars\n        var i = 0, entry = null, deleted = [], ids = [];\n\n        // get the list of tags ids and names\n        self.data.tags = TagManager.str2ids(self.dom.tags.input.value.toLowerCase());\n        // tags changed since the last post\n        if ( self.data.tags.join() !== self.post.tags.join() ) {\n            // drop flag or copy of tags\n            self.post.tags = (self.data.tags.length === 0) ? 0 : self.data.tags.slice();\n        } else {\n            // no changes so nothing to be sent\n            delete self.post.tags;\n        }\n\n        // clear previous data\n        self.post.entries = [];\n\n        // fill the list of entries to be deleted\n        for ( i = 0; i < self.dom.entries.childNodes.length; i++ )\n            if ( self.dom.entries.childNodes[i].deleted ) deleted.push(self.dom.entries.childNodes[i]);\n\n        // remove deleted entries\n        for ( i = 0; i < deleted.length; i++ ) {\n            // edit mode\n            if ( deleted[i].data.id ) ids.push(deleted[i].data.id);\n            // remove from dom\n            self.dom.entries.removeChild(deleted[i]);\n        }\n        // there are some deleted entry ids\n        if ( ids.length > 0 ) self.post.deleted = ids;\n\n        //TODO: add real entries check (there maybe no one left)\n\n        // iterate all entries\n        for ( i = 0; i < self.dom.entries.childNodes.length; i++ ) {\n            entry = self.dom.entries.childNodes[i];\n            // collected data\n            var post = {};\n            // edit mode\n            if ( entry.data.id ) post.id = entry.data.id;\n            // if type changed since the last save or new mode\n            if ( entry.post.id_type !== entry.data.id_type || entry.data.id === undefined )\n                post.id_type = entry.data.id_type;\n            // entry name changed or new mode\n            if ( entry.post.name_dec !== entry.dom.name.value || entry.data.id === undefined ) {\n                entry.data.name = post.name = (entry.data.name_dec === entry.dom.name.value) ? entry.data.name : crypto.encrypt(entry.dom.name.value);\n                entry.data.name_dec = entry.dom.name.value;\n            }\n            // entry value changed or new mode\n            if ( entry.post.data_dec !== entry.dom.data.value || entry.data.id === undefined ) {\n                entry.data.data = post.data = (entry.data.data_dec === entry.dom.data.value) ? entry.data.data : crypto.encrypt(entry.dom.data.value);\n                entry.data.data_dec = entry.dom.data.value;\n            }\n            // type change block\n            entry.dom.type.style.display = 'none';\n            // hide history block\n            entry.dom.history.style.display = 'none';\n            // history block clear content\n            elclear(entry.dom.history);\n            delete entry.data.history;\n\n            self.post.entries.push(post);\n        }\n\n        console.log('note data to post', self.post);\n\n        return self.post;\n    };\n\n    /**\n     * Saves all note changes\n     * 1. collects note and entries data\n     * 2. does ajax request to save\n     * 3. processing the response\n     */\n    this.Save = function () {\n        // do nothing if there are no modifications\n        if ( !this.HasChanges() ) {\n            return;\n        }\n\n        // disable controls to prevent double posting\n        //EnableControls(false);\n        //SetTitleIcon('img/message.loading.gif');\n\n        api.post('note/save/' + (this.data.id || ''), GetData(), function ( error, data ) {\n            if ( error ) {\n                console.error(error);\n            }\n\n            console.log('note save', data);\n\n            if ( data && data.id && data.entries ) {\n                // the note is just created\n                var is_new = !self.data.id ? true : false;\n                // switch to edit mode if necessary\n                self.data.id = data.id;\n                // data container for entries\n                var entries = [];\n                // iterate all entries\n                for ( var i = 0; i < self.dom.entries.childNodes.length; i++ ) {\n                    var entry = self.dom.entries.childNodes[i];\n                    // update data\n                    entry.data.id = data.entries[i].id;\n                    entry.post.name = entry.data.name;\n                    entry.post.name_dec = entry.data.name_dec;\n                    entry.post.data = entry.data.data;\n                    entry.post.data_dec = entry.data.data_dec;\n                    entry.post.id_type = entry.data.id_type;\n                    // clear color from inputs\n                    //$(entry.dom.name).removeClass('changed');\n                    entry.dom.name.classList.remove('changed');\n                    //$(entry.dom.data).removeClass('changed');\n                    entry.dom.data.classList.remove('changed');\n                    //$(self.dom.tags.input).removeClass('changed');\n                    self.dom.tags.input.classList.remove('changed');\n\n                    // change icons according to status\n                    //if ( data.entries[i].changed ) entry.dom.icon.src = 'img/field_flag_ok.png';\n                    //if ( data.entries[i].added ) entry.dom.icon.src = 'img/field_flag_add.png';\n\n                    // rebuild global data in case some items deleted or added\n                    entries.push(entry.data);\n                }\n                self.data.entries = entries;\n                // tags processed\n                if ( data.tags ) {\n                    // there are tags in response and correspond with sent ones\n                    if ( data.tags instanceof Array && self.data.tags.length === data.tags.length ) {\n                        for ( i = 0; i < data.tags.length; i++ ) {\n                            // check if the ecrypted string\n                            if ( isNaN(self.data.tags[i]) ) {\n                                // add new tag id and enc/dev values to the global lookup tables\n                                TagManager.add(data.tags[i], self.data.tags[i]);\n                                // replace the ecrypted string with received id\n                                self.data.tags[i] = data.tags[i];\n                            }\n                        }\n                    }\n                    // show ok image\n                    //self.dom.tags.icon.src = 'img/field_flag_ok.png';\n                }\n                // fill current tags data\n                self.dom.tags.input.value = TagManager.ids2str(self.data.tags).toLowerCase();\n                // confirm posted tags\n                self.post.tags = self.data.tags.slice();\n                // clear deleted entries list\n                delete self.post.deleted;\n                // timer to set default images\n                //setTimeout(function () {\n                    // iterate all entries\n                    //for ( var i = 0; i < self.dom.entries.childNodes.length; i++ ) {\n                        //with ( self.dom.entries.childNodes[i] )\n                        //var child = self.dom.entries.childNodes[i];\n                        //child.dom.icon.src = 'img/field_' + window.dataEntryTypes.data[child.data.id_type][window.dataEntryTypes.defn.name] + '.png';\n                    //}\n                    //self.dom.tags.icon.src = 'img/field_tag.png';\n                //}, 2000);\n\n                // flag reset\n                changed = false;\n\n                NoteFilter.NotesRequest();\n//                if ( is_new ) {\n//                    self.data.ctime = Math.round(new Date().getTime() / 1000);\n//                    NoteList.NoteCreate(self.data);\n//                } else {\n//                    self.data.mtime = Math.round(new Date().getTime() / 1000);\n//                    //NoteList.dom.notes.removeChild(NoteList.dom.notes.active);\n//                    NoteList.NoteUpdate(self.data);\n//                }\n\n//                if ( NoteList.dom.notes.active ) {\n//                    var note = NoteList.dom.notes.active;\n//                    if ( NoteList.NoteVisible(note) ) NoteList.DrawNoteTags(note);\n//                }\n            } else {\n                // invalid response from the server\n            }\n            // enable controls\n            //EnableControls(true);\n            //$(self.dom.controls).removeClass('loading');\n            // change icon if necessary\n            //SetTitleIcon();\n            //self.Escape();\n        });\n    };\n\n    /**\n     * Control button change type\n     * @param entry pointer to the entry data\n     */\n    var EntryBtnConfig = function ( entry ) {\n        // crete list if not exist\n        if ( entry.dom.type.childNodes.length === 0 ) {\n            var list = table(1, 0, {className: 'list'}, {\n                // set old desc\n                onmouseout: function () {\n                    entry.dom.desc.innerHTML = entry.dom.desc.value;\n                }\n            });\n\n            var cell = null;\n            // build type list\n            //for ( var id in window.dataEntryTypes.data ) {\n            for ( var id in entryTypes.hash ) {\n                id = parseInt(id, 10);\n                //cell = element('td', {className: entry.data.id_type === id ? 'current' : 'item'}, window.dataEntryTypes.data[id][window.dataEntryTypes.defn.name], {\n                cell = element('td', {className: entry.data.id_type === id ? 'current' : 'item'}, entryTypes.hash[id].name, {\n                    // set desc on mouse over action\n                    onmouseover: function () {\n                        entry.dom.desc.innerHTML = this.desc;\n                    },\n                    onclick: function () {\n                        if ( this.className === 'item' ) {\n                            // change name if default\n                            //if ( entry.dom.name.value == window.dataEntryTypes.data[entry.data.id_type][window.dataEntryTypes.defn.name] ) {\n                            //entry.dom.name.value = window.dataEntryTypes.data[this.type][window.dataEntryTypes.defn.name];\n                            entry.dom.name.value = entryTypes.hash[this.type].name;\n                            //}\n                            // prepare type, name and value\n                            entry.data.id_type = this.type;\n                            entry.data.name = crypto.encrypt(entry.dom.name.value);\n                            entry.data.name_dec = entry.dom.name.value;\n                            entry.data.data = crypto.encrypt(entry.dom.data.value);\n                            entry.data.data_dec = entry.dom.data.value;\n                            // clone entry and do some sync\n                            var entry_new = EntryCreate(entry.data);\n                            entry_new.post = entry.post;\n                            entry_new.dom.name.onchange();\n                            entry_new.dom.data.onchange();\n                            // insert and remove\n                            self.dom.entries.insertBefore(entry_new, entry);\n                            self.dom.entries.removeChild(entry);\n                            // set flag\n                            changed = true;\n                        }\n                    }\n                });\n                cell.type = id;\n                //cell.name = window.dataEntryTypes.data[id][window.dataEntryTypes.defn.name];\n                cell.name = entryTypes.hash[id].name;\n                //cell.desc = window.dataEntryTypes.data[id][window.dataEntryTypes.defn.description];\n                cell.desc = entryTypes.hash[id].description;\n                elchild(list, cell);\n            }\n            elchild(entry.dom.type, list);\n        }\n        // show/hide block\n        entry.dom.type.style.display = (entry.dom.type.style.display !== 'block' ? 'block' : 'none');\n    };\n\n    /**\n     * Control button to obtain and show entry history\n     * @param entry pointer to the entry data\n     */\n    var EntryBtnHistory = function ( entry ) {\n        // first time\n        if ( !entry.data.history ) {\n            // note and entry are from server\n            if ( self.data.id && entry.data.id ) {\n                elchild(elclear(entry.dom.history), element('div', {className: 'info'}, 'loading ...'));\n\n                api.get('note/history/' + self.data.id + '/' + entry.data.id, function ( error, history ) {\n                    if ( error ) {\n                        console.error(error);\n                        return;\n                    }\n\n                    console.log('note history', history);\n\n                    elclear(entry.dom.history);\n                    entry.data.history = history;\n                    var tbl = element('table', {className: 'maxw'});\n                    if ( history.data.length ) {\n                        for ( var i = 0; i < history.data.length; i++ ) {\n                            var name = history.data[i][history.defn.name] ? crypto.decrypt(history.data[i][history.defn.name]) : '';\n                            var data = history.data[i][history.defn.data] ? crypto.decrypt(history.data[i][history.defn.data]) : '';\n                            tblrow(tbl, [\n                                // name and data\n                                element('span', {title: name}, (name.length > 20) ? name.slice(0, 15) + '...' : name),\n                                element('span', {title: data}, (data.length > 30) ? data.slice(0, 25) + '...' : data),\n                                // link to use\n                                element('a', {name: name, data: data}, 'use', {\n                                    onclick: function () {\n                                        entry.dom.name.value = this.name;\n                                        entry.dom.data.value = this.data;\n                                        entry.dom.name.onchange();\n                                        entry.dom.data.onchange();\n                                        entry.dom.history.style.display = 'none';\n                                    }\n                                })\n                            ], [{className: 'name'}, {className: 'data'}, {className: 'ctrl'}]);\n                        }\n                        elchild(elclear(entry.dom.history), tbl);\n                    } else {\n                        // no history on the server\n                        elchild(elclear(entry.dom.history), element('div', {className: 'info'},\n                            'there are no history records for this entry'));\n                    }\n                });\n            } else {\n                // new entry\n                entry.data.history = [];\n                elchild(elclear(entry.dom.history), element('div', {className: 'info'},\n                    'there are no history records for this entry'));\n            }\n        }\n        // show/hide block\n        entry.dom.history.style.display = (entry.dom.history.style.display !== 'block' ? 'block' : 'none');\n    };\n\n    /**\n     * Control button add new\n     * @param entry pointer to the entry data\n     */\n    var EntryBtnAdd = function ( entry ) {\n        // prepare name and value\n        //var name = window.dataEntryTypes.data[entry.data.id_type][window.dataEntryTypes.defn.name];\n        var name = entryTypes.hash[entry.data.id_type].name;\n        // generate some password if pass type\n        var data = (entry.data.id_type === 4) ? pwdgen(20) : '';\n        // clone\n        var entry_new = EntryCreate({\n            id_type: entry.data.id_type,\n            name: crypto.encrypt(name),\n            name_dec: name,\n            data: crypto.encrypt(data),\n            data_dec: data\n        });\n        self.dom.entries.insertBefore(entry_new, entry);\n        //$(entry_new.dom.name).addClass('changed');\n        entry_new.dom.name.classList.add('changed');\n        //$(entry_new.dom.data).addClass('changed');\n        entry_new.dom.data.classList.add('changed');\n        changed = true;\n    };\n\n    /**\n     * Control button move up\n     * @param entry pointer to the entry data\n     */\n    var EntryBtnUp = function ( entry ) {\n        // can be moved\n        if ( entry.previousSibling ) {\n            self.dom.entries.insertBefore(entry, entry.previousSibling);\n            changed = true;\n        }\n    };\n\n    /**\n     * Control button move down\n     * @param entry pointer to the entry data\n     */\n    var EntryBtnDown = function ( entry ) {\n        // can be moved\n        if ( entry.nextSibling ) {\n            self.dom.entries.insertBefore(entry, entry.nextSibling.nextSibling);\n            changed = true;\n        }\n    };\n\n    /**\n     * Control button delete\n     * @param entry pointer to the entry data\n     */\n    var EntryBtnDelete = function ( entry ) {\n        if ( self.dom.entries.childNodes.length > 1 ) {\n            // hide entry\n            //$(entry.dom.undo).toggleClass('hidden');\n            entry.dom.undo.classList.toggle('hidden');\n            //$(entry.dom.body).toggleClass('hidden');\n            entry.dom.body.classList.toggle('hidden');\n            // set flag\n            entry.deleted = true;\n            changed = true;\n        }\n    };\n\n    /**\n     * Block of note entry title name input with controls\n     * @param entry pointer to the entry data\n     */\n    var EntryBlockTitle = function ( entry ) {\n        // editable name\n        entry.dom.name = element('input', {\n            type: 'text',\n            maxLength: maxlengthTitle,\n            disabled: !self.open,\n            value: entry.data.name_dec\n        }, '', {\n            onchange: function () {\n                this.value = this.value.trim();\n                // only for edit mode\n                if ( self.data.id ) {\n                    if ( entry.post.name_dec !== null && entry.post.name_dec !== this.value ) {\n                        //$(this).addClass('changed');\n                        this.classList.add('changed');\n                    } else {\n                        //$(this).removeClass('changed');\n                        this.classList.remove('changed');\n                    }\n                }\n            }\n        });\n\n        //$(entry.dom.name).keydown(function(event) {\n        entry.dom.name.addEventListener('keydown', function ( event ) {\n            // up\n            if ( event.keyCode === 38 && entry.previousSibling ) {\n                entry.previousSibling.dom.name.focus();\n            }\n            // down\n            if ( event.keyCode === 40 && entry.nextSibling ) {\n                entry.nextSibling.dom.name.focus();\n            }\n        });\n\n        // icon image\n        // entry.dom.icon = element('img', {\n        //     src: 'img/field_' + window.dataEntryTypes.data[entry.data.id_type][window.dataEntryTypes.defn.name] + '.png'\n        //     //title: 'drag and drop to change the entries order'\n        // });\n        // top title line with name and controls\n        entry.dom.title = tblrow(element('table', {className: 'title'}), [/*entry.dom.icon,*/ entry.dom.name, entry.dom.controls], [/*{className: 'icon'},*/ {className: 'name'}, {className: 'controls'}]);\n    };\n\n    /**\n     * Block of note entry data input\n     * @param entry pointer to the entry data\n     */\n    var EntryBlockInput = function ( entry ) {\n        // types\n        entry.dom.type = element('div', {className: 'type'});\n        // get the input data max length\n        //var limit = window.dataEntryTypes.data[entry.data.id_type][window.dataEntryTypes.defn.max];\n        var limit = entryTypes.hash[entry.data.id_type].max;\n        // create input depending on entry type\n        if ( entry.data.id_type === 6 || entry.data.id_type === 7 ) {\n            entry.dom.data = element('textarea', {\n                className: 'text',\n                maxLength: limit,\n                disabled: !self.open\n            }, entry.data.data_dec);\n\n            // keyboard navigation\n            //$(entry.dom.data).keydown(function(event) {\n            entry.dom.data.addEventListener('keydown', function ( event ) {\n                //TODO: selectionStart is not cross-browser\n                // up\n                if ( event.keyCode === 38 && entry.previousSibling && this.selectionStart === 0 ) {\n                    entry.previousSibling.dom.data.focus();\n                }\n                // down\n                if ( event.keyCode === 40 && entry.nextSibling && this.selectionStart === this.value.length ) {\n                    entry.nextSibling.dom.data.focus();\n                }\n            });\n        } else {\n            entry.dom.data = element('input', {\n                type: entry.data.id_type === 5 ? 'email' : 'text',\n                maxLength: limit,\n                className: entry.data.id_type === 5 ? 'email' : 'line',\n                disabled: !self.open,\n                value: entry.data.data_dec\n            });\n\n            // email\n            // if ( entry.data.id_type === 5 ) {\n            //     entry.dom.data.autocomplete = 'email';\n            // }\n\n            // keyboard navigation\n            //$(entry.dom.data).keydown(function(event) {\n            entry.dom.data.addEventListener('keydown', function ( event ) {\n                // up\n                if ( event.keyCode === 38 ) if ( entry.previousSibling ) {\n                    entry.previousSibling.dom.data.focus();\n                }\n                // down\n                if ( event.keyCode === 40 ) if ( entry.nextSibling ) {\n                    entry.nextSibling.dom.data.focus();\n                }\n            });\n        }\n\n        entry.dom.data.autocomplete = 'off';\n\n        // change color if changed in edit mode\n        entry.dom.data.onchange = function () {\n            this.value = this.value.trim();\n            // only for edit mode\n            if ( self.data.id ) {\n                if ( entry.post.data_dec != null && entry.post.data_dec != this.value )\n                //$(this).addClass('changed');\n                    this.classList.add('changed');\n                else\n                //$(this).removeClass('changed');\n                    this.classList.remove('changed');\n            }\n            // in case this is url entry type\n            // if ( entry.data.id_type == 2 ) {\n            //     RequestUrlTitle(this.value);\n            // }\n        };\n\n        // values history\n        entry.dom.history = element('div', {className: 'history'});\n\n        // set chars count\n        entry.dom.data.onkeyup = function () {\n            entry.dom.counter.innerHTML = this.value.length;\n            // red alert if data reached the length limit\n            if ( this.value.length >= this.maxLength && entry.dom.counter.className != 'limit' ) {\n                entry.dom.counter.className = 'limit';\n            } else if ( this.value.length < this.maxLength && entry.dom.counter.className == 'limit' ) {\n                entry.dom.counter.className = '';\n            }\n        };\n        entry.dom.data.onkeydown = entry.dom.data.onkeyup;\n    };\n\n    // var RequestUrlTitle = function ( url ) {\n    //     //delete this.data.comment;\n    //     var comment = null;\n    //     // get an empty comment block\n    //     for ( var i = 0; i < self.dom.entries.childNodes.length; i++ ) {\n    //         var entry = self.dom.entries.childNodes[i];\n    //         // plain text type\n    //         if ( entry.data.id_type == 6 && entry.dom.data.value.trim() == '' ) {\n    //             comment = entry.dom.data;\n    //             break;\n    //         }\n    //     }\n    //     // send request only if there is an empty comment entry\n    //     if ( comment ) {\n    //         url = 'http://query.yahooapis.com/v1/public/yql?q=' +\n    //             'select * from html where url=\"' + encodeURIComponent(url) + '\" and xpath=\"/html/head/title\"&format=json';\n    //         $.ajax(url, {crossDomain:true, dataType:'json',\n    //             success: function(data){\n    //                 if ( data && data.query && data.query.results && data.query.results.title ) {\n    //                     comment.value = data.query.results.title;\n    //                     comment.onkeyup();\n    //                     comment.onchange();\n    //                 }\n    //             }\n    //         });\n    //     }\n    // };\n\n    /**\n     * Parse data and fill the select list\n     */\n    this.ProceedUrlIcon = function ( data ) {\n        if ( data && data.query && data.query.results ) {\n            console.log(data);\n        }\n    };\n\n    /**\n     * Block of note entry hint\n     * @param entry pointer to the entry data\n     */\n    var EntryBlockHint = function ( entry ) {\n        // entry description\n        //entry.dom.desc = element('span', {}, window.dataEntryTypes.data[entry.data.id_type][window.dataEntryTypes.defn.description]);\n        entry.dom.desc = element('span', {}, entryTypes.hash[entry.data.id_type].description);\n        //entry.dom.desc.value = window.dataEntryTypes.data[entry.data.id_type][window.dataEntryTypes.defn.description];\n        entry.dom.desc.value = entryTypes.hash[entry.data.id_type].description;\n        // letters counter with max length check\n        entry.dom.counter = element('span', {className: entry.dom.data.value.length === entry.dom.data.maxLength ? 'limit' : ''}, !self.open ? '' : entry.dom.data.value.length);\n        // bottom entry description and counter\n        entry.dom.hint = tblrow(element('table', {className: 'hint'}), [entry.dom.desc, entry.dom.counter], [{className: 'text'}, {className: 'counter'}]);\n    };\n\n    /**\n     * Block of note entry floating controls\n     * @param entry pointer to the entry data\n     */\n    var EntryBlockControls = function ( entry ) {\n        entry.dom.btn_config = element('img', {\n            src: 'img/settings.svg',\n            className: 'button',\n            title: 'change entry type'\n        }, null, {\n            onclick: function () {\n                EntryBtnConfig(entry);\n            }\n        });\n        entry.dom.btn_history = element('img', {\n            src: 'img/history.svg',\n            className: 'button',\n            title: 'show/hide entry hisory values'\n        }, null, {\n            onclick: function () {\n                EntryBtnHistory(entry);\n            }\n        });\n        entry.dom.btn_add = element('img', {\n            src: 'img/add.svg',\n            className: 'button',\n            title: 'add new entry after this one'\n        }, null, {\n            onclick: function () {\n                EntryBtnAdd(entry);\n            }\n        });\n        entry.dom.btn_up = element('img', {\n            src: 'img/arrow_up.svg',\n            className: 'button',\n            title: 'move this entry one row up'\n        }, null, {\n            onclick: function () {\n                EntryBtnUp(entry);\n            }\n        });\n        entry.dom.btn_down = element('img', {\n            src: 'img/arrow_down.svg',\n            className: 'button',\n            title: 'move this entry one row down'\n        }, null, {\n            onclick: function () {\n                EntryBtnDown(entry);\n            }\n        });\n        entry.dom.btn_delete = element('img', {\n            src: 'img/clear.svg',\n            className: 'button',\n            title: 'delete this entry'\n        }, null, {\n            onclick: function () {\n                EntryBtnDelete(entry);\n            }\n        });\n\n        var buttons = [];\n        // this is a password entry\n        if ( entry.data.id_type === 4 ) {\n            //alert(entry.dom.data.type);\n            entry.dom.btn_pwdgen = element('img', {\n                src: 'img/refresh.svg',\n                className: 'button',\n                title: 'generate a new password'\n            }, null, {\n                onclick: function () {\n                    entry.dom.data.value = pwdgen(20);\n                    entry.dom.data.onchange();\n                }\n            });\n            entry.dom.btn_maskpwd = element('img', {\n                src: 'img/visibility_off.svg',\n                className: 'button',\n                title: 'Show password'\n            }, null, {\n                onclick: function () {\n                    if ( entry.dom.data.type === 'text' ) {\n                        this.title = 'Show password';\n                        this.src = 'img/visibility_off.svg';\n                        entry.dom.data.type = 'password';\n                    } else {\n                        this.src = 'img/visibility.svg';\n                        this.title = 'Hide password';\n                        entry.dom.data.type = 'text';\n                    }\n                }\n            });\n            entry.dom.data.type = 'password';\n            //entry.dom.data.autocomplete = 'off';\n            buttons.push(entry.dom.btn_maskpwd);\n            buttons.push(entry.dom.btn_pwdgen);\n        }\n        // all other buttons\n        buttons.push(entry.dom.btn_config, entry.dom.btn_history, entry.dom.btn_add, entry.dom.btn_up, entry.dom.btn_down, entry.dom.btn_delete);\n        // add entry control buttons\n        return entry.dom.controls = element('div', {className: 'hidden'}, buttons);\n    };\n\n    /**\n     * Single entry creation\n     * @param data entry details\n     */\n    var EntryCreate = function ( data ) {\n        // body of the entry\n        var entry = element('div', {className: 'entry'});\n        // entry dom elements\n        entry.dom = {\n            undo: element('div', {className: 'undo hidden'}),\n            body: element('div', {className: 'body'})\n        };\n        // entry db data\n        entry.data = data || {};\n        // entry type, name and value after each saving\n        entry.post = {\n            id_type: data.id_type,\n            name: data.name,\n            name_dec: data.name_dec,\n            data: data.data,\n            data_dec: data.data_dec\n        };\n\n        // blocks\n        EntryBlockInput(entry);\n        EntryBlockHint(entry);\n        EntryBlockControls(entry);\n        EntryBlockTitle(entry);\n\n        // fill entry\n        elchild(entry.dom.body, [entry.dom.title, entry.dom.type, entry.dom.data, entry.dom.history, entry.dom.hint]);\n        elchild(entry, [entry.dom.undo, entry.dom.body]);\n        // undo delete\n        elchild(entry.dom.undo, element('a', {}, 'restore deleted entry', {\n            onclick: function () {\n                //$(entry.dom.undo).toggleClass('hidden');\n                entry.dom.undo.classList.toggle('hidden');\n                //$(entry.dom.body).toggleClass('hidden');\n                entry.dom.body.classList.toggle('hidden');\n                entry.deleted = false;\n            }\n        }));\n\n        // events\n        //$(entry).mouseenter(function(){\n        entry.addEventListener('mouseenter', function () {\n            // only if not closed\n            if ( self.open ) {\n                if ( !entry.previousSibling ) {\n                    entry.dom.btn_up.className = 'disabled';\n                } else {\n                    entry.dom.btn_up.className = 'button';\n                }\n                if ( !entry.nextSibling ) {\n                    entry.dom.btn_down.className = 'disabled';\n                } else {\n                    entry.dom.btn_down.className = 'button';\n                }\n                //TODO: add real entries check (there are hidden entries so failure here)\n                if ( self.dom.entries.childNodes.length === 1 ) {\n                    entry.dom.btn_delete.className = 'disabled';\n                } else {\n                    entry.dom.btn_delete.className = 'button';\n                }\n                //$(entry.dom.controls).fadeIn();\n                entry.dom.controls.classList.remove('hidden');\n            }\n        });\n        //$(entry).mouseleave(function(){\n        entry.addEventListener('mouseleave', function () {\n            // only if not closed\n            if ( self.open ) {\n                //$(entry.dom.controls).fadeOut();\n                entry.dom.controls.classList.add('hidden');\n            }\n        });\n        //$(entry).click(function(){\n        // iterate all entries\n//            for ( var i = 0; i < self.dom.entries.childNodes.length; i++ ) {\n//                entry = self.dom.entries.childNodes[i];\n//                $(entry.dom.body).removeClass('active');\n//            }\n//            $(this.dom.body).addClass('active');\n        //});\n        return entry;\n    };\n\n    /**\n     * Block of note title\n     */\n    var BlockTitle = function () {\n        self.dom.title = element('div', {className: 'caption'});\n        self.dom.title.icon = element('img', {width: 32, height: 32});\n        elchild(self.dom.title, tblrow(element('table', {className: 'maxw'}), [\n                self.dom.title.icon,\n                [element('div', {className: 'main'}, 'Note')/*, element('div',{className:'hint'},'creation, edit or view')*/],\n                [self.data.ctime ? element('div', {}, 'created: ' + TimestampToDateStr(self.data.ctime)) : '',\n                    self.data.mtime ? element('div', {}, 'edited: ' + TimestampToDateStr(self.data.mtime)) : '']\n            ], [{className: 'icon'}, {className: 'name'}, {className: 'info'}])\n        );\n    };\n\n    /**\n     * Block of note entries\n     */\n    var BlockEntries = function () {\n        // list of all entries\n        self.dom.entries = element('div', {className: 'entries'});\n\n        // iterate all prepared entries\n        for ( var i = 0; i < self.data.entries.length; i++ ) {\n            // new entry creation and add to list\n            elchild(self.dom.entries,\n                EntryCreate(self.data.entries[i]));\n        }\n\n        // drag and drop\n        //$(self.dom.entries).sortable({containment:'parent', cursor:'move', handle:'.title .icon'});\n\n        // return container\n        return self.dom.entries;\n    };\n\n    /**\n     * Block of tags work\n     */\n    var BlockTags = function () {\n        // tags input\n        var input = element('input', {\n            type: 'text',\n            maxLength: maxlengthTags,\n            disabled: !self.open,\n            className: 'line',\n            value: ''\n        });\n        // icon\n        //var icon = element('img', {src: 'img/field_tag.png'});\n        // tags container\n        self.dom.tags = element('div', {className: 'tags'}, [\n            tblrow(element('table', {className: 'title'}), [/*icon, */'tags'], [/*{className: 'icon'},*/ {className: 'name'}]),\n            input,\n            element('div', {className: 'hint'}, 'list of associated tags separated by space')\n        ]);\n        // pointers\n        self.dom.tags.input = input;\n        //self.dom.tags.icon = icon;\n        // change color if changed in edit mode\n        input.onchange = function () {\n            // only for edit mode\n            if ( self.data.id ) {\n                // tags changed since the last post\n                if ( TagsChanged(this.value, self.post.tags) ) {\n                    //$(this).addClass('changed');\n                    this.classList.add('changed');\n                } else {\n                    //$(this).removeClass('changed');\n                    this.classList.remove('changed');\n                }\n            }\n            // change icon if necessary\n            //SetTitleIcon();\n        };\n\n        var data = [];\n        // prepare all tags\n        for ( var tid in TagManager.dataTagsIdlist ) {\n            data.push([TagManager.dataTagsIdlist[tid], tid]);\n        }\n\n        /*autocomplete({\n            minLength: 1,\n            input: self.dom.tags.input,\n            fetch: function ( text, update ) {\n                console.log('data', data);\n                // get tags array\n                var result = [],\n                    tags = self.dom.tags.input.value.toLowerCase().match(/(\\S+)/g);\n\n                console.log('tags', tags);\n\n                // truncate available suggestion options\n                data.forEach(function ( item ) {\n                    if ( !tags.includes(item[0]) ) {\n                        result.push({item: item});\n                    }\n                });\n\n                console.log('result', result);\n                update(result);\n            },\n            render: function ( item ) {\n                var $body = document.createElement('div');\n\n                $body.textContent = item.item[0];\n\n                return $body;\n            },\n            onSelect: function ( item ) {\n                console.log(item);\n                //self.dom.input.value = item[0];\n            }\n        });/**/\n\n        // add autocompletion\n        $(self.dom.tags.input).autocomplete({\n            matchInside: false,\n            selectFirst: true,\n            useDelimiter: true,\n            delimiterChar: ' ',\n            delimiterKeyCode: 32,\n            minChars: 1,\n            autoWidth: 'width',\n            delay: 200,\n            data: data,\n            showResult: function ( tag ) {\n                // degradation fix\n                return tag;\n\n                // wrap to div with icon\n                //return '<div class=\"tag\">' + tag + '</div>';\n            },\n            processData: function ( data ) {\n                //console.log('data', data);\n                // get tags array\n                var result = [],\n                    tags = self.dom.tags.input.value.toLowerCase().match(/(\\S+)/g);\n\n                //console.log('tags', tags);\n\n                // truncate available suggestion options\n                data.forEach(function ( item ) {\n                    if ( !tags.includes(item[0]) ) {\n                        result.push(item);\n                    }\n                });\n\n                //console.log('result', result);\n                return result;\n            }\n        });/**/\n\n        // var timer = null;\n        // input.onkeydown = function() {\n        //    // only for edit mode\n        //    if ( self.data.id ) {\n        //        if ( timer ) clearTimeout(timer);\n        //        timer = setTimeout(function(){self.dom.tags.input.onchange();}, 300);\n        //    }\n        // }\n\n        // return container\n        return self.dom.tags;\n    };\n\n    /**\n     * Block of button controls\n     */\n    var BlockControls = function () {\n        // container\n        self.dom.tcontrols = element('div', {className: 'tbuttons'}, [\n            element('input', {\n                type: 'button',\n                value: 'Back',\n                className: 'button left',\n                title: hint_back\n            }, null, {\n                onclick: function () {\n                    self.Escape();\n                }\n            }),\n            element('input', {\n                type: 'button',\n                value: 'New',\n                className: 'button left',\n                title: hint_new\n            }, null, {\n                onclick: function () {\n                    self.New();\n                }\n            }),\n            element('input', {\n                type: 'button',\n                value: 'Duplicate',\n                className: 'button left',\n                title: hint_clone\n            }, null, {\n                onclick: function () {\n                    self.Clone();\n                }\n            }),\n            element('input', {\n                type: 'button',\n                value: 'Save',\n                className: 'button bold',\n                title: hint_save\n            }, null, {\n                onclick: function () {\n                    self.Save();\n                }\n            })\n        ]);\n\n        // self.dom.bcontrols = element('div', {className: 'bbuttons'}, [\n        //     //element('input', {type:'button', value:'Back', className:'button'}, null, {onclick:function(){self.Escape();}}),\n        //     element('input', {\n        //         type: 'button',\n        //         value: 'Save',\n        //         className: 'button bold',\n        //         title: hint_save\n        //     }, null, {\n        //         onclick: function () {\n        //             self.Save();\n        //         }\n        //     })\n        // ]);\n    };\n\n    /**\n     * Event management\n     */\n    var SetEvents = function () {\n        // save\n        //$(self.dom.handle).bind('keypress', function(event) {\n        self.dom.handle.addEventListener('keypress', function ( event ) {\n            if ( event.keyCode === 13 ) {\n                // save on Ctrl+Enter\n                if ( event.ctrlKey ) {\n                    //event.preventDefault();\n                    //event.stopPropagation();\n                    self.Save();\n                } else {\n                    // Enter pressed\n                }\n            }\n        });\n        // cancel\n        //$(self.dom.handle).bind('keydown', function(event) {\n        self.dom.handle.addEventListener('keydown', function ( event ) {\n            if ( event.keyCode === 27 ) {\n                // exit from here\n                self.Escape();\n            }\n        });\n    };\n\n    /**\n     * Enebles/disables the control buttons\n     * @param state bool flag\n     */\n    /*var EnableControls = function ( state ) {\n        if ( self.dom.bcontrols ) {\n            var controls = self.dom.bcontrols.childNodes;\n            for ( var i = 0; i < controls.length; i++ ) {\n                controls[i].disabled = !state;\n            }\n        }\n    };*/\n\n    /**\n     * Asks user about modifications\n     */\n    this.ConfirmExit = function () {\n        return confirm(msgHasChanges);\n    }\n\n    /**\n     * Saves the current note as new\n     */\n    this.Clone = function () {\n        // clear note and entries ids\n        delete this.data.id;\n        this.data.entries.forEach(function ( entry ) {\n            delete entry.id;\n        });\n        // reset tags\n        this.post.tags = [];\n        // set flag\n        changed = true;\n        // saving\n        this.Save();\n        // focus to the first input\n        this.dom.entries.childNodes[0].dom.data.focus();\n    }\n\n    /**\n     * Prepares a new note with the same set of entries as the current note has\n     */\n    this.New = function () {\n        var name, data, entries = [];\n        // iterate the current entry list\n        this.data.entries.forEach(function ( entry ) {\n            // prepare name and data\n            //name = window.dataEntryTypes.data[entry.id_type][window.dataEntryTypes.defn.name];\n            name = entryTypes.hash[entry.id_type].name;\n            // generate some password if pass type\n            data = (entry.id_type == 4) ? pwdgen(20) : '';\n            // append the entry list\n            entries.push({\n                id_type: entry.id_type,\n                name: crypto.encrypt(name),\n                name_dec: name,\n                data: crypto.encrypt(data),\n                data_dec: data\n            });\n        });\n        // if user confirmed the exit\n        if ( this.Escape(true) ) {\n            // replace the entry list with the new one\n            this.data.entries = entries;\n            // compile all blocks together\n            Build();\n            // update the icon\n            //SetTitleIcon();\n            // set flag\n            changed = true;\n            // focus to the first input\n            this.dom.entries.childNodes[0].dom.data.focus();\n        }\n    };\n\n    /**\n     * Leaves the current note editing\n     * asks user about modifications if present\n     * @param noswitch bool flag to not return back to the template list\n     * @return bool true if the note was escaped\n     */\n    this.Escape = function ( noswitch ) {\n        // check current note modifications\n        var has_changes = NoteEditor.HasChanges();\n        // not changed or user confirmed his wish\n        if ( !has_changes || (has_changes && this.ConfirmExit()) ) {\n            // get note from the list using current id\n            //var note = NoteList.GetNoteByID(self.data.id);\n            // found\n            /*if ( note !== false ) {\n                // remove acitve cursor\n                NoteList.SetNotesState([note], 'active', false);\n            }*/\n            // clear previous content\n            elclear(this.dom.handle);\n            // set data\n            this.data = {tags: [], entries: []};\n            // data to be send on save\n            this.post = {tags: []};\n            //this.open = true;\n            changed = false;\n            // not full escape\n            if ( !noswitch ) {\n                self.Show(false);\n                window.templateList.show();\n            }\n            return true;\n        }\n        return false;\n    };\n\n    /**\n     * Creates a new note\n     */\n    this.Create = function ( template ) {\n        console.time('entry create');\n        // set data\n        this.data = {tags: [], entries: []};\n        // data to be send on save\n        this.post = {tags: []};\n        // local vars\n        //var id_template = template[window.dataTemplates.defn.id],\n        var //id_template = template.id,\n            self = this,\n            id_type, name, data, tag;\n\n        // template is given\n        if ( template ) {\n            // fill the list of entries\n            //for ( var i = 0; i < template.entries.length; i++ ) {\n            template.entries.forEach(function ( entry ) {\n                //for ( var i in window.dataTemplateEntries.data[id_template] ) {\n                // get the entry type\n                //id_type = entry.id;\n                // prepare name and data\n                //name = entry.name;\n                // generate some password if pass type\n                data = (entry.id === 4) ? pwdgen(20) : '';\n                // adding\n                self.data.entries.push({\n                    id_type: entry.id,\n                    name: crypto.encrypt(entry.name),\n                    name_dec: entry.name,\n                    data: crypto.encrypt(data),\n                    data_dec: data\n                });\n            });\n\n            //}\n            // default tag\n            tag = template.name;\n            this.data.tags = TagManager.str2ids(tag);\n            // no templates selected so just add one simple entry\n        } else {\n            //name = window.dataEntryTypes.data[1][window.dataEntryTypes.defn.name];\n            name = entryTypes.hash[1].name;\n            data = tag = '';\n            // adding\n            this.data.entries = [{\n                id_type: 1,\n                name: crypto.encrypt(name),\n                name_dec: name,\n                data: crypto.encrypt(data),\n                data_dec: data\n            }];\n        }\n        // compile all blocks together\n        Build();\n        // tags plain string\n        this.dom.tags.input.value = tag.toLowerCase();\n        //SetTitleIcon();\n        // focus to the first input\n        this.dom.entries.childNodes[0].dom.data.focus();\n        console.timeEnd('entry create');\n    };\n\n    /**\n     * Loads the existing note\n     * @param data note details\n     */\n    this.Load = function ( data ) {\n        console.time('entry load');\n        // set data\n        this.data = data;\n        // data to be send on save\n        self.post = {\n            tags: data.tags ? data.tags.slice() : [] // copy of tags\n        };\n        // data is given and valid\n        if ( data.id && data.entries && data.entries instanceof Array ) {\n            // decode data in each entry and reorganize\n            for ( var i = 0; i < data.entries.length; i++ ) {\n                var entry = data.entries[i];\n                // wrap encoded and decoded values\n                entry.name_dec = crypto.decrypt(entry.name);\n                entry.data_dec = crypto.decrypt(entry.data);\n            }\n        } else {\n            // invalid input so switch to new mode\n            this.Create();\n        }\n        // compile all blocks together\n        Build();\n        // tags plain string\n        this.dom.tags.input.value = TagManager.ids2str(this.data.tags).toLowerCase();\n        //SetTitleIcon();\n        console.timeEnd('entry load');\n    };\n\n    /**\n     * Returns the open at the moment note id\n     */\n    this.GetNoteID = function () {\n        return (this.data && this.data.id ? this.data.id : null);\n    };\n\n    /*var SetTitleIcon = function ( icon ) {\n        if ( !icon ) {\n            //icon = 'img/tag_note.png';\n            icon = 'img/tags/note.svg';\n            var tags = self.dom.tags.input.value.toLowerCase().match(/(\\S+)/g);\n            // check parsed string\n            if ( tags && tags instanceof Array ) {\n                // iterate words in the input string\n                for ( var i = 0; i < tags.length; i++ ) {\n                    if ( window.iconTags.includes(tags[i]) ) {\n                        //icon = 'img/tag_' + tags[i] + '.png';\n                        icon = 'img/tags/' + tags[i] + '.svg';\n                        break;\n                    }\n                }\n            }\n        }\n        if ( self.dom.title.icon.src.search(icon) < 0 ) {\n            self.dom.title.icon.src = icon;\n        }\n    };*/\n\n    /**\n     * Compiles all blocks together\n     */\n    var Build = function () {\n        //with ( self ) {\n        changed = false;\n        // all blocks\n        //BlockTitle();\n        BlockEntries();\n        BlockTags();\n        BlockControls();\n\n        // clear previous handle content\n        elclear(self.dom.handle);\n\n        // build all blocks together\n        elchild(self.dom.handle, [\n            //self.dom.title,\n            self.dom.tcontrols,\n            self.dom.entries,\n            element('div', {className: 'divider'}),\n            self.dom.tags,\n            element('div', {className: 'divider'})\n            //self.dom.bcontrols\n        ]);\n        //}\n        //TemplateList.Show(false);\n        self.Show(true);\n\n    };\n\n    /**\n     * Shows/hides the component\n     * @param state visibility flag: true - show, false - hide\n     */\n    this.Show = function ( state ) {\n        this.dom.handle.style.display = state ? 'block' : 'none';\n    };\n\n    /**\n     * Checks if there are any unsaved modificatons\n     * @return bool flag\n     */\n    this.HasChanges = function () {\n        var i, entry, flag = changed;\n        // note is opened\n        if ( this.data && this.data.entries && this.data.entries.length > 0 ) {\n            // not sure if has changes already\n            if ( !changed ) {\n                // iterate all entries\n                for ( i = 0; i < this.dom.entries.childNodes.length; i++ ) {\n                    entry = this.dom.entries.childNodes[i];\n                    //fb(i, entry.post.data_dec, entry.dom.data.value);\n                    //fb(i, entry.post.name_dec, entry.dom.name.value);\n                    //fb(i, entry.post.id_type, entry.data.id_type);\n                    if ( (entry.post.data_dec != null && entry.post.data_dec != entry.dom.data.value) ||\n                        (entry.post.name_dec != null && entry.post.name_dec != entry.dom.name.value) ||\n                        (entry.post.id_type != entry.data.id_type) ) {\n                        // change flag and skip all the rest checks\n                        flag = true;\n                        break;\n                    }\n                }\n                // still no changes so check tags\n                if ( !flag && TagsChanged(this.dom.tags.input.value.toLowerCase(), this.post.tags) ) flag = true;\n            }\n        }\n        return flag;\n    };\n\n    /**\n     * Main init method\n     * @param params list of configuration parameters\n     */\n    this.Init = function ( params ) {\n        // check input\n        if ( !params.handle ) {\n            return;\n        }\n\n        // html parent object\n        this.dom = {handle: params.handle};\n        // handler on note save\n        this.onsave = params.onsave || null;\n        // handler on cancel note adding or edit\n        this.oncancel = params.oncancel || null;\n\n        // event handlers\n        SetEvents();\n    };\n};\n\n\n// public\n//module.exports = NoteEditor;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/js/note.editor.js\n// module id = 32\n// module chunks = 0","/**\n * Helper functions\n */\n\nvar sjcl = require('./sjcl.min');\n\n\n// array prototypes\n// Array.prototype.has = function ( value ) {\n//     return this.indexOf(value) >= 0;\n// };\n// Array.prototype.empty = function () {\n//     return !(this.length > 0);\n// };\n// Array.prototype.each = function ( func ) {\n//     var i, l = this.length;\n//\n//     for ( i = 0; i < l; i++ ) {\n//         func(this[i], i);\n//     }\n// };\n// IE compatibility\n// if ( !Array.indexOf ) {\n//     Array.prototype.indexOf = function ( obj, start ) {\n//         var i;\n//         for ( i = (start || 0); i < this.length; i++ ) {\n//             if ( this[i] === obj ) { return i; }\n//         }\n//         return -1;\n//     };\n// }\n\n// string prototypes\n// String.prototype.trim = function() {\n//    return this.replace(/^\\s+|\\s+$/g,\"\");\n// };\n// String.prototype.ltrim = function() {\n//    return this.replace(/^\\s+/g,\"\");\n// };\n// String.prototype.rtrim = function () {\n//     return this.replace(/\\s+$/g, '');\n// };\n\n\n/**\n * Firebug debug compatible with IE\n * free list of params\n */\n// function fb () {\n//     if ( window.console && window.console.info )\n//         // send all arguments to firebug\n//         console.info(arguments.length == 1 ? arguments[0] : arguments);\n//\n// }\n\n\n/**\n * Moves focus to the given html element on enter key pressed\n * @param src object to track\n * @param dest given html element to jump to\n */\n// window.onEnterFocus = function onEnterFocus ( src, dest ) {\n//     src.onkeypress = function ( event ) {\n//         if ( event.keyCode || event.keyCode ) {\n//             if ( (event.keyCode === 13) || (event.keyCode === 13) ) {\n//                 dest.focus();\n//\n//                 return false;\n//             }\n//         }\n//\n//         return true;\n//     };\n// };\n\n\n/**\n * Clicks the given html element on enter key pressed\n * @param src object to track\n * @param dest given html element to click to\n */\nwindow.onEnterClick = function onEnterClick ( src, dest ) {\n    src.addEventListener('keydown', function ( event ) {\n        if ( event.keyCode === 13 ) {\n            //dest.focus();\n            dest.click();\n        }\n    });\n};\n\n\n/**\n * New link type to select value from the set\n * @param obj html element to expand\n * @param data list of values and titles like {300:{title:'5 minutes',next:1200}, 1200:{title:'20 minutes',next:300}}\n * @param id default value to select\n */\n// function LinkSet ( obj, data, id ) {\n//     if ( !obj ) return;\n//\n//     this.obj  = obj;\n//     this.data = data;\n//\n//     /**\n//      * Set currect value and title from the data\n//      * @param id to select\n//      */\n//     this.ItemSelect = function ( id ) {\n//         // if somebody alredy have 1 munute (probably should be removed in the future)\n//         if ( id == 60 ) data[60] = {next:300,  title: '1 minute'};\n//         // check input\n//         if ( id && data && data[id] ) {\n//             // set value and html\n//             this.obj.value = id;\n//             this.obj.innerHTML = data[id].title;\n//             var pthis = this;\n//             // set onclick handler and pass this object pointer for future selection\n//             this.obj.onclick = function(){\n//                 pthis.ItemSelect(data[id].next);\n//             };\n//         }\n//     };\n//\n//     // do the default selection\n//     this.ItemSelect(id);\n// }\n\n\n/**\n * Adds the given value to the obj as a child recursively\n * @param obj DOMElement to be appended\n * @param value data to add (simple text values, DOMElements, array of DOMElements)\n * @return DOMElement owner of all added data\n * @example elchild(mydiv, 'Hello world'); // simple text value\n * @example elchild(mydiv, someotherdiv); // DOMElement\n * @example elchild(mydiv, [div1, div2, div3]); // DOMElement list\n * @example elchild(mydiv, [div1, 'hello', 'world']); // combined case\n */\nwindow.elchild = function elchild ( obj, value ) {\n    // check input\n    if ( obj && value ) {\n        // DOMElement\n        if ( value.nodeType ) {\n            obj.appendChild(value);\n        } else if ( value instanceof Array ) {\n            // array of DOMElements of simple values\n            for ( var i = 0; i < value.length; i++ ) {\n                elchild(obj, value[i]);\n            }\n        } else {\n            // simple values\n            obj.appendChild(document.createTextNode(value));\n        }\n    }\n\n    return obj;\n};\n\n\n/**\n * Removes all child elements from the given object\n * @param obj DOMElement to be updated\n * @return DOMElement cleared\n */\nwindow.elclear = function elclear ( obj ) {\n    if ( obj && obj.hasChildNodes() ) {\n        while ( obj.hasChildNodes() ) {\n            obj.removeChild(obj.firstChild);\n        }\n    }\n\n    return obj;\n};\n\n\n/**\n * Assigns a list of attribute values to the given object\n * @param obj DOMElement\n * @param attr list of attributes with values\n * @return DOMElement the same as the given one\n * @example elattr(myimg, {src:'face.png', className:'main'});\n */\nwindow.elattr = function elattr ( obj, attr ) {\n    // check if DOMElement\n    if ( obj && obj.nodeType && attr && attr instanceof Object ) {\n        for ( var akey in attr ) {\n            obj[akey] = attr[akey];\n        }\n    }\n\n    return obj;\n};\n\n\n/**\n * Creates a DOMElement with given options\n * @param name html element name (a, img, div, ...)\n * @param attr list of attributes with values\n * @param [data] inner html value\n * @param [handlers] list of DOMElement event handlers (onclick, onload, ...)\n * @return {Node}\n * @example element('link', {rel:'stylesheet', type:'text/css', href:'http://some.url/'});\n */\nwindow.element = function element ( name, attr, data, handlers ) {\n    var tag = document.createElement(name);\n\n    elattr(tag, attr);\n    elchild(tag, data);\n\n    // set all handlers\n    if ( handlers && handlers instanceof Object ) {\n        for ( var handler in handlers ) {\n            tag[handler] = handlers[handler];\n        }\n    }\n\n    return tag;\n};\n\n\nwindow.table = function table ( rows, cols, attr, handlers ) {\n    var el = element('table', attr, null, handlers);\n\n    for ( var i = 0; i < rows; i++ ) {\n        el.insertRow(-1);\n        for ( var j = 0; j < cols; j++ ) {\n            el.rows[i].insertCell(-1);\n        }\n    }\n\n    return el;\n};\n\n\nwindow.tblrow = function tblrow ( obj, cells, attrs ) {\n    var row = obj.insertRow(-1);\n\n    for ( var i = 0; i < cells.length; i++ ) {\n        row.insertCell(-1);\n        elchild(row.cells[i], cells[i]);\n        elattr(row.cells[i], attrs[i]);\n    }\n\n    return obj;\n};\n\n\n/**\n * converts date from timestamp to simple date string\n * 1209589200 -> 2012.02.03 00:23\n * @return {String}\n */\nwindow.TimestampToDateStr = function TimestampToDateStr ( tstamp ) {\n    var theDate = tstamp ? new Date(tstamp * 1000) : new Date();\n    var nyear = theDate.getFullYear();\n    var nmonth = theDate.getMonth() + 1;\n    var nday = theDate.getDate();\n    var hour = theDate.getHours();\n    var min = theDate.getMinutes();\n\n    if ( nmonth < 10 ) nmonth = '0' + nmonth;\n    if ( nday < 10 ) nday = '0' + nday;\n    if ( hour < 10 ) hour = '0' + hour;\n    if ( min < 10 ) min = '0' + min;\n\n    return nyear + '.' + nmonth + '.' + nday + ' ' + hour + ':' + min;\n};\n\n\n// function time_data ( timestamp ) {\n//     var dt = new Date(timestamp * 1000);\n//     var dl = {y:dt.getFullYear(), m:dt.getMonth()+1, d:dt.getDate(), h:dt.getHours(), i:dt.getMinutes()};\n//     // extend with zero where necessary\n//     if ( dl.m < 10 ) dl.m = '0' + dl.m;\n//     if ( dl.d < 10 ) dl.d = '0' + dl.d;\n//     if ( dl.h < 10 ) dl.h = '0' + dl.h;\n//     if ( dl.i < 10 ) dl.i = '0' + dl.i;\n//     return dl;\n// }\n\n\n/**\n * Password generator with SJCL entropy mechanism\n * @param {number} length size of the result password\n * @return {string}\n */\nwindow.pwdgen = function pwdgen ( length ) {\n    var charset = 'abcdefghijklnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789!@#$%&{}()[]=+?*<>;,.:-_',\n        letters = [],\n        result  = '',\n        letter;\n\n    while ( result.length < length ) {\n        letter = null;\n        // generate a char\n        if ( sjcl.random.isReady() ) {\n            // get\n            letter = String.fromCharCode(parseInt(sjcl.codec.hex.fromBits(sjcl.random.randomWords(1)).substr(0, 2), 16));\n            // invalidate if not in dictionary\n            if ( charset.indexOf(letter) === -1 ) {\n                letter = null;\n            }\n        } else {\n            letter = charset.charAt(Math.floor(Math.random() * charset.length));\n        }\n        // something is found\n        if ( letter ) {\n            // check if not a duplicate\n            if ( letters.indexOf(letter.toLowerCase()) < 0 ) {\n                // fill already used chars list\n                letters.push(letter.toLowerCase());\n                // fill the result\n                result += letter;\n            }\n        }\n    }\n\n    return result;\n};\n\n\n/**\n * Ajax cross-domain request helper\n * @param url link to external resource\n */\n// function jsonp ( url ) {\n//     // create element and get data to callback\n//     var script = element('script', {type:'text/javascript', src:url});\n//     // insert to DOM\n//     document.body.appendChild(script);\n//     // clear after data processed in 5 secs\n//     setTimeout(function(){\n//         console.log('jsonp script tag clearing');\n//         document.body.removeChild(script);\n//     }, 10000);\n// }\n\n\n/**\n * Set input watermark hint\n * @param obj html element\n * @param text string hint\n * @param cin string color\n */\n// function watermark ( obj, text, cin ) {\n//     $(obj)\n//         .focus(function(){\n//             if ( this.value == text ) $(this).val('').css({color:cin});\n//         })\n//         .focusout(function(){\n//             if ( !this.value ) $(this).val(text).css({color:''});\n//         });\n// }\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/js/tools.js\n// module id = 33\n// module chunks = 0","/**\n * @license The MIT License (MIT)\n * @copyright Stanislav Kalashnik <darkpark.main@gmail.com>\n */\n\n'use strict';\n\nvar app = require('./app'),\n    sjcl = require('./sjcl.min'),\n    api = require('./api'),\n    DialogModal = require('./modal'),\n    FieldList = require('./fldlist');\n\n\nvar DlgExport = null;\nvar DlgOptions = null;\nvar DlgPassGet = null;\nvar DlgUserLogin = null;\nvar DlgUserRegister = null;\n\n\n//document.addEventListener('DOMContentLoaded', function () {\nDlgExport = new DialogModal({\n    width: 750,\n    title: 'Data export',\n    hint: 'Here you can get all your data unencrypted.',\n    dom: {},\n\n    onCreate: function () {\n        this.SetContent(this.dom.text = element('textarea', {className: 'export'}));\n    },\n\n    /**\n     * Open the subscriber\n     * master password is accessible\n     * decrypt all the data and show it\n     */\n    EventOpen: function () {\n        if ( window.exportData ) {\n            setTimeout(function () {\n                DlgExport.Show();\n                for ( var idNote in window.exportData.notes ) {\n                    // check type\n                    if ( window.exportData.notes[idNote] instanceof Array ) {\n                        window.exportData.notes[idNote].forEach(function ( entry ) {\n                            var name = crypto.decrypt(entry.name, true);\n                            var data = crypto.decrypt(entry.data, true);\n                            if ( name && data ) {\n                                DlgExport.dom.text.value += name + ': ' + data + '\\n';\n                            }\n                        });\n                    }\n                    // check type\n                    if ( window.exportData.note_tags[idNote] instanceof Array ) {\n                        var tags = [];\n                        window.exportData.note_tags[idNote].forEach(function ( idTag ) {\n                            if ( window.exportData.tags[idTag] ) tags.push(crypto.decrypt(window.exportData.tags[idTag], true));\n                        });\n                        if ( tags.length > 0 ) {\n                            DlgExport.dom.text.value += 'tags: ' + tags.join(' ') + '\\n';\n                        }\n                    }\n                    DlgExport.dom.text.value += '\\n';\n                }\n                // strip\n                DlgExport.dom.text.value = DlgExport.dom.text.value.trim();\n                window.exportData = null;\n            }, 50);\n        }\n    },\n\n    /**\n     * close the subscriber\n     * master password is expired and cleared\n     * clear all the decrypted data\n     */\n    EventClose: function () {\n        DlgExport.Close();\n    },\n\n    controls: {\n        'Close': {\n            main: true,\n            onClick: function () {\n                //var modal = this.modal;\n                this.modal.Close();\n            }\n        }\n    }\n});\n\n\nDlgOptions = new DialogModal({\n    width: 650,\n    title: 'Options',\n    hint: 'Here you can create/restore backups and export all your data.',\n\n    onCreate: function () {\n        var file = element('input', {\n            type: 'file', name: 'file', id: 'file-upload', onchange: function () {\n                hint.innerHTML = this.value;\n                fbtn.value = 'File selected';\n            }\n        });\n        var fbtn = element('input', {\n            type: 'button', className: 'button long', value: 'Choose file ...', onclick: function () {\n                //$(file).trigger('click');\n                file.click();\n            }\n        });\n        var hint = element('div', {className: 'fhint'});\n\n        this.SetContent([\n            element('div', {className: 'desc'}, \"Backup is an archived package of all your encrypted data. It can't be read by human but can be used to restore your account info or setup a copy on some other FortNotes instance.\"),\n            element('input', {\n                type: 'button', className: 'button long', value: 'Create backup', onclick: function () {\n                    window.location = api.defaults.server + 'user/export/txt';\n                }\n            }),\n            element('div', {className: 'desc'}, \"Please specify your previously downloaded backup package and then press the \\\"Restore backup\\\" button. It will upload your backup to the server and replace all your current data with the data from this backup. Warning: this operation can't be reverted!\"),\n            element('div', {}, [\n                element('input', {\n                    type: 'button', className: 'button long', value: 'Restore backup', onclick: function () {\n                        var btn = this;\n                        btn.value = 'Uploading ...';\n                        btn.disabled = true;\n\n                        var data = new FormData();\n                        data.append('file', file.files[0]);\n                        console.log(data);\n\n                        api.postForm('user/import/txt', data, function ( error, data ) {\n                            if ( error ) {\n                                console.error(error);\n                                return;\n                            }\n\n                            console.log('user import', data);\n\n                            btn.value = 'Restore backup';\n                            btn.disabled = false;\n                            if ( data && data.error ) {\n                                alert('Restore from backup failed. Error: ' + data.error);\n                            } else {\n                                alert('The restore process has completed successfully and now the page will be reloaded to apply the restored data.');\n                                // We must reload the whole page to update window.dataTags\n                                window.location.reload();\n                            }\n                        });\n\n                        // $.ajax({\n                        //     url: 'user/import/txt',\n                        //     data: data,\n                        //     cache: false,\n                        //     contentType: false,\n                        //     processData: false,\n                        //     type: 'POST',\n                        //     dataType: 'json',\n                        //     success: function(data) {\n                        //         btn.value = 'Restore backup';\n                        //         btn.disabled = false;\n                        //         if ( data && data.error ) {\n                        //             alert('Restore from backup failed. Error: ' + data.error);\n                        //         } else {\n                        //             alert('The restore process has completed successfully and now the page will be reloaded to apply the restored data.');\n                        //             // We must reload the whole page to update window.dataTags\n                        //             window.location.reload();\n                        //         }\n                        //     }\n                        // });\n                    }\n                }), ' ',\n                fbtn,\n                hint\n            ]),\n            element('div', {className: 'desc'}, \"It's possible to export all the data in a human readable form in order to print it or save in file on some storage. It'll give all the data in plain unencrypted form. The password is required.\"),\n            element('input', {\n                type: 'button', className: 'button long', value: 'Export data', onclick: function () {\n                    var btn = this;\n\n                    btn.value = 'Loading ...';\n                    btn.disabled = true;\n\n                    api.get('user/export/plain', function ( error, data ) {\n                        if ( error ) {\n                            console.error(error);\n                            return;\n                        }\n\n                        console.log('user export', data);\n\n                        btn.value = 'Export data';\n                        btn.disabled = false;\n                        window.exportData = data;\n                        app.expirePass();\n                    });\n                }\n            })\n        ]);\n    },\n\n    /**\n     * close the subscriber\n     * master password is expired and cleared\n     * clear all the decrypted data\n     */\n    EventClose: function () {\n        DlgOptions.Close();\n    },\n\n    controls: {\n        Close: {\n            main: true,\n            onClick: function () {\n                this.modal.Close();\n            }\n        }\n    }\n});\n\n\nDlgPassGet = new DialogModal({\n    width: 500,\n    title: 'Password',\n    hint: 'Please enter your password to unlock encrypted data.',\n    data: {attempts: 0},\n\n    onCreate: function () {\n        this.data.fldlist = new FieldList({\n            cols: [\n                {className: 'colname'},\n                {className: 'colvalue'}\n            ],\n            attr: {}\n        });\n        this.data.pass = element('input', {type: 'password', autocomplete: 'current-password', className: 'line'});\n        //this.data.linkset = element('a', {className: 'combo', title: 'click to change the password storing time'});\n        onEnterClick(this.data.pass, this.params.controls['Continue'].dom);\n\n        this.data.fldlist.AddRow([\n            [\n                element('span', {className: 'fldname'}, 'password'),\n                element('br'),\n                element('span', {className: 'fldhint'}, 'your secret key')\n            ],\n            [\n                element('input', {\n                    type: 'text',\n                    autocomplete: 'username',\n                    className: 'hidden',\n                    value: app.get('username_last_used', '')\n                }),\n                this.data.pass\n            ]\n        ], {});\n        //this.data.fldlist.AddRow([null, ['remember password for ', this.data.linkset]], {});\n\n        this.SetContent(element('form', {}, this.data.fldlist.dom.table));\n    },\n\n    onShow: function () {\n        // new LinkSet(DlgPassGet.data.linkset, {\n        //     300:   {next:1200,  title: '5 minutes'},\n        //     1200:  {next:3600,  title: '20 minutes'},\n        //     3600:  {next:18000, title: '1 hour'},\n        //     18000: {next:86400, title: '5 hours'},\n        //     86400: {next:300,   title: '1 day'}\n        // }, app.get('pass_store_time', 300));\n    },\n\n    /**\n     * close the subscriber\n     * master password is expired and cleared\n     * clear all the decrypted data\n     */\n    EventClose: function () {\n        DlgPassGet.Show({escClose: false});\n    },\n\n    controls: {\n        'Log off': {\n            main: false,\n            onClick: function () {\n                this.modal.Close();\n                SignOut();\n            }\n        },\n        Continue: {\n            main: true,\n            onClick: function () {\n                var modal = this.modal;\n                var pass = modal.data.pass.value;\n\n                console.log('Continue.onClick');\n\n                // check pass\n                if ( app.checkPass(pass) ) {\n                    initData(window.dataUser, function () {\n                        //app.set('pass_store_time', modal.data.linkset.value, true);\n                        app.setPass(pass);\n                        modal.data.attempts = 0;\n                        // reset value\n                        modal.data.pass.value = '';\n                        modal.Close();\n                        //NoteFilter.SetFocus();\n                    });\n                    // if ( modal.data.linkset.value ) {\n                    //     //fb(modal.data.linkset.value);\n                    //     app.set('pass_store_time', modal.data.linkset.value, true);\n                    //     app.setPassTime(modal.data.linkset.value);\n                    // }\n                } else {\n                    modal.data.pass.focus();\n                    modal.data.attempts++;\n                    if ( modal.data.attempts === 1 )\n                        modal.SetMessage('Password is invalid!');\n                    else\n                        modal.SetMessage(['Password is invalid!', element('br'), 'Logged attempts: ' + modal.data.attempts]);\n                }\n            }\n        }\n    }\n});\n\n\nDlgUserLogin = new DialogModal({\n    width: 500,\n    title: 'Authentication',\n    hint: \"Welcome back! Please authorize.\",\n    data: {attempts: 0},\n\n    onCreate: function () {\n        this.data.fldlist = new FieldList({\n            cols: [\n                {className: 'colname'},\n                {className: 'colvalue'}],\n            attr: {}\n        });\n        this.data.name = element('input', {\n            className: 'line',\n            autocomplete: 'username',\n            type: 'text',\n            value: app.get('username_last_used', '')\n        });\n        this.data.pass = element('input', {className: 'line', autocomplete: 'current-password', type: 'password'});\n\n        //onEnterFocus(this.data.name, this.data.pass);\n        onEnterClick(this.data.pass, this.params.controls['Login'].dom);\n\n        this.data.fldlist.AddRow([\n            [element('span', {className: 'fldname'}, 'username'),\n                element('br'),\n                element('span', {className: 'fldhint'}, 'your name or email')],\n            this.data.name\n        ], {});\n        this.data.fldlist.AddRow([\n            [element('span', {className: 'fldname'}, 'password'),\n                element('br'),\n                element('span', {className: 'fldhint'}, 'your secret key')],\n            this.data.pass\n        ], {});\n        this.SetContent(element('form', {}, this.data.fldlist.dom.table));\n    },\n\n    controls: {\n        'Cancel': {\n            onClick: function () {\n                this.modal.Close();\n            }\n        },\n        'Login': {\n            main: true,\n            onClick: function () {\n                var modal = this.modal;\n                // get name and pass\n                var username = modal.data.name.value;\n                var password = modal.data.pass.value;\n                // verification\n                if ( username && password ) {\n                    // ajax request\n                    username = sjcl.codec.hex.fromBits(sjcl.hash.sha256.hash(username));\n                    password = sjcl.codec.hex.fromBits(sjcl.hash.sha256.hash(password));\n                    // block all inputs and buttons\n                    modal.EnableControls(false);\n                    modal.data.name.disabled = true;\n                    modal.data.pass.disabled = true;\n                    if ( modal.data.attempts > 1 ) {\n                        modal.SetLoading(\"Sending server request ...\");\n                    }\n\n                    api.post('user/auth', {name: username, pass: password, mode: 'login'}, function ( error, data ) {\n                        if ( error ) {\n                            console.error(error);\n                            modal.SetMessage('Request error.', 'error');\n                            return;\n                        }\n\n                        console.log('user auth', data);\n\n                        if ( data ) {\n                            // check returned data\n                            if ( data && data.id ) {\n                                initData(data, function () {\n                                    // save user name of last login\n                                    app.set('username_last_used', modal.data.name.value, true);\n                                    app.setPass(modal.data.pass.value);\n                                    // reset values\n                                    modal.data.name.value = '';\n                                    modal.data.pass.value = '';\n                                    //modal.SetHint();\n                                    //modal.SetContent();\n                                    //$(modal.dom.footer).hide();\n                                    //modal.SetMessage(['Authentication was completed successfully.', element('br'), 'Entering secure private section ...'], 'auth');\n                                    // redirect to home with delay\n                                    //setTimeout(function(){\n                                    //window.location.href = window.location.href;\n                                    modal.Close();\n                                    //NoteFilter.SetFocus();\n\n                                    //window.pageInit.style.display = 'none';\n                                    //window.pageMain.style.display = 'block';\n                                    //}, 500);\n                                });\n                                return;\n                            } else {\n                                modal.data.attempts++;\n                                if ( modal.data.attempts === 1 ) {\n                                    modal.SetMessage('Invalid user name or password.', 'error');\n                                } else {\n                                    modal.SetMessage(['Invalid user name or password.', element('br'), 'Logged attempts: ' + modal.data.attempts], 'error');\n                                }\n                            }\n                        } else {\n                            modal.SetMessage('Invalid response from the server.');\n                        }\n                        // unblock all inputs and buttons\n                        modal.EnableControls(true);\n                        modal.data.name.disabled = false;\n                        modal.data.pass.disabled = false;\n                    });\n                } else {\n                    modal.SetMessage('Empty user name or password.');\n                }\n            }\n        }\n    }\n});\n\n\nDlgUserRegister = new DialogModal({\n    width: 550,\n    title: 'Registration',\n    hint: \"You are going to register in the system. Please note that the password you are going to enter will be used not only to login but also to encrypt/decrypt your data so choose a strong and long password. Your registration data won't be sent to the server in plain unencrypted form. Only hashes are stored on the server. We don't know your password and will never ask you to send it to us but at the same time we won't be able to remind it to you so please keep that password utmost safe.\",\n    data: {attempts: 0},\n\n    onShow: function () {\n        var self = this;\n\n        api.get('captcha/uri', function ( error, data ) {\n            if ( error ) {\n                console.error(error);\n                return;\n            }\n\n            console.log('user captcha', data);\n\n            self.data.cimg.src = api.defaults.server + data.src;\n        });\n    },\n\n    onCreate: function () {\n        this.data.fldlist = new FieldList({\n            cols: [\n                {className: 'colname'},\n                {className: 'colvalue'}],\n            attr: {}\n        });\n        this.data.name = element('input', {type: 'text', autocomplete: 'username', className: 'line'});\n        this.data.pass1 = element('input', {type: 'password', autocomplete: 'new-password', className: 'line'});\n        this.data.pass2 = element('input', {type: 'password', autocomplete: 'new-password', className: 'line'});\n        this.data.cimg = element('img', {width: 161, height: 75});\n        this.data.code = element('input', {\n            type: 'text',\n            autocomplete: 'off',\n            className: 'line cline',\n            title: 'case insensitive code above'\n        });\n\n        // onEnterFocus(this.data.name, this.data.pass1);\n        // onEnterFocus(this.data.pass1, this.data.pass2);\n        // onEnterFocus(this.data.pass2, this.data.code);\n        onEnterClick(this.data.code, this.params.controls['Register'].dom);\n\n        this.data.fldlist.AddRow([\n            [element('span', {className: 'fldname'}, 'username'),\n                element('br'),\n                element('span', {className: 'fldhint'}, 'your name or email')],\n            this.data.name\n        ], {});\n        this.data.fldlist.AddRow([\n            [element('span', {className: 'fldname'}, 'password'),\n                element('br'),\n                element('span', {className: 'fldhint'}, 'your secret key')],\n            this.data.pass1\n        ], {});\n        this.data.fldlist.AddRow([\n            [element('span', {className: 'fldname'}, 'confirm password'),\n                element('br'),\n                element('span', {className: 'fldhint'}, 'your secret key once more')],\n            this.data.pass2\n        ], {});\n        this.data.fldlist.AddRow([\n            [element('span', {className: 'fldname'}, 'captcha'),\n                element('br'),\n                element('span', {className: 'fldwhint'}, 'enter the code on the image to make sure this is not an automated registration')],\n            [this.data.cimg, element('br'), this.data.code]\n        ], {});\n        //console.log(this.dom.footer);\n        //$(this.dom.footer).hide();\n        this.dom.footer.classList.add('hidden');\n        var self = this;\n        this.SetContent(element('a', {}, \"I understand that my password can't be restored and will keep it safe\", {\n            onclick: function () {\n                var container = document.getElementById('simplemodal-container');\n\n                self.SetHint('Keep your password safe - you are the only one who knows it so there is no way to restore it!');\n                //$('#simplemodal-container').css('top', ($('#simplemodal-container').css('top').replace('px','') - 80) + 'px');\n                container.style.top = parseInt(container.style.top, 10) - 100 + 'px';\n                self.SetContent(element('form', {}, self.data.fldlist.dom.table));\n                //$(self.dom.footer).show();\n                self.dom.footer.classList.remove('hidden');\n                self.data.name.focus();\n            }\n        }));\n    },\n\n    controls: {\n        Cancel: {\n            onClick: function () {\n                this.modal.Close();\n            }\n        },\n        Register: {\n            main: true,\n            onClick: function () {\n                var modal = this.modal;\n                // get name and pass\n                var password, username = modal.data.name.value;\n                var pass1 = modal.data.pass1.value;\n                var pass2 = modal.data.pass2.value;\n                // verification\n                if ( username && pass1 && pass2 && pass1 === pass2 ) {\n                    // make hash\n                    username = sjcl.codec.hex.fromBits(sjcl.hash.sha256.hash(username));\n                    password = sjcl.codec.hex.fromBits(sjcl.hash.sha256.hash(pass1));\n                    // block all inputs and buttons\n                    modal.EnableControls(false);\n                    modal.data.name.disabled = true;\n                    modal.data.pass1.disabled = true;\n                    modal.data.pass2.disabled = true;\n                    if ( modal.data.attempts > 1 ) {\n                        modal.SetLoading(\"Sending server request ...\");\n                    }\n\n                    api.post('user/auth', {\n                        name: username,\n                        pass: password,\n                        code: modal.data.code.value,\n                        mode: 'register'\n                    }, function ( error, data ) {\n                        if ( error ) {\n                            console.error(error);\n                            modal.SetMessage('Request error.', 'error');\n                            return;\n                        }\n\n                        console.log('user auth', data);\n\n                        if ( data ) {\n                            if ( data.code !== false ) {\n                                // check returned data\n                                if ( data && data.id ) {\n                                    initData(data, function () {\n                                        // save user name for future logins\n                                        app.set('username_last_used', modal.data.name.value, true);\n                                        app.setPass(password);\n                                        // reset values\n                                        modal.data.name.value = '';\n                                        modal.data.pass1.value = '';\n                                        modal.data.pass2.value = '';\n                                        //modal.SetHint();\n                                        //modal.SetContent();\n                                        //$(modal.dom.footer).hide();\n                                        //modal.dom.footer.classList.add('hidden');\n                                        //modal.SetMessage(['Registration was completed successfully.', element('br'), 'Entering secure private section ...'], 'auth');\n                                        // redirect to home with delay\n                                        //setTimeout(function(){\n                                        //window.location.href = window.location.href;\n                                        modal.Close();\n\n                                        //window.pageInit.style.display = 'none';\n                                        //window.pageMain.style.display = 'block';\n                                        //}, 500);\n                                    });\n                                    return;\n                                } else {\n                                    modal.data.attempts++;\n                                    if ( modal.data.attempts === 1 )\n                                        modal.SetMessage(['Invalid user name or password.', element('br'), 'There maybe already a user with the same name or there are some technical problems on the server.'], 'error');\n                                    else\n                                        modal.SetMessage(['Invalid user name or password.', element('br'), 'Logged attempts: ' + modal.data.attempts], 'error');\n                                }\n                            } else {\n                                modal.SetMessage('Invalid captcha code. Please correct it and try once again.');\n                            }\n                        } else {\n                            modal.SetMessage('Invalid responce from the server.');\n                        }\n                        // unblock all inputs and buttons\n                        modal.EnableControls(true);\n                        modal.data.name.disabled = false;\n                        modal.data.pass1.disabled = false;\n                        modal.data.pass2.disabled = false;\n                    });\n                } else {\n                    modal.SetMessage(\"Empty one of the required field or passwords don't match.\");\n                }\n            }\n        }\n    }\n});\n\n\napp.subscribe(DlgExport);\napp.subscribe(DlgOptions);\napp.subscribe(DlgPassGet);\n\nwindow.DlgExport = DlgExport;\nwindow.DlgOptions = DlgOptions;\nwindow.DlgPassGet = DlgPassGet;\nwindow.DlgUserLogin = DlgUserLogin;\nwindow.DlgUserRegister = DlgUserRegister;\n//});\n\n\n// public\nmodule.exports = {\n    DlgExport: DlgExport,\n    DlgOptions: DlgOptions,\n    DlgPassGet: DlgPassGet,\n    DlgUserLogin: DlgUserLogin,\n    DlgUserRegister: DlgUserRegister\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/js/dialogs.js\n// module id = 34\n// module chunks = 0","/**\n * Modal window wrapper\n * @license The MIT License (MIT)\n * @copyright Stanislav Kalashnik <darkpark.main@gmail.com>\n */\n\n'use strict';\n\nfunction DialogModal ( params ) {\n    this.params = params;\n    this.data = params.data || {};\n\n    // html elements of the dialog\n    this.dom = {};\n\n    this.SetWidth = function ( value ) {\n        this.dom.body.style.width = value + 'px';\n    };\n\n    this.Show = function ( params ) {\n        params = params || {};\n        if ( this.params.onShow && this.params.onShow instanceof Function ) {\n            this.params.onShow.call(this);\n        }\n        $(this.dom.main).modal(params);\n    };\n\n    this.Close = function ( delay ) {\n        if ( delay ) {\n            var self = this;\n            setTimeout(function () {\n                $.modal.close();\n                self.Reset();\n            }, parseInt(delay, 10));\n        } else {\n            $.modal.close();\n            this.Reset();\n        }\n    };\n\n    this.Reset = function () {\n        this.SetMessage();\n    };\n\n    this.SetTitle = function ( hint ) {\n\n    };\n\n    this.SetHint = function ( hint ) {\n        if ( hint ) {\n            if ( this.dom.hint.childNodes.length === 0 ) {\n                this.dom.hint.appendChild(element('div', {className: 'info'}, hint));\n            }\n            this.dom.hint.childNodes[0].innerHTML = hint;\n            this.dom.hint.style.display = '';\n        } else {\n            this.dom.hint.style.display = 'none';\n        }\n    };\n\n    this.SetMessage = function ( text, type ) {\n        if ( text ) {\n            type = type || 'warning';\n            elchild(elclear(this.dom.message), element('div', {className: 'message ' + type}, text));\n            this.dom.message.style.display = '';\n        } else {\n            this.dom.message.style.display = 'none';\n        }\n    };\n\n    this.SetLoading = function ( text ) {\n        this.SetMessage(text, 'loading');\n    };\n\n    this.SetContent = function ( content ) {\n        if ( content ) {\n            elclear(this.dom.content);\n            elchild(this.dom.content, content);\n        } else {\n            this.dom.content.style.display = 'none';\n        }\n    };\n\n    this.EnableControls = function ( state ) {\n        if ( this.params.controls ) {\n            for ( var cname in this.params.controls ) {\n                this.params.controls[cname].dom.disabled = !state;\n            }\n        }\n    };\n\n    this.Init = function () {\n        this.dom.body = element('div', {className: 'body'}, [\n            this.dom.title = element('div', {className: 'block title'}, this.params.title),\n            this.dom.hint = element('div', {className: 'block hint'}),\n            this.dom.content = element('div', {className: 'block content'}),\n            this.dom.message = element('div', {className: 'block info'}),\n            this.dom.footer = element('div', {className: 'block footer'})\n        ]);\n\n        this.dom.main = element('div', {className: 'dialogmodal'}, this.dom.body);\n\n        if ( this.params.width ) this.SetWidth(this.params.width);\n\n        this.SetHint(this.params.hint);\n        this.SetMessage(this.params.message);\n\n        if ( this.params.controls ) {\n            for ( var cname in this.params.controls ) {\n                var cdata = this.params.controls[cname];\n                cdata.dom = element('input', {type: 'button', value: cname, className: 'button'});\n                // for inline indirect future use\n                cdata.dom.modal = this;\n                // default action\n                if ( cdata.main ) cdata.dom.className += ' bold';\n                // set callback\n                if ( cdata.onClick && cdata.onClick instanceof Function ) {\n                    cdata.dom.onclick = cdata.onClick;\n                }\n                this.dom.footer.appendChild(cdata.dom);\n            }\n        }\n\n        if ( this.params.onCreate && this.params.onCreate instanceof Function ) {\n            this.params.onCreate.call(this);\n        }\n\n        if ( this.params.EventClose && this.params.EventClose instanceof Function ) {\n            this.EventClose = this.params.EventClose;\n        }\n        if ( this.params.EventOpen && this.params.EventOpen instanceof Function ) {\n            this.EventOpen = this.params.EventOpen;\n        }\n\n        if ( this.params.content ) {\n            this.params.content.style.display = '';\n            this.dom.content.appendChild(this.params.content);\n        }\n    };\n    this.Init();\n}\n\n\n// public\nmodule.exports = DialogModal;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/js/modal.js\n// module id = 35\n// module chunks = 0","/**\n * Table manager for fields\n * @license The MIT License (MIT)\n * @copyright Stanislav Kalashnik <darkpark.main@gmail.com>\n */\n\n'use strict';\n\n/**\n * @param params list of configuration parameters\n *     cols - name of table columns (also class names for corresponding cells)\n *     attr - table attributes overwriting the default ones\n */\nfunction FieldList ( params ) {\n    this.params = params;\n\n    // html elements\n    this.dom = {};\n\n    this.SetCols = function ( cols ) {\n        this.params.cols = cols;\n    };\n\n    this.AddRow = function ( cells, attr ) {\n        if ( cells && cells instanceof Array && cells.length === this.params.cols.length ) {\n            var cell = null;\n            var row = this.dom.table.insertRow(-1);\n            elattr(row, attr);\n            for ( var i = 0; i < this.params.cols.length; i++ ) {\n                cell = row.insertCell(-1);\n                cell.className = this.params.cols[i];\n                elchild(cell, cells[i]);\n                elattr(cell, this.params.cols[i]);\n            }\n            return row;\n        }\n        return false;\n    };\n\n    this.AddDivider = function ( cells, attr ) {\n        var row = this.dom.table.insertRow(-1);\n        var cell = row.insertCell(-1);\n        elattr(cell, {colspan: this.params.cols.length});\n        elchild(cell, element('div', {className: 'divider'}));\n    };\n\n    this.Init = function () {\n        this.dom.table = element('table', {className: 'fldlist'});\n        elattr(this.dom.table, this.params.attr);\n    };\n    this.Init();\n}\n\n\n// public\nmodule.exports = FieldList;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/js/fldlist.js\n// module id = 36\n// module chunks = 0"],"sourceRoot":""}